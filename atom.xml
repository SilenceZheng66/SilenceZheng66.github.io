<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>SilenceZheng66-BLOG</title>
  
  <subtitle>silencezheng.top</subtitle>
  <link href="http://silencezheng.top/atom.xml" rel="self"/>
  
  <link href="http://silencezheng.top/"/>
  <updated>2024-12-08T15:15:00.209Z</updated>
  <id>http://silencezheng.top/</id>
  
  <author>
    <name>SilenceZheng66</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>LeetCodeå‘¨è®° EP24</title>
    <link href="http://silencezheng.top/2024/12/08/article151/"/>
    <id>http://silencezheng.top/2024/12/08/article151/</id>
    <published>2024-12-08T15:14:00.000Z</published>
    <updated>2024-12-08T15:15:00.209Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘å¿™ç€åšæ¯•è®¾å®éªŒï¼Œä¹‹å‰çš„å‘¨è®°éƒ½æç½®äº†ã€‚å®éªŒæœ‰äº†äº›ç»“æœï¼Œè¿˜ä¸é”™ã€‚è¿™å‘¨æ˜¯æ¯æ—¥ä¸€æ£‹ã€‚</p><p>æœ¬å‘¨ä¸»é¢˜ï¼šå¤æ‚å›æº¯ã€è®°å¿†åŒ–æœç´¢</p><p>é¢˜ç›®ï¼š</p><ul><li>241204æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/number-of-valid-move-combinations-on-chessboard/description/?envType=daily-question&amp;envId=2024-12-04">Number of Valid Move Combinations On Chessboard</a></li><li>241207æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/knight-probability-in-chessboard/description/?envType=daily-question&amp;envId=2024-12-07">Knight Probability in Chessboard</a></li><li>241208æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/transform-to-chessboard/description/?envType=daily-question&amp;envId=2024-12-08">Transform to Chessboard</a><span id="more"></span><h1 id="Number-of-Valid-Move-Combinations-On-Chessboard"><a href="#Number-of-Valid-Move-Combinations-On-Chessboard" class="headerlink" title="Number of Valid Move Combinations On Chessboard"></a><a href="https://leetcode.cn/problems/number-of-valid-move-combinations-on-chessboard/description/?envType=daily-question&amp;envId=2024-12-04">Number of Valid Move Combinations On Chessboard</a></h1></li></ul><p>å°±æ˜¯è¯´ä¸€ä¸ªmove comboå°±æ˜¯ä¸€ä¸ª<code>int[][] destinations</code>ï¼Œä»£è¡¨æ¯ä¸ªæ£‹å­è¦ç§»åŠ¨åˆ°çš„ä½ç½®ï¼Œæ¯ç§’æ¯ä¸ªæ£‹å­ç§»åŠ¨ä¸€ä¸ªæ ¼å­ï¼Œä¸”ç§»åŠ¨è¿‡ç¨‹ä¸­ä¸èƒ½å‘ç”ŸæŠ¢å æ ¼å­çš„æƒ…å†µã€‚è¿™ä¸ªç›®çš„åœ°æ˜¯æ ¹æ®æ£‹å­çš„å¯ç§»åŠ¨æ–¹å‘é€‰çš„ï¼ŒåŒ…æ‹¬åŸåœ°ä¸åŠ¨ã€‚</p><h2 id="DFS-å›æº¯"><a href="#DFS-å›æº¯" class="headerlink" title="DFS+å›æº¯"></a>DFS+å›æº¯</h2><p>æ€è·¯ï¼šå…ˆé¢„å¤„ç†æ¯ä¸ªæ£‹å­çš„æ‰€æœ‰åˆæ³•ç§»åŠ¨ã€‚å†™ä¸€ä¸ªå›æº¯ï¼Œæš´åŠ›æšä¸¾æ¯ä¸ªæ£‹å­çš„æ¯ä¸ªåˆæ³•ç§»åŠ¨ï¼Œå¦‚æœè¿™äº›æ£‹å­æ²¡æœ‰é‡å åœ¨ä¸€èµ·ï¼Œåˆ™ç­”æ¡ˆåŠ ä¸€ã€‚</p><p>å…·ä½“æ¥è¯´, åˆæ³•ç§»åŠ¨åŒ…å«:</p><ul><li>æ£‹å­çš„åˆå§‹ä½ç½® $\left(x_0, y_0\right)$ ã€‚</li><li>æ£‹å­çš„ç§»åŠ¨æ–¹å‘ $\left(d_x, d_y\right)$ ã€‚</li><li>æ£‹å­çš„ç§»åŠ¨æ¬¡æ•° stepã€‚</li></ul><p>åœ¨å›æº¯æ—¶ï¼Œå¯ä»¥å‰ªæï¼šå¦‚æœå½“å‰æ£‹å­çš„å½“å‰è¿™ä¸ªåˆæ³•ç§»åŠ¨ï¼Œä¸å‰é¢çš„æ£‹å­å†²çªï¼Œå³åŒä¸€æ—¶åˆ»ä¸¤ä¸ªæ£‹å­é‡å ï¼Œé‚£ä¹ˆä¸å¾€ä¸‹é€’å½’ï¼Œæšä¸¾å½“å‰æ£‹å­çš„ä¸‹ä¸€ä¸ªåˆæ³•ç§»åŠ¨ã€‚</p><p>è¿™ä¸ªå›æº¯çš„ç‰¹ç‚¹æ˜¯å±‚æ•°å¾ˆå¤šï¼ŒæŠŠæ¯ä¸ªèŠ‚ç‚¹æƒ³è±¡æˆç¥ç»ç½‘ç»œçš„ä¸€å±‚ï¼Œæ¯å±‚çš„èŠ‚ç‚¹æ•°é‡æ˜¯åˆæ³•ç§»åŠ¨çš„æ•°é‡ï¼Œæœ€ç»ˆè®¡ç®—æ˜¯å…¶å…¨è¿æ¥çš„ç»“æœç´¯åŠ ã€‚ä¸”åœ¨åˆ¤æ–­æ˜¯å¦å›æº¯æ—¶ï¼Œè¦ç¬¦åˆæ‰€æœ‰å…ˆå‰èŠ‚ç‚¹çš„ç§»åŠ¨ï¼Œç”±äºè¿™äº›ç§»åŠ¨å¯èƒ½æ‰€å¤„çš„æ—¶é—´æ­¥ä¸åŒï¼Œæ‰€ä»¥éœ€è¦æ¨¡æ‹Ÿå…¶å‘å±•è¿‡ç¨‹ï¼Œç¡®è®¤ç§»åŠ¨è¿‡ç¨‹ä¸­ä¸å­˜åœ¨å†²çªå³åˆæ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ¯ç§æ£‹å­çš„ç§»åŠ¨æ–¹å‘</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;Character, <span class="keyword">int</span>[][]&gt; PIECE_DIRS = Map.of(</span><br><span class="line">        <span class="string">&#x27;r&#x27;</span>, <span class="keyword">new</span> <span class="keyword">int</span>[][]&#123;&#123;-<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, -<span class="number">1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;&#125;, <span class="comment">// è½¦</span></span><br><span class="line">        <span class="string">&#x27;b&#x27;</span>, <span class="keyword">new</span> <span class="keyword">int</span>[][]&#123;&#123;<span class="number">1</span>, <span class="number">1</span>&#125;, &#123;-<span class="number">1</span>, <span class="number">1</span>&#125;, &#123;-<span class="number">1</span>, -<span class="number">1</span>&#125;, &#123;<span class="number">1</span>, -<span class="number">1</span>&#125;&#125;, <span class="comment">// è±¡</span></span><br><span class="line">        <span class="string">&#x27;q&#x27;</span>, <span class="keyword">new</span> <span class="keyword">int</span>[][]&#123;&#123;-<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, -<span class="number">1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">1</span>&#125;, &#123;-<span class="number">1</span>, <span class="number">1</span>&#125;, &#123;-<span class="number">1</span>, -<span class="number">1</span>&#125;, &#123;<span class="number">1</span>, -<span class="number">1</span>&#125;&#125; <span class="comment">// çš‡å</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countCombinations</span><span class="params">(String[] pieces, <span class="keyword">int</span>[][] positions)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = pieces.length;</span><br><span class="line">        <span class="comment">// é¢„å¤„ç†æ‰€æœ‰åˆæ³•ç§»åŠ¨</span></span><br><span class="line">        Move[][] allMoves = <span class="keyword">new</span> Move[n][];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            allMoves[i] = generateMoves(positions[i][<span class="number">0</span>], positions[i][<span class="number">1</span>], PIECE_DIRS.get(pieces[i].charAt(<span class="number">0</span>)));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Move[] path = <span class="keyword">new</span> Move[n]; <span class="comment">// æ³¨æ„ path çš„é•¿åº¦æ˜¯å›ºå®šçš„</span></span><br><span class="line">        <span class="keyword">return</span> dfs(<span class="number">0</span>, n, allMoves, path);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Java 14 å¼•å…¥çš„ä¸å¯å˜çš„æ•°æ®è½½ä½“ç±»ï¼ŒJava 16 æˆä¸ºæ­£å¼ç‰¹æ€§</span></span><br><span class="line">    <span class="comment">// èµ·ç‚¹ (x0,y0)ï¼Œç§»åŠ¨æ–¹å‘ (dx,dy)ï¼Œç§»åŠ¨æ¬¡æ•° step</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> record <span class="title">Move</span><span class="params">(<span class="keyword">int</span> x0, <span class="keyword">int</span> y0, <span class="keyword">int</span> dx, <span class="keyword">int</span> dy, <span class="keyword">int</span> step)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—ä½äº (x0,y0) çš„æ£‹å­åœ¨ dirs è¿™äº›æ–¹å‘ä¸Šçš„æ‰€æœ‰åˆæ³•ç§»åŠ¨</span></span><br><span class="line">    <span class="keyword">private</span> Move[] generateMoves(<span class="keyword">int</span> x0, <span class="keyword">int</span> y0, <span class="keyword">int</span>[][] dirs) &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> SIZE = <span class="number">8</span>;</span><br><span class="line">        List&lt;Move&gt; moves = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        moves.add(<span class="keyword">new</span> Move(x0, y0, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)); <span class="comment">// åŸåœ°ä¸åŠ¨</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] d : dirs) &#123;</span><br><span class="line">            <span class="comment">// å¾€ d æ–¹å‘èµ° 1,2,3,... æ­¥</span></span><br><span class="line">            <span class="keyword">int</span> x = x0 + d[<span class="number">0</span>], y = y0 + d[<span class="number">1</span>];</span><br><span class="line">            <span class="comment">// è¿™é‡Œä¸é™åˆ¶stepçš„å¤§å°ï¼Œåªæ˜¯æ²¿ç€ä¸€ä¸ªæ–¹å‘ä¸€ç›´èµ°</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> step = <span class="number">1</span>; <span class="number">0</span> &lt; x &amp;&amp; x &lt;= SIZE &amp;&amp; <span class="number">0</span> &lt; y &amp;&amp; y &lt;= SIZE; step++) &#123;</span><br><span class="line">                moves.add(<span class="keyword">new</span> Move(x0, y0, d[<span class="number">0</span>], d[<span class="number">1</span>], step));</span><br><span class="line">                x += d[<span class="number">0</span>];</span><br><span class="line">                y += d[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> moves.toArray(Move[]::<span class="keyword">new</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ¤æ–­ä¸¤ä¸ªç§»åŠ¨æ˜¯å¦åˆæ³•ï¼Œå³ä¸å­˜åœ¨åŒä¸€æ—¶åˆ»ä¸¤ä¸ªæ£‹å­é‡å çš„æƒ…å†µ</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isValid</span><span class="params">(Move m1, Move m2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x1 = m1.x0, y1 = m1.y0; <span class="comment">// åˆå§‹ä½ç½®</span></span><br><span class="line">        <span class="keyword">int</span> x2 = m2.x0, y2 = m2.y0;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Math.max(m1.step, m2.step); i++) &#123;</span><br><span class="line">            <span class="comment">// æ¯ä¸€ç§’èµ°ä¸€æ­¥</span></span><br><span class="line">            <span class="keyword">if</span> (i &lt; m1.step) &#123;</span><br><span class="line">                x1 += m1.dx;</span><br><span class="line">                y1 += m1.dy;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; m2.step) &#123;</span><br><span class="line">                x2 += m2.dx;</span><br><span class="line">                y2 += m2.dy;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (x1 == x2 &amp;&amp; y1 == y2) &#123; <span class="comment">// é‡å </span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> n, Move[][] allMoves, Move[] path)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// iè¡¨ç¤ºç¬¬iä¸ªæ£‹å­ï¼Œ æƒ³è±¡ä¸€å…±æœ‰3ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸‰ä¸ªåˆæ³•æ–¹å‘ï¼Œåˆ™è¯¥ä»£ç å¯¹å…¶è¿›è¡Œå…¨è¿æ¥ç´¯åŠ ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (i == n) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// æ ‡ç­¾è¯­æ³•ï¼Œç”¨äºæ§åˆ¶ç‰¹å®šå±‚æ¬¡çš„å¾ªç¯æˆ–æå‰é€€å‡ºå¤šå±‚å¾ªç¯</span></span><br><span class="line">        outer:</span><br><span class="line">        <span class="comment">// æšä¸¾å½“å‰æ£‹å­çš„æ‰€æœ‰åˆæ³•ç§»åŠ¨</span></span><br><span class="line">        <span class="keyword">for</span> (Move move1 : allMoves[i]) &#123;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­åˆæ³•ç§»åŠ¨ move1 æ˜¯å¦æœ‰æ•ˆ</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!isValid(move1, path[j])) &#123;</span><br><span class="line">                    <span class="keyword">continue</span> outer; <span class="comment">// æ— æ•ˆï¼Œæšä¸¾ä¸‹ä¸€ä¸ª move1</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            path[i] = move1; <span class="comment">// ç›´æ¥è¦†ç›–ï¼Œæ— éœ€æ¢å¤ç°åœº</span></span><br><span class="line">            res += dfs(i + <span class="number">1</span>, n, allMoves, path); <span class="comment">// æšä¸¾åç»­æ£‹å­çš„æ‰€æœ‰åˆæ³•ç§»åŠ¨ç»„åˆ</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Knight-Probability-in-Chessboard"><a href="#Knight-Probability-in-Chessboard" class="headerlink" title="Knight Probability in Chessboard"></a><a href="https://leetcode.cn/problems/knight-probability-in-chessboard/description/?envType=daily-question&amp;envId=2024-12-07">Knight Probability in Chessboard</a></h1><p>åŸé—®é¢˜æ˜¯Knightèµ°$k$æ­¥åç•™åœ¨æ£‹ç›˜ä¸Šçš„æ¦‚ç‡ï¼Œèµ°å‡ºä¸€æ­¥åï¼Œé—®é¢˜å˜ä¸ºäº†Knightèµ°$k-1$æ­¥åç•™åœ¨æ£‹ç›˜ä¸Šçš„æ¦‚ç‡ï¼Œæ˜¯ä¸€ä¸ªè§„æ¨¡æ›´å°çš„å­é—®é¢˜ï¼Œå¯é€’å½’æ±‚è§£ã€‚ç›´æ¥é€’å½’è¶…æ—¶ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] factor1 = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>&#125;;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] factor2 = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;-<span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">knightProbability</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k, <span class="keyword">int</span> row, <span class="keyword">int</span> column)</span> </span>&#123;</span><br><span class="line">        move(n, k, <span class="number">0</span>, row, column);</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">double</span>)total/(<span class="keyword">double</span>)Math.pow(<span class="number">8</span>, k);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k, <span class="keyword">int</span> cnt, <span class="keyword">int</span> r, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(r&gt;=n||c&gt;=n||r&lt;<span class="number">0</span>||c&lt;<span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span>(cnt==k)&#123;</span><br><span class="line">            total++;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç»„åˆè½ç‚¹</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> f1:factor1)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> f2:factor2)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> f3:factor2)&#123;</span><br><span class="line">                    move(n, k, cnt+<span class="number">1</span>, r+f1*f2, c+(<span class="number">3</span>-f1)*f3);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è®°å¿†åŒ–æœç´¢"><a href="#è®°å¿†åŒ–æœç´¢" class="headerlink" title="è®°å¿†åŒ–æœç´¢"></a>è®°å¿†åŒ–æœç´¢</h2><p>ä¸Šé¢çš„è§£æ³•æœ‰ä¸€ä¸ªé—®é¢˜ï¼šé€’å½’å‡½æ•°ä¸å¯è®°å¿†ï¼Œæ— æ³•è¿›è¡Œä¼˜åŒ–ã€‚å› æ­¤éœ€è¦é‡æ–°ç¡®å®šçŠ¶æ€å’Œè®¡ç®—æ–¹å¼ã€‚</p><p>å®šä¹‰çŠ¶æ€ä¸º $dfs(k,i,j)$ï¼Œè¡¨ç¤ºä» $(i,j)$ å‡ºå‘ï¼Œèµ° $k$ æ­¥åä»ç„¶åœ¨æ£‹ç›˜ä¸Šçš„<strong>æ¦‚ç‡</strong>ã€‚</p><p>æšä¸¾å¯èµ°çš„å…«ä¸ªæ–¹å‘, å…¶ä¸­æœ‰ $\frac{1}{8}$ æ¦‚ç‡èµ°åˆ°äº† $(x, y)$, é—®é¢˜å˜æˆï¼š</p><ul><li>ä» $(x, y)$ å‡ºå‘, èµ° $k-1$ æ­¥åä»ç„¶åœ¨æ£‹ç›˜ä¸Šçš„æ¦‚ç‡, å³ $d f s(k-1, x, y)$</li></ul><p>å…«ç§æƒ…å†µç´¯åŠ ï¼Œå¾—</p><script type="math/tex; mode=display">d f s(k, i, j)=\frac{1}{8} \sum_{(x, y)} d f s(k-1, x, y)</script><p>é€’å½’è¾¹ç•Œï¼šå¦‚æœKnightå‡ºç•Œ, é‚£ä¹ˆåœ¨æ£‹ç›˜ä¸Šçš„æ¦‚ç‡ä¸º 0 , å³ $d f s(k, i, j)=0$ ã€‚å¦‚æœ $k=0$ æ—¶Knightä»ç„¶åœ¨æ£‹ç›˜ä¸Š, é‚£ä¹ˆæ¦‚ç‡ä¸º 1 , å³ $d f s(0, i, j)=1$ ã€‚</p><p>é€’å½’å…¥å£ï¼š$d f s(k, r o w, c o l u m n)$, ä¹Ÿå°±æ˜¯ç­”æ¡ˆã€‚</p><p>ä¸‰ã€é€’å½’æœç´¢ + ä¿å­˜é€’å½’è¿”å›å€¼ = è®°å¿†åŒ–æœç´¢<br>è€ƒè™‘åˆ°æ•´ä¸ªé€’å½’è¿‡ç¨‹ä¸­æœ‰å¤§é‡é‡å¤é€’å½’è°ƒç”¨ï¼ˆé€’å½’å…¥å‚ç›¸åŒï¼‰ã€‚ç”±äºé€’å½’å‡½æ•°æ²¡æœ‰å‰¯ä½œç”¨, åŒæ ·çš„å…¥å‚æ— è®ºè®¡ç®—å¤šå°‘æ¬¡, ç®—å‡ºæ¥çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„, å› æ­¤å¯ä»¥ç”¨è®°å¿†åŒ–æœç´¢æ¥ä¼˜åŒ–ï¼š</p><ul><li>å¦‚æœä¸€ä¸ªçŠ¶æ€ï¼ˆé€’å½’å…¥å‚ï¼‰æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨è¿”å›å‰ï¼ŒæŠŠçŠ¶æ€åŠå…¶ç»“æœè®°åˆ°ä¸€ä¸ª memo æ•°ç»„ä¸­ã€‚</li><li>å¦‚æœä¸€ä¸ªçŠ¶æ€ä¸æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°ï¼ˆmemo ä¸­ä¿å­˜çš„ç»“æœä¸ç­‰äº memo çš„åˆå§‹å€¼), é‚£ä¹ˆå¯ä»¥ç›´æ¥è¿”å› memo ä¸­ä¿å­˜çš„ç»“æœã€‚</li></ul><p>æ³¨æ„ï¼šmemo æ•°ç»„çš„åˆå§‹å€¼ä¸€å®šä¸èƒ½ç­‰äºè¦è®°å¿†åŒ–çš„å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span>[][] DIRS = &#123;&#123;<span class="number">2</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">2</span>&#125;, &#123;-<span class="number">1</span>, <span class="number">2</span>&#125;, &#123;-<span class="number">2</span>, <span class="number">1</span>&#125;, &#123;-<span class="number">2</span>, -<span class="number">1</span>&#125;, &#123;-<span class="number">1</span>, -<span class="number">2</span>&#125;, &#123;<span class="number">1</span>, -<span class="number">2</span>&#125;, &#123;<span class="number">2</span>, -<span class="number">1</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">knightProbability</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k, <span class="keyword">int</span> row, <span class="keyword">int</span> column)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span>[][][] memo = <span class="keyword">new</span> <span class="keyword">double</span>[k + <span class="number">1</span>][n][n];</span><br><span class="line">        <span class="keyword">return</span> dfs(k, row, column, n, memo);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> n, <span class="keyword">double</span>[][][] memo)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || j &lt; <span class="number">0</span> || i &gt;= n || j &gt;= n) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (k == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (memo[k][i][j] &gt; <span class="number">0</span>) &#123; <span class="comment">// ä¹‹å‰è®¡ç®—è¿‡</span></span><br><span class="line">            <span class="keyword">return</span> memo[k][i][j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">double</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] d : DIRS) &#123;</span><br><span class="line">            res += dfs(k - <span class="number">1</span>, i + d[<span class="number">0</span>], j + d[<span class="number">1</span>], n, memo);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> memo[k][i][j] = res / DIRS.length; <span class="comment">// è®°å¿†åŒ–</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Transform-to-Chessboard"><a href="#Transform-to-Chessboard" class="headerlink" title="Transform to Chessboard"></a><a href="https://leetcode.cn/problems/transform-to-chessboard/description/?envType=daily-question&amp;envId=2024-12-08">Transform to Chessboard</a></h1><p>è¶…çº²äº†ï¼Œç«é€ŸæŠ•é™æ”¾è¿‡è‡ªå·±ã€‚</p><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://leetcode.cn/problems/knight-probability-in-chessboard/solutions/2997395/jiao-ni-yi-bu-bu-si-kao-dpcong-ji-yi-hua-dgt6/?envType=daily-question&amp;envId=2024-12-07">https://leetcode.cn/problems/knight-probability-in-chessboard/solutions/2997395/jiao-ni-yi-bu-bu-si-kao-dpcong-ji-yi-hua-dgt6/?envType=daily-question&amp;envId=2024-12-07</a><br>[2] <a href="https://leetcode.cn/problems/number-of-valid-move-combinations-on-chessboard/solutions/1075478/go-mo-ni-by-endlesscheng-kjpt/?envType=daily-question&amp;envId=2024-12-04">https://leetcode.cn/problems/number-of-valid-move-combinations-on-chessboard/solutions/1075478/go-mo-ni-by-endlesscheng-kjpt/?envType=daily-question&amp;envId=2024-12-04</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;æœ€è¿‘å¿™ç€åšæ¯•è®¾å®éªŒï¼Œä¹‹å‰çš„å‘¨è®°éƒ½æç½®äº†ã€‚å®éªŒæœ‰äº†äº›ç»“æœï¼Œè¿˜ä¸é”™ã€‚è¿™å‘¨æ˜¯æ¯æ—¥ä¸€æ£‹ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨ä¸»é¢˜ï¼šå¤æ‚å›æº¯ã€è®°å¿†åŒ–æœç´¢&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;241204æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/number-of-valid-move-combinations-on-chessboard/description/?envType=daily-question&amp;amp;envId=2024-12-04&quot;&gt;Number of Valid Move Combinations On Chessboard&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;241207æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/knight-probability-in-chessboard/description/?envType=daily-question&amp;amp;envId=2024-12-07&quot;&gt;Knight Probability in Chessboard&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;241208æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/transform-to-chessboard/description/?envType=daily-question&amp;amp;envId=2024-12-08&quot;&gt;Transform to Chessboard&lt;/a&gt;</summary>
    
    
    
    
    <category term="LeetCode" scheme="http://silencezheng.top/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>å¹¶æŸ¥é›†Disjoint Set Union</title>
    <link href="http://silencezheng.top/2024/10/28/article150/"/>
    <id>http://silencezheng.top/2024/10/28/article150/</id>
    <published>2024-10-27T16:54:36.000Z</published>
    <updated>2024-10-27T16:56:16.871Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘åšç¬”è¯•å’Œåˆ·é¢˜éƒ½é‡åˆ°å¹¶æŸ¥é›†ï¼ˆDisjoint Set Union, DSUï¼‰çš„é¢˜ç›®äº†ï¼Œå­¦ä¹ ä¸€ä¸‹ã€‚<br><span id="more"></span></p><h1 id="å¹¶æŸ¥é›†ï¼ˆDisjoint-Set-Union-DSUï¼‰"><a href="#å¹¶æŸ¥é›†ï¼ˆDisjoint-Set-Union-DSUï¼‰" class="headerlink" title="å¹¶æŸ¥é›†ï¼ˆDisjoint Set Union, DSUï¼‰"></a>å¹¶æŸ¥é›†ï¼ˆDisjoint Set Union, DSUï¼‰</h1><p>å‡è®¾ä¸€ä¸ªåœºæ™¯ï¼Œ$n$ä¸ªäººè¦ä¹ˆå±äºAå¸®æ´¾ï¼Œè¦ä¹ˆå±äºBå¸®æ´¾ï¼Œä¸€ä¸ªäººå±äºæŸå¸®æ´¾çš„æ–¹å¼æ˜¯ç›´æ¥æˆ–é—´æ¥çš„ç»™å¸®æ´¾è€å¤§æ‰“å·¥ï¼Œå¦‚ä½•å¿«é€Ÿåˆ¤æ–­ä¸¤äººæ˜¯å¦å±äºåŒä¸€å¸®æ´¾å‘¢ï¼Ÿéå¸¸ç®€å•ï¼Œçœ‹ä¸¤äººæ˜¯å¦éƒ½ç»™åŒä¸€å¸®æ´¾è€å¤§æ‰“å·¥å°±å¯ä»¥äº†ã€‚</p><p>ç”±æ­¤å¼•å‡ºä¸€ç§æ•°æ®ç»“æ„ï¼š<strong>å¹¶æŸ¥é›†</strong>ã€‚å¹¶æŸ¥é›†ç”¨äºè§£å†³ä¸€äº›å…ƒç´ åˆ†ç»„çš„é—®é¢˜ã€‚å®ƒç®¡ç†ä¸€ç³»åˆ—<strong>ä¸ç›¸äº¤</strong>çš„é›†åˆï¼Œå¹¶æ”¯æŒä¸¤ç§æ“ä½œï¼š</p><ol><li>åˆå¹¶ï¼ˆUnionï¼‰ï¼šæŠŠä¸¤ä¸ªä¸ç›¸äº¤çš„é›†åˆåˆå¹¶ä¸ºä¸€ä¸ªé›†åˆã€‚</li><li>æŸ¥è¯¢ï¼ˆFindï¼‰ï¼šæŸ¥è¯¢ä¸¤ä¸ªå…ƒç´ æ˜¯å¦åœ¨åŒä¸€ä¸ªé›†åˆä¸­ã€‚</li></ol><p>å¹¶æŸ¥é›†çš„ä¸€ä¸ªåº”ç”¨å‰ææ˜¯æŸä¸€æˆå‘˜åªèƒ½å½’å±åˆ°è‡³å¤šä¸€ä¸ªåˆ†ç»„ä¹‹ä¸­ã€‚å°†é›†åˆçš„åˆå§‹çŠ¶æ€è®¾ç½®ä¸ºæ‰€æœ‰æˆå‘˜éƒ½è®¤ä¸ºè‡ªå·±æ˜¯å¸®æ´¾è€å¤§ï¼ˆåˆ†ç»„æ ¹èŠ‚ç‚¹ï¼‰ï¼Œç„¶åé€šè¿‡<strong>æˆå‘˜å…³ç³»</strong>ï¼ˆä¾‹å¦‚å›¾ä¸Šçš„è¿æ¥å…³ç³»ï¼‰è¿›è¡Œåˆ†ç»„åˆå¹¶ï¼Œæœ€ç»ˆä¼šå¾—åˆ°å¦‚ä¸‹å½¢å¼çš„åˆ†ç»„ç»“æœï¼Œè¿™äº›æ ‘çŠ¶å­ç»“æ„çš„é›†åˆç§°ä¸ºå¹¶æŸ¥é›†ã€‚</p><p><img src="/assets/post_img/article150/bcj.png" alt="å¹¶æŸ¥é›†"></p><p>å¯ä»¥æ³¨æ„åˆ°æ¯ä¸€ä¸ªæ ‘çŠ¶å­ç»“æ„å­˜åœ¨å”¯ä¸€ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œæ ¹èŠ‚ç‚¹è‡ªå·±ä¹ŸæŒ‡å‘æ ¹èŠ‚ç‚¹ï¼Œå› æ­¤å¯ä»¥æ¨å‡ºä¸¤ç§æ“ä½œçš„å®ç°ï¼š</p><ol><li>åˆå¹¶ï¼ˆUnionï¼‰ï¼šå°†Båˆå¹¶è¿›Aä¸­ï¼Œåªéœ€è¦å°†Bçš„æ ¹èŠ‚ç‚¹æŒ‡å‘Aä¸­çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹å³å¯ï¼Œä½†ç›´æ¥æŒ‡å‘Açš„æ ¹èŠ‚ç‚¹å¯ä»¥æœ€å¤§ç¨‹åº¦çš„å‡å°‘æ ‘é«˜ã€‚</li><li>æŸ¥è¯¢ï¼ˆFindï¼‰ï¼šæŸ¥è¯¢æŸèŠ‚ç‚¹å±äºå“ªä¸ªé›†åˆï¼Œåªéœ€è¦é€’å½’çš„å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°è‡ªèº«æŒ‡å‘è‡ªèº«çš„æ ¹èŠ‚ç‚¹ã€‚ç”±æ­¤ä¹Ÿå¯ä»¥å¾—å‡ºç»“è®ºï¼Œæ ‘é«˜è¶Šä½ï¼ŒæŸ¥è¯¢æ•ˆç‡è¶Šé«˜ã€‚</li></ol><h1 id="æœ€ç®€å®ç°"><a href="#æœ€ç®€å®ç°" class="headerlink" title="æœ€ç®€å®ç°"></a>æœ€ç®€å®ç°</h1><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªé•¿åº¦ä¸º$n$çš„æ•°ç»„æ¥å­˜å‚¨$n$ä¸ªèŠ‚ç‚¹å„è‡ªçš„çˆ¶èŠ‚ç‚¹ã€‚åˆçŠ¶æ€ä¸‹å„èŠ‚ç‚¹æŒ‡å‘è‡ªèº«ã€‚æ“ä½œçš„å®ç°æŒ‰ç…§å‰é¢çš„åˆ†æè¿›è¡Œï¼Œå³â€œæ ¹åˆå¹¶åˆ°æ ¹â€å’Œâ€é€’å½’æŸ¥è¯¢â€œã€‚å¯ä»¥çœ‹åˆ°ä½¿ç”¨å¾ˆå°‘çš„ä»£ç é‡å³å¯å®ç°å¹¶æŸ¥é›†ç»“æ„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleDisjointSet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] parent;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æ¯ä¸ªå…ƒç´ å½¢æˆä¸€ä¸ªç‹¬ç«‹çš„é›†åˆ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SimpleDisjointSet</span><span class="params">(<span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">        parent = <span class="keyword">new</span> <span class="keyword">int</span>[size];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            parent[i] = i;  <span class="comment">// æ¯ä¸ªå…ƒç´ çš„çˆ¶èŠ‚ç‚¹æŒ‡å‘è‡ªå·±</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥æ‰¾ç»™å®šå…ƒç´ æ‰€å±çš„é›†åˆçš„æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (parent[x] != x) &#123;</span><br><span class="line">            <span class="keyword">return</span> find(parent[x]);  <span class="comment">// é€’å½’æŸ¥æ‰¾ç›´åˆ°æ‰¾åˆ°æ ¹èŠ‚ç‚¹</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå¹¶ä¸¤ä¸ªé›†åˆ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rootX = find(x);</span><br><span class="line">        <span class="keyword">int</span> rootY = find(y);</span><br><span class="line">        <span class="keyword">if</span> (rootX != rootY) &#123;</span><br><span class="line">            parent[rootX] = rootY;  <span class="comment">// å°†xæ‰€åœ¨çš„é›†åˆè¿æ¥åˆ°yæ‰€åœ¨çš„é›†åˆï¼Œæ ¹åˆå¹¶åˆ°æ ¹</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æµ‹è¯•æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SimpleDisjointSet dsu = <span class="keyword">new</span> SimpleDisjointSet(<span class="number">10</span>);  <span class="comment">// åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º10çš„å¹¶æŸ¥é›†</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‰§è¡Œä¸€äº›åˆå¹¶æ“ä½œ</span></span><br><span class="line">        dsu.union(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">        dsu.union(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">        dsu.union(<span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">        dsu.union(<span class="number">6</span>, <span class="number">7</span>);</span><br><span class="line">        dsu.union(<span class="number">7</span>, <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æŸ¥è¯¢ä¸€äº›å…ƒç´ æ˜¯å¦å±äºåŒä¸€ä¸ªé›†åˆ</span></span><br><span class="line">        System.out.println(dsu.find(<span class="number">1</span>) == dsu.find(<span class="number">3</span>));  <span class="comment">// true</span></span><br><span class="line">        System.out.println(dsu.find(<span class="number">1</span>) == dsu.find(<span class="number">5</span>));  <span class="comment">// false</span></span><br><span class="line">        System.out.println(dsu.find(<span class="number">6</span>) == dsu.find(<span class="number">8</span>));  <span class="comment">// true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="è·¯å¾„å‹ç¼©"><a href="#è·¯å¾„å‹ç¼©" class="headerlink" title="è·¯å¾„å‹ç¼©"></a>è·¯å¾„å‹ç¼©</h1><p>åœ¨ä¸Šé¢çš„å®ç°ä¸­ï¼Œå…¶å®å·²ç»åšåˆ°äº†æ‰€è°“çš„è·¯å¾„å‹ç¼©ï¼Œå³å°½å¯èƒ½å‡å°‘æ ‘é«˜ï¼Œè®©å¸®æ´¾æˆå‘˜éƒ½ç›´æ¥ç»™è€å¤§æ‰“å·¥ã€‚</p><p>ä¸€ç§æ–¹å¼æ˜¯ä»åˆå¹¶æ–¹æ³•å…¥æ‰‹ï¼Œå¦ä¸€ç§æ–¹å¼æ˜¯ä»æŸ¥è¯¢ä¸Šå®ç°è·¯å¾„å‹ç¼©ï¼Œè¿™é‡Œç»™å‡ºä»æŸ¥è¯¢è§’åº¦å®ç°çš„ä»£ç ã€‚æ ¸å¿ƒæ€æƒ³å°±æ˜¯åœ¨æ¯ä¸€æ¬¡æŸ¥è¯¢çš„é€’å½’è¿‡ç¨‹ä¸­é‡æ„æ ‘ï¼Œæ­¤æ—¶åˆå¹¶éƒ¨åˆ†å¯ä»¥ä¸ç”¨åšå‹ç¼©å¤„ç†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="comment">// æŸ¥æ‰¾ç»™å®šå…ƒç´ æ‰€å±çš„é›†åˆçš„æ ¹èŠ‚ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (parent[x] == x) &#123;</span><br><span class="line">        <span class="keyword">return</span> x;  <span class="comment">// æ‰¾åˆ°æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        parent[x] = find(parent[x]); <span class="comment">// é€’å½’è¿‡ç¨‹ä¸­æŠŠéæ ¹èŠ‚ç‚¹éƒ½æŒ‡å‘æ ¹èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">return</span> parent[x]; <span class="comment">// è¿”å›æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå¹¶ä¸¤ä¸ªé›†åˆ</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    parent[find(x)] = find(y); <span class="comment">// æŠŠxæ‰€åœ¨çš„é›†åˆåˆå¹¶åˆ°yæ‰€åœ¨çš„é›†åˆä¸Š</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æŒ‰ç§©åˆå¹¶"><a href="#æŒ‰ç§©åˆå¹¶" class="headerlink" title="æŒ‰ç§©åˆå¹¶"></a>æŒ‰ç§©åˆå¹¶</h1><p>å¹¶æŸ¥é›†å®¹æ˜“é™·å…¥ä¸€ä¸ªæ€ç»´è¯¯åŒºï¼šåº”ç”¨è·¯å¾„å‹ç¼©åï¼Œäº§ç”Ÿçš„æ ‘éƒ½æ˜¯â€èŠèŠ±å›¾ğŸŒ¼â€œï¼Œå³åªæœ‰ä¸¤å±‚çš„æ ‘ï¼Œä¸€ä¸ªæ ¹èŠ‚ç‚¹å’Œè‹¥å¹²ä¸€çº§å­èŠ‚ç‚¹ã€‚</p><p>å¯ä»¥è¯æ˜å®é™…æƒ…å†µå¹¶éå¦‚æ­¤ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line">dsu.union(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 1 -&gt; 2</span></span><br><span class="line">dsu.union(<span class="number">2</span>, <span class="number">3</span>); <span class="comment">// 1 -&gt; 2 -&gt; 3</span></span><br></pre></td></tr></table></figure></p><p>æ— è®ºå“ªç§è·¯å¾„å‹ç¼©æ–¹æ³•ï¼Œåœ¨ä¸æ‰§è¡ŒæŸ¥è¯¢çš„æƒ…å†µä¸‹ï¼Œåˆå§‹åŒ–å¹¶æŸ¥é›†æ—¶ä»ä¼šäº§ç”Ÿå¤šå±‚æ ‘ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå‡è®¾å½“å‰éœ€è¦å°†èŠ‚ç‚¹$8$åŠ å…¥èŠ‚ç‚¹$7$çš„åˆ†ç»„ä¸­ï¼Œæœ‰ä¸¤ç§æƒ…å†µã€‚</p><p><img src="/assets/post_img/article150/rankUnion.png" alt="ru"></p><p>æ˜¾ç„¶æˆ‘ä»¬åº”è¯¥é€‰æ‹©æ ‘é«˜æ›´ä½çš„åˆå¹¶æ–¹æ³•ï¼Œå³æŠŠé«˜åº¦æ›´ä½çš„æ ‘åˆå¹¶åˆ°æ›´é«˜çš„æ ‘ä¸Šã€‚</p><p>æˆ‘ä»¬ç”¨ä¸€ä¸ªæ•°ç»„$rank$è®°å½•æ¯ä¸ªæ ¹èŠ‚ç‚¹å¯¹åº”çš„æ ‘çš„æ·±åº¦ï¼ˆå¦‚æœä¸æ˜¯æ ¹èŠ‚ç‚¹ï¼Œå…¶rankç›¸å½“äºä»¥å®ƒä½œä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘çš„æ·±åº¦ï¼‰ã€‚ä¸€å¼€å§‹ï¼ŒæŠŠæ‰€æœ‰å…ƒç´ çš„rankï¼ˆç§©ï¼‰è®¾ä¸º1ã€‚åˆå¹¶æ—¶æ¯”è¾ƒä¸¤ä¸ªæ ¹èŠ‚ç‚¹ï¼ŒæŠŠrankè¾ƒå°è€…å¾€è¾ƒå¤§è€…ä¸Šåˆå¹¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DisjointSet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] parent;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] rank;  <span class="comment">// ç”¨äºè®°å½•æ¯ä¸ªèŠ‚ç‚¹æ‰€åœ¨æ ‘çš„é«˜åº¦ï¼ˆç§©ï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æ¯ä¸ªå…ƒç´ å½¢æˆä¸€ä¸ªç‹¬ç«‹çš„é›†åˆ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DisjointSet</span><span class="params">(<span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">        parent = <span class="keyword">new</span> <span class="keyword">int</span>[size];</span><br><span class="line">        rank = <span class="keyword">new</span> <span class="keyword">int</span>[size];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            parent[i] = i;  <span class="comment">// æ¯ä¸ªå…ƒç´ çš„çˆ¶èŠ‚ç‚¹æŒ‡å‘è‡ªå·±</span></span><br><span class="line">            rank[i] = <span class="number">0</span>;    <span class="comment">// åˆå§‹ç§©ä¸º0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥æ‰¾ç»™å®šå…ƒç´ æ‰€å±çš„é›†åˆçš„æ ¹èŠ‚ç‚¹ï¼Œå¹¶è¿›è¡Œè·¯å¾„å‹ç¼©</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (parent[x] != x) &#123;</span><br><span class="line">            <span class="comment">// è·¯å¾„å‹ç¼©ï¼šå°†xç›´æ¥æŒ‡å‘å…¶æœ€ç»ˆçš„æ ¹èŠ‚ç‚¹</span></span><br><span class="line">            parent[x] = find(parent[x]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> parent[x];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå¹¶ä¸¤ä¸ªé›†åˆï¼Œä½¿ç”¨æŒ‰ç§©åˆå¹¶</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rootX = find(x);</span><br><span class="line">        <span class="keyword">int</span> rootY = find(y);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (rootX != rootY) &#123;</span><br><span class="line">            <span class="comment">// æŒ‰ç§©åˆå¹¶</span></span><br><span class="line">            <span class="keyword">if</span> (rank[rootX] &gt; rank[rootY]) &#123;</span><br><span class="line">                parent[rootY] = rootX;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (rank[rootX] &lt; rank[rootY]) &#123;</span><br><span class="line">                parent[rootX] = rootY;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœç§©ç›¸åŒï¼Œåˆ™ä»»æ„é€‰æ‹©ä¸€ä¸ªä½œä¸ºæ–°çš„æ ¹èŠ‚ç‚¹ï¼Œå¹¶å¢åŠ è¯¥æ ¹èŠ‚ç‚¹çš„ç§©</span></span><br><span class="line">                parent[rootY] = rootX;</span><br><span class="line">                rank[rootX]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·¯å¾„å‹ç¼©å’ŒæŒ‰ç§©åˆå¹¶å¦‚æœä¸€èµ·ä½¿ç”¨ï¼Œæ—¶é—´å¤æ‚åº¦æ¥è¿‘$O(n)$ï¼Œä½†æ˜¯å¾ˆå¯èƒ½ä¼šç ´årankçš„å‡†ç¡®æ€§ã€‚åŸå› å¦‚ä¸‹ï¼š</p><ol><li>è·¯å¾„å‹ç¼©çš„å½±å“ï¼š<ul><li>è·¯å¾„å‹ç¼©åœ¨æŸ¥æ‰¾è¿‡ç¨‹ä¸­å°†è·¯å¾„ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹ç›´æ¥æŒ‡å‘æ ¹èŠ‚ç‚¹ï¼Œè¿™ä¼šæ”¹å˜æ ‘çš„ç»“æ„ã€‚</li><li>ç”±äºè·¯å¾„å‹ç¼©æ”¹å˜äº†æ ‘çš„é«˜åº¦ï¼Œä½† rank å€¼å¹¶æ²¡æœ‰ç›¸åº”æ›´æ–°ï¼Œå› æ­¤ rank å¯èƒ½ä¸å†å‡†ç¡®åæ˜ æ ‘çš„å®é™…é«˜åº¦ã€‚</li></ul></li><li>æŒ‰ç§©åˆå¹¶çš„å‡è®¾ï¼š<ul><li>æŒ‰ç§©åˆå¹¶åŸºäºä¸€ä¸ªå‡è®¾ï¼šrank å€¼åæ˜ äº†æ ‘çš„é«˜åº¦ï¼ˆæˆ–æ·±åº¦ï¼‰ã€‚</li><li>å¦‚æœè·¯å¾„å‹ç¼©å¯¼è‡´ rank ä¸å†å‡†ç¡®ï¼Œé‚£ä¹ˆæŒ‰ç§©åˆå¹¶çš„æ•ˆæœå¯èƒ½ä¼šå—åˆ°å½±å“ï¼Œå› ä¸ºåˆå¹¶æ“ä½œä¾èµ–äº rank æ¥å†³å®šå¦‚ä½•è¿æ¥ä¸¤æ£µæ ‘ã€‚</li></ul></li></ol><p>å› æ­¤åœ¨åŒæ—¶ä½¿ç”¨çš„æƒ…å†µä¸‹ï¼Œrankå€¼äº‹å®ä¸Šæ˜¯æ ‘çš„é«˜åº¦ä¸Šé™ã€‚å¯ä»¥çµæ´»é€‰æ‹©å¦‚ä½•ä½¿ç”¨æŒ‰ç§©åˆå¹¶ï¼Œè€ƒè™‘è·¯å¾„å‹ç¼©çš„æ‰°ä¹±å¯¹æ•´ä½“æ•ˆç‡çš„å½±å“ã€‚</p><h1 id="ä¾‹é¢˜ï¼šRedundant-Connection"><a href="#ä¾‹é¢˜ï¼šRedundant-Connection" class="headerlink" title="ä¾‹é¢˜ï¼šRedundant Connection"></a>ä¾‹é¢˜ï¼š<a href="https://leetcode.cn/problems/redundant-connection/description/?envType=daily-question&amp;envId=2024-10-27">Redundant Connection</a></h1><p>å¦‚æœä¸¤ä¸ªé¡¶ç‚¹å±äºç›¸åŒçš„è¿é€šåˆ†é‡ï¼Œåˆ™è¯´æ˜åœ¨éå†åˆ°å½“å‰çš„è¾¹ä¹‹å‰ï¼Œè¿™ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´å·²ç»è¿é€šï¼Œå› æ­¤å½“å‰çš„è¾¹å¯¼è‡´ç¯å‡ºç°ï¼Œä¸ºé™„åŠ çš„è¾¹ï¼Œå°†å½“å‰çš„è¾¹ä½œä¸ºç­”æ¡ˆè¿”å›ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] findRedundantConnection(<span class="keyword">int</span>[][] edges) &#123;</span><br><span class="line">        <span class="keyword">int</span> n = edges.length;</span><br><span class="line">        <span class="keyword">int</span>[] parent = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            parent[i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span>[] edge = edges[i];</span><br><span class="line">            <span class="keyword">int</span> node1 = edge[<span class="number">0</span>], node2 = edge[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (find(parent, node1) != find(parent, node2)) &#123;</span><br><span class="line">                union(parent, node1, node2);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> edge;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span>[] parent, <span class="keyword">int</span> index1, <span class="keyword">int</span> index2)</span> </span>&#123;</span><br><span class="line">        parent[find(parent, index1)] = find(parent, index2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span>[] parent, <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (parent[index] != index) &#123;</span><br><span class="line">            parent[index] = find(parent, parent[index]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> parent[index];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://zhuanlan.zhihu.com/p/93647900">https://zhuanlan.zhihu.com/p/93647900</a><br>[2] <a href="https://leetcode.cn/problems/redundant-connection/solutions/557616/rong-yu-lian-jie-by-leetcode-solution-pks2/?envType=daily-question&amp;envId=2024-10-27">https://leetcode.cn/problems/redundant-connection/solutions/557616/rong-yu-lian-jie-by-leetcode-solution-pks2/?envType=daily-question&amp;envId=2024-10-27</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;æœ€è¿‘åšç¬”è¯•å’Œåˆ·é¢˜éƒ½é‡åˆ°å¹¶æŸ¥é›†ï¼ˆDisjoint Set Union, DSUï¼‰çš„é¢˜ç›®äº†ï¼Œå­¦ä¹ ä¸€ä¸‹ã€‚&lt;br&gt;</summary>
    
    
    
    
    <category term="æ•°æ®ç»“æ„ä¸ç®—æ³•" scheme="http://silencezheng.top/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeå‘¨è®° EP6</title>
    <link href="http://silencezheng.top/2024/10/27/article149/"/>
    <id>http://silencezheng.top/2024/10/27/article149/</id>
    <published>2024-10-26T17:50:09.000Z</published>
    <updated>2024-10-27T15:28:19.835Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™å‘¨å¥½åƒæ˜¯åˆ’æ°´äº†ï¼Œåªæœ‰ä¸€é“é¢˜ã€‚</p><p>æœ¬å‘¨ä¸»é¢˜ï¼šæš´åŠ›æœç´¢ï¼ˆDFSï¼‰ã€Dijkstraç®—æ³•</p><p>é¢˜ç›®ï¼š</p><ul><li>240702æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/maximum-path-quality-of-a-graph/description">Maximum Path Quality of a Graph</a><span id="more"></span><h1 id="æš´åŠ›æœç´¢ï¼ˆDFSï¼‰"><a href="#æš´åŠ›æœç´¢ï¼ˆDFSï¼‰" class="headerlink" title="æš´åŠ›æœç´¢ï¼ˆDFSï¼‰"></a>æš´åŠ›æœç´¢ï¼ˆDFSï¼‰</h1>é¢˜ç›®ï¼š<a href="https://leetcode.cn/problems/maximum-path-quality-of-a-graph/description">Maximum Path Quality of a Graph</a></li></ul><p>ä¸€ä¸ªæ— å‘å¸¦æƒå›¾ï¼Œç»™å®šè¾¹å’Œæƒï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰<code>value</code>ã€‚å¦ç»™ä¸€å‚æ•°<code>maxTime</code>ï¼Œæ±‚<code>valid path(VP)</code>çš„æœ€å¤§<code>value</code>å’Œã€‚ä¸€ä¸ª<code>VP</code>æ˜¯ä¸€ä¸ª<code>0</code>èŠ‚ç‚¹çš„ç¯è·¯ï¼Œä¸”è·¯å¾„æ—¶é—´æ¶ˆè€—æ€»å’Œä¸è¶…è¿‡<code>maxTime</code>ï¼ŒåŒæ—¶æ¯ä¸ªèŠ‚ç‚¹çš„<code>value</code>åªè®¡ç®—ä¸€æ¬¡ã€‚å›¾ä¸­æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šæœ‰$4$æ¡è¾¹ã€‚</p><p>é¦–å…ˆåŸºäºé¢˜ç›®æ•°æ®èŒƒå›´ï¼Œå¯ä»¥é‡‡å–æš´åŠ›æœç´¢çš„æ–¹å¼ï¼Œä¸€æ¡<code>VP</code>çš„æœ€å¤§è¾¹æ•°ä¸º$\frac{maxTime}{\min (time_j)}$ï¼Œä¸”å›¾ä¸­æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šæœ‰$4$æ¡è¾¹ï¼Œåˆ™å¯ä»¥å¾—åˆ°æœç´¢æ ‘çš„å¤§å°ä¸º$\frac{maxTime}{\min (time_j)}+1$å±‚çš„$4$å‰æ ‘ã€‚</p><p>åœ¨æœ¬é¢˜ä¸­ï¼Œç©·ä¸¾çš„å†…å®¹æ˜¯ä¸€æ¡ç¯è·¯ï¼Œå› æ­¤é‡‡ç”¨DFSæš´åŠ›æœç´¢ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maximalPathQuality</span><span class="params">(<span class="keyword">int</span>[] values, <span class="keyword">int</span>[][] edges, <span class="keyword">int</span> maxTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = values.length;</span><br><span class="line">        List&lt;<span class="keyword">int</span>[]&gt;[] g = <span class="keyword">new</span> ArrayList[n];</span><br><span class="line">        Arrays.setAll(g, i -&gt; <span class="keyword">new</span> ArrayList&lt;&gt;());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] e : edges) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = e[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">int</span> y = e[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">int</span> t = e[<span class="number">2</span>];</span><br><span class="line">            g[x].add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;y, t&#125;);</span><br><span class="line">            g[y].add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;x, t&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span>[] vis = <span class="keyword">new</span> <span class="keyword">boolean</span>[n];</span><br><span class="line">        vis[<span class="number">0</span>] = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">return</span> dfs(<span class="number">0</span>, <span class="number">0</span>, values[<span class="number">0</span>], vis, g, values, maxTime);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> sumTime, <span class="keyword">int</span> sumValue, <span class="keyword">boolean</span>[] vis, List&lt;<span class="keyword">int</span>[]&gt;[] g, <span class="keyword">int</span>[] values, <span class="keyword">int</span> maxTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = x == <span class="number">0</span> ? sumValue : <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] e : g[x]) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = e[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">int</span> t = e[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (sumTime + t &gt; maxTime) &#123;</span><br><span class="line">                <span class="keyword">continue</span>; <span class="comment">// è¶…æ—¶ä¸­æ–­</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (vis[y]) &#123;</span><br><span class="line">                res = Math.max(res, dfs(y, sumTime + t, sumValue, vis, g, values, maxTime));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                vis[y] = <span class="keyword">true</span>;</span><br><span class="line">                <span class="comment">// æ¯ä¸ªèŠ‚ç‚¹çš„ä»·å€¼è‡³å¤šç®—å…¥ä»·å€¼æ€»å’Œä¸­ä¸€æ¬¡</span></span><br><span class="line">                res = Math.max(res, dfs(y, sumTime + t, sumValue + values[y], vis, g, values, maxTime));</span><br><span class="line">                vis[y] = <span class="keyword">false</span>; <span class="comment">// æ¢å¤ç°åœº</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é€’å½’å®ç°çš„DFSï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰é‚»æ¥ç‚¹é€çº¿è·¯è¿›è¡Œè®¿é—®ï¼Œè®¿é—®æ ‡è®°åœ¨é€’å½’è¿‡ç¨‹ä¸­ç”¨äºé˜²æ­¢æœç´¢å·²ç»è¿‡è·¯å¾„ï¼Œåœ¨æ•´æ¡è·¯å¾„æœç´¢ç»“æŸåé€ä¸ªæ¢å¤æ”¯æŒä¸‹ä¸€æ¬¡æœç´¢ï¼Œå½“é‡åˆ°å·²æœç´¢è¿‡çš„èŠ‚ç‚¹æ—¶ä¾ç„¶éœ€è¦è®¡ç®—ä¸€æ¬¡<code>max</code>å€¼ï¼Œå› ä¸ºæˆ‘ä»¬è¦æ‰¾çš„æ˜¯<code>0</code>èŠ‚ç‚¹çš„ç¯è·¯ï¼Œåªæœ‰é‡åˆ°<code>0</code>èŠ‚ç‚¹æ—¶æ‰ä¼šè´¡çŒ®<code>sumValue</code>ã€‚</p><p>è¿™ä¸ªæ—¶é—´å¤æ‚åº¦è®¡ç®—ä¹Ÿå¯ä»¥å­¦ä¹ ä¸€ä¸‹ï¼Œ$O(n+m+4^k)$ï¼Œä¸»è¦æ˜¯å››å‰æ ‘çš„å¤æ‚åº¦ã€‚ç©ºé—´å¤æ‚åº¦ä¸º$O(n+m+k)$ï¼Œå³ä¸€æ¬¡åªæ¶ˆè€—ä¸€æ¡è·¯å¾„çš„ç©ºé—´ã€‚</p><h2 id="Dijkstraç®—æ³•ä¼˜åŒ–æœç´¢"><a href="#Dijkstraç®—æ³•ä¼˜åŒ–æœç´¢" class="headerlink" title="Dijkstraç®—æ³•ä¼˜åŒ–æœç´¢"></a>Dijkstraç®—æ³•ä¼˜åŒ–æœç´¢</h2><p>ç”¨ Dijkstra ç®—æ³•é¢„å¤„ç†èµ·ç‚¹ 0 åˆ°æ¯ä¸ªèŠ‚ç‚¹çš„æœ€çŸ­è·¯ï¼Œè¿™ä¹Ÿæ˜¯æ¯ä¸ªèŠ‚ç‚¹åˆ° 0 çš„æœ€çŸ­è·¯ã€‚æœ¬é¢˜æ˜¯ç¨€ç–å›¾ï¼Œå¯ä»¥ä½¿ç”¨å †ä¼˜åŒ–çš„ Dijkstra ç®—æ³•ã€‚</p><p>åœ¨é€’å½’åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¹‹å‰ï¼Œåˆ¤æ–­ä¸‹ä¸€ä¸ªèŠ‚ç‚¹åœ¨èµ°æœ€çŸ­è·¯çš„å‰æä¸‹ï¼Œèƒ½å¦åœ¨ maxTime æ—¶é—´å†…å›åˆ°èµ·ç‚¹ 0ï¼Œè‹¥ä¸èƒ½åˆ™ä¸é€’å½’ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maximalPathQuality</span><span class="params">(<span class="keyword">int</span>[] values, <span class="keyword">int</span>[][] edges, <span class="keyword">int</span> maxTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = values.length;</span><br><span class="line">        List&lt;<span class="keyword">int</span>[]&gt;[] g = <span class="keyword">new</span> ArrayList[n];</span><br><span class="line">        Arrays.setAll(g, i -&gt; <span class="keyword">new</span> ArrayList&lt;&gt;());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] e : edges) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = e[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">int</span> y = e[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">int</span> t = e[<span class="number">2</span>];</span><br><span class="line">            g[x].add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;y, t&#125;);</span><br><span class="line">            g[y].add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;x, t&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Dijkstra ç®—æ³•</span></span><br><span class="line">        <span class="keyword">int</span>[] dis = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        Arrays.fill(dis, Integer.MAX_VALUE);</span><br><span class="line">        dis[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        PriorityQueue&lt;<span class="keyword">int</span>[]&gt; pq = <span class="keyword">new</span> PriorityQueue&lt;&gt;((a, b) -&gt; a[<span class="number">0</span>] - b[<span class="number">0</span>]);</span><br><span class="line">        pq.add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">        <span class="keyword">while</span> (!pq.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">int</span>[] p = pq.poll();</span><br><span class="line">            <span class="keyword">int</span> dx = p[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">int</span> x = p[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (dx &gt; dis[x]) &#123; <span class="comment">// x ä¹‹å‰å‡ºå †è¿‡</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span>[] e : g[x]) &#123;</span><br><span class="line">                <span class="keyword">int</span> y = e[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">int</span> newDis = dx + e[<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">if</span> (newDis &lt; dis[y]) &#123;</span><br><span class="line">                    dis[y] = newDis; <span class="comment">// æ›´æ–° x çš„é‚»å±…çš„æœ€çŸ­è·¯</span></span><br><span class="line">                    pq.offer(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;newDis, y&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span>[] vis = <span class="keyword">new</span> <span class="keyword">boolean</span>[n];</span><br><span class="line">        vis[<span class="number">0</span>] = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">return</span> dfs(<span class="number">0</span>, <span class="number">0</span>, values[<span class="number">0</span>], vis, g, values, maxTime, dis);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> sumTime, <span class="keyword">int</span> sumValue, <span class="keyword">boolean</span>[] vis, List&lt;<span class="keyword">int</span>[]&gt;[] g, <span class="keyword">int</span>[] values, <span class="keyword">int</span> maxTime, <span class="keyword">int</span>[] dis)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = x == <span class="number">0</span> ? sumValue : <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] e : g[x]) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = e[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">int</span> t = e[<span class="number">1</span>];</span><br><span class="line">            <span class="comment">// ç›¸æ¯”æ–¹æ³•ä¸€ï¼Œè¿™é‡Œå¤šäº† dis[y]</span></span><br><span class="line">            <span class="keyword">if</span> (sumTime + t + dis[y] &gt; maxTime) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (vis[y]) &#123;</span><br><span class="line">                res = Math.max(res, dfs(y, sumTime + t, sumValue, vis, g, values, maxTime, dis));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                vis[y] = <span class="keyword">true</span>;</span><br><span class="line">                <span class="comment">// æ¯ä¸ªèŠ‚ç‚¹çš„ä»·å€¼è‡³å¤šç®—å…¥ä»·å€¼æ€»å’Œä¸­ä¸€æ¬¡</span></span><br><span class="line">                res = Math.max(res, dfs(y, sumTime + t, sumValue + values[y], vis, g, values, maxTime, dis));</span><br><span class="line">                vis[y] = <span class="keyword">false</span>; <span class="comment">// æ¢å¤ç°åœº</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://leetcode.cn/problems/maximum-path-quality-of-a-graph/solutions/1088414/bao-sou-jian-zhi-by-endlesscheng-iv6z/">https://leetcode.cn/problems/maximum-path-quality-of-a-graph/solutions/1088414/bao-sou-jian-zhi-by-endlesscheng-iv6z/</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ </p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è¿™å‘¨å¥½åƒæ˜¯åˆ’æ°´äº†ï¼Œåªæœ‰ä¸€é“é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨ä¸»é¢˜ï¼šæš´åŠ›æœç´¢ï¼ˆDFSï¼‰ã€Dijkstraç®—æ³•&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;240702æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/maximum-path-quality-of-a-graph/description&quot;&gt;Maximum Path Quality of a Graph&lt;/a&gt;</summary>
    
    
    
    
    <category term="LeetCode" scheme="http://silencezheng.top/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>Dijkstraç®—æ³•</title>
    <link href="http://silencezheng.top/2024/10/27/article148/"/>
    <id>http://silencezheng.top/2024/10/27/article148/</id>
    <published>2024-10-26T17:35:58.000Z</published>
    <updated>2024-10-26T17:42:14.727Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å¯»æ‰¾å›¾ä¸­å•æºæœ€çŸ­è·¯å¾„çš„ç»å…¸ç®—æ³•ï¼Œæ­»å»çš„è€ƒç ”çŸ¥è¯†ç‚¹åœ¨æ”»å‡»æˆ‘â€¦ç†è®ºä¸å®è·µé‡æ–°å¤ä¹ ä¸€ä¸‹ã€‚<br><span id="more"></span></p><h1 id="Dijkstra-Algorithm"><a href="#Dijkstra-Algorithm" class="headerlink" title="Dijkstra Algorithm"></a>Dijkstra Algorithm</h1><p>Dijkstraç®—æ³•æ˜¯ä¸€ç§ç”¨äºå¯»æ‰¾å›¾ä¸­å•æºæœ€çŸ­è·¯å¾„çš„ç»å…¸ç®—æ³•ï¼Œç”±è·å…°è®¡ç®—æœºç§‘å­¦å®¶Edsger W. Dijkstraäº1956å¹´æå‡ºã€‚è¯¥ç®—æ³•é€‚ç”¨äºæœ‰å‘å›¾å’Œæ— å‘å›¾ï¼Œå¹¶ä¸”è¦æ±‚å›¾ä¸­çš„æ‰€æœ‰è¾¹æƒéƒ½æ˜¯éè´Ÿçš„ã€‚æ‰€è°“å•æºæœ€çŸ­è·¯å¾„ï¼Œå°±æ˜¯æ±‚æŸä¸€ç‚¹åˆ°å…¶ä»–å„é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚</p><p>Dijkstraç®—æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯è´ªå¿ƒç®—æ³•ã€‚å®ƒä»èµ·ç‚¹å¼€å§‹ï¼Œé€æ­¥æ‰©å±•åˆ°æ•´ä¸ªå›¾ï¼Œæ¯æ¬¡é€‰æ‹©å½“å‰å·²çŸ¥çš„æœ€çŸ­è·¯å¾„è¿›è¡Œæ‰©å±•ï¼Œç›´åˆ°æ‰¾åˆ°ä»èµ·ç‚¹åˆ°æ‰€æœ‰å…¶ä»–é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚</p><p>ç®—æ³•æ­¥éª¤ï¼š</p><ol><li>å¯¹äºå›¾$G$ï¼Œè®¾è¾…åŠ©å‘é‡$S$å’Œ$D$ï¼Œå…¶ä¸­$S$è®°å½•å·²æ±‚å‡ºçš„æœ€çŸ­è·¯å¾„ï¼Œ$D$è®°å½•å„å°šæœªæ±‚å‡ºæœ€çŸ­è·¯å¾„çš„é¡¶ç‚¹åˆ°èµ·ç‚¹çš„è·ç¦»ï¼›</li><li>åˆçŠ¶æ€ä¸º$S$ä¸­ä»…æœ‰èµ·ç‚¹$a$ï¼Œ$D$ä¸­è®°å½•äº†ä¸$a$ç›¸é‚»çš„é¡¶ç‚¹çš„è·ç¦»ï¼ˆæƒå€¼ï¼‰ï¼Œä¸ç›¸é‚»å…ƒç´ åˆ™ä¸ºæ— ç©·å¤§ï¼›</li><li>ä»$D$ä¸­æ‰¾å‡ºè·¯å¾„æœ€çŸ­çš„é¡¶ç‚¹$k$åŠ å…¥$S$ä¸­ï¼Œæ›´æ–°$D$ä¸­$k$çš„æœ€çŸ­è·ç¦»ï¼Œä»$D$ä¸­ç§»é™¤$k$ï¼ˆä¸å†å‚ä¸åç»­è®¡ç®—ï¼‰ï¼Œé‡å¤è‡³$D$ä¸­æ— å¯ç”¨é¡¶ç‚¹ã€‚</li></ol><p>ä¸Šé¢çš„ç®—æ³•æ­¥éª¤è®²è¿°äº†Dijkstraç®—æ³•çš„æ ¸å¿ƒåŸç†ï¼Œè€ƒè™‘åœ¨ç¼–ç¨‹è¯­è¨€ä¸‹çš„å…·ä½“å®ç°ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆé€‚çš„æ•°æ®ç»“æ„æ¥æ„å»ºç®—æ³•çš„æµç¨‹ä¸ä¸Šä¸‹æ–‡ã€‚</p><ol><li>å®šä¹‰ $g[i][j]$ ä½œä¸ºå›¾$G$ï¼Œè¡¨ç¤ºèŠ‚ç‚¹ $i$ åˆ°èŠ‚ç‚¹ $j$ è¿™æ¡è¾¹çš„è¾¹æƒã€‚å¦‚æœæ²¡æœ‰ $i$ åˆ° $j$ çš„è¾¹ï¼Œåˆ™ $g[i][j]=âˆ$ã€‚</li><li>å®šä¹‰ $dis[i]$ ä½œä¸ºé›†åˆ$D$ï¼Œè¡¨ç¤ºèµ·ç‚¹ $a$ åˆ°èŠ‚ç‚¹ $i$ çš„æœ€çŸ­è·¯é•¿åº¦ï¼Œä¸€å¼€å§‹ $dis[a]=0$ï¼Œå…¶ä½™ $dis[i]=âˆ$ è¡¨ç¤ºå°šæœªè®¡ç®—å‡ºã€‚å¦å¼€è¾Ÿä¸€æ•°ç»„ $finished[i]$ ç”¨äºæ ‡è®°$D$ä¸­å·²è¢«ç§»é™¤çš„å…ƒç´ ã€‚</li><li>å¯¹äºéœ€è¦ä¸ä»…éœ€è¦æœ€çŸ­è·¯å¾„è·ç¦»ï¼Œä¸”éœ€è¦å­˜å‚¨æœ€çŸ­è·¯å¾„æœ¬èº«çš„æƒ…å†µï¼Œé€‰ç”¨åˆé€‚çš„æ•°æ®ç»“æ„å­˜æ”¾$S$ï¼Œä¾‹å¦‚åŠ¨æ€æ•°ç»„ç­‰ã€‚</li></ol><h1 id="æœ´ç´ å®ç°ï¼ˆé€‚ç”¨ç¨ å¯†å›¾ï¼‰"><a href="#æœ´ç´ å®ç°ï¼ˆé€‚ç”¨ç¨ å¯†å›¾ï¼‰" class="headerlink" title="æœ´ç´ å®ç°ï¼ˆé€‚ç”¨ç¨ å¯†å›¾ï¼‰"></a>æœ´ç´ å®ç°ï¼ˆé€‚ç”¨ç¨ å¯†å›¾ï¼‰</h1><blockquote><p>é¢˜ç›®ï¼šç°æœ‰ä¸€æœ‰å‘å¸¦æƒå›¾ï¼Œæ±‚ä»<code>k</code>èŠ‚ç‚¹å‡ºå‘åˆ°å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„å’Œï¼Œè‹¥æœ‰èŠ‚ç‚¹æ— æ³•åˆ°è¾¾åˆ™è¿”å›-1ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">dijkstra</span><span class="params">(<span class="keyword">int</span>[][] edges, <span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> INF = Integer.MAX_VALUE / <span class="number">2</span>; <span class="comment">// é˜²æ­¢åŠ æ³•æº¢å‡º</span></span><br><span class="line">    <span class="keyword">int</span>[][] g = <span class="keyword">new</span> <span class="keyword">int</span>[n][n]; <span class="comment">// é‚»æ¥çŸ©é˜µ G</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span>[] row : g) Arrays.fill(row, INF);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span>[] t : edges) &#123; </span><br><span class="line">        g[t[<span class="number">0</span>] - <span class="number">1</span>][t[<span class="number">1</span>] - <span class="number">1</span>] = t[<span class="number">2</span>]; <span class="comment">// edgesèŠ‚ç‚¹ç¼–å·ä»1å¼€å§‹ï¼Œéœ€è¦æ˜ å°„åˆ°0å¼€å§‹</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> maxDis = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span>[] dis = <span class="keyword">new</span> <span class="keyword">int</span>[n]; <span class="comment">// é›†åˆDï¼Œæœ¬é¢˜ä¸éœ€è¦å­˜å‚¨æœ€çŸ­è·¯å¾„ç»†èŠ‚ï¼Œä¸éœ€è¦S</span></span><br><span class="line">    Arrays.fill(dis, INF);</span><br><span class="line">    dis[k - <span class="number">1</span>] = <span class="number">0</span>; <span class="comment">// èµ·ç‚¹</span></span><br><span class="line">    <span class="keyword">boolean</span>[] done = <span class="keyword">new</span> <span class="keyword">boolean</span>[n]; <span class="comment">// æ ‡è®°Dä¸­è¢«ç§»é™¤çš„å…ƒç´ </span></span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123; <span class="comment">// å¯»æ‰¾æœ€å°å€¼</span></span><br><span class="line">            <span class="keyword">if</span> (!done[i] &amp;&amp; (x &lt; <span class="number">0</span> || dis[i] &lt; dis[x])) x = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="keyword">return</span> maxDis; <span class="comment">// æœ€åä¸€æ¬¡ç®—å‡ºçš„æœ€çŸ­è·¯å°±æ˜¯æœ€å¤§çš„</span></span><br><span class="line">        <span class="keyword">if</span> (dis[x] == INF) <span class="keyword">return</span> -<span class="number">1</span>; <span class="comment">// æœ‰èŠ‚ç‚¹æ— æ³•åˆ°è¾¾</span></span><br><span class="line">        maxDis = dis[x]; <span class="comment">// æ±‚å‡ºçš„æœ€çŸ­è·¯ä¼šè¶Šæ¥è¶Šå¤§</span></span><br><span class="line">        done[x] = <span class="keyword">true</span>; <span class="comment">// æœ€çŸ­è·¯é•¿åº¦å·²ç¡®å®šï¼ˆæ— æ³•å˜å¾—æ›´å°ï¼‰</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; y &lt; n; y++) &#123;</span><br><span class="line">            <span class="comment">// æ›´æ–° x çš„é‚»å±…çš„æœ€çŸ­è·¯</span></span><br><span class="line">            dis[y] = Math.min(dis[y], dis[x] + g[x][y]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦ï¼š$O(n^2)$ï¼Œç©ºé—´å¤æ‚åº¦ï¼š$O(n^2)$ã€‚</p><h1 id="å †ä¼˜åŒ–ï¼ˆé€‚ç”¨ç¨€ç–å›¾ï¼‰"><a href="#å †ä¼˜åŒ–ï¼ˆé€‚ç”¨ç¨€ç–å›¾ï¼‰" class="headerlink" title="å †ä¼˜åŒ–ï¼ˆé€‚ç”¨ç¨€ç–å›¾ï¼‰"></a>å †ä¼˜åŒ–ï¼ˆé€‚ç”¨ç¨€ç–å›¾ï¼‰</h1><p>å¯»æ‰¾æœ€å°å€¼çš„è¿‡ç¨‹å¯ä»¥ç”¨ä¸€ä¸ªæœ€å°å †æ¥å¿«é€Ÿå®Œæˆï¼š</p><ul><li>ä¸€å¼€å§‹æŠŠ $(d i s[k], k)$ äºŒå…ƒç»„å…¥å †ã€‚</li><li>å½“èŠ‚ç‚¹ $x$ é¦–æ¬¡å‡ºå †æ—¶, $d i s[x]$ å°±æ˜¯å†™æ³•ä¸€ä¸­å¯»æ‰¾çš„æœ€å°æœ€çŸ­è·¯ã€‚</li><li>æ›´æ–° $d i s[y]$ æ—¶, æŠŠ $(d i s[y], y)$ äºŒå…ƒç»„å…¥å †ã€‚</li></ul><p>æ³¨æ„ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹ $x$ åœ¨å‡ºå †å‰ï¼Œå…¶æœ€çŸ­è·¯é•¿åº¦ $d i s[x]$ è¢«å¤šæ¬¡æ›´æ–°ï¼Œé‚£ä¹ˆå †ä¸­ä¼šæœ‰å¤šä¸ªé‡å¤çš„ $x$ ï¼Œå¹¶ä¸”åŒ…å« $x$ çš„äºŒå…ƒç»„ä¸­çš„ $d i s[x]$ æ˜¯äº’ä¸ç›¸åŒçš„ï¼ˆå› ä¸ºæˆ‘ä»¬åªåœ¨æ‰¾åˆ°æ›´å°çš„æœ€çŸ­è·¯æ—¶æ‰ä¼šæŠŠäºŒå…ƒç»„å…¥å †ï¼‰ã€‚</p><p>æ‰€ä»¥åŸå®ç°ä¸­çš„ done æ•°ç»„å¯ä»¥çœå», å–è€Œä»£ä¹‹çš„æ˜¯ç”¨å‡ºå †çš„æœ€çŸ­è·¯å€¼ï¼ˆè®°ä½œ $d x$ ï¼‰ä¸å½“å‰çš„ $d i s[x]$ æ¯”è¾ƒï¼Œå¦‚æœ $d x&gt;d i s[x]$ è¯´æ˜ $x$ ä¹‹å‰å‡ºå †è¿‡ï¼Œæˆ‘ä»¬å·²ç»æ›´æ–°äº† $x$ çš„é‚»å±…çš„æœ€çŸ­è·¯ï¼Œæ‰€ä»¥è¿™æ¬¡å°±ä¸ç”¨æ›´æ–°äº†ï¼Œç»§ç»­å¤–å±‚å¾ªç¯ã€‚</p><p>å¯¹äºåŒä¸€ä¸ª $x$ ï¼Œä¾‹å¦‚å…ˆå…¥å †ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ $\operatorname{dis}[x]=10$ ï¼Œåé¢åˆæŠŠ $\operatorname{dis}[x]$ æ›´æ–°æˆ 5 ï¼Œä¹‹åè¿™ä¸ª 5 ä¼šå…ˆå‡ºå †ï¼Œç„¶åå†æŠŠ 10 å‡ºå †ã€‚ 10 å‡ºå †æ—¶å€™æ˜¯æ²¡æœ‰å¿…è¦å»æ›´æ–°å‘¨å›´é‚»å±…çš„æœ€çŸ­è·¯çš„ï¼Œå› ä¸º 5 å‡ºå †ä¹‹åï¼Œå°±å·²ç»æŠŠé‚»å±…çš„æœ€çŸ­è·¯æ›´æ–°è¿‡äº†ï¼Œç”¨ 10 æ˜¯æ— æ³•æŠŠé‚»å±…çš„æœ€çŸ­è·¯å˜å¾—æ›´çŸ­çš„ï¼Œæ‰€ä»¥ç›´æ¥ continueã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">dijkstra</span><span class="params">(<span class="keyword">int</span>[][] edges, <span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    List&lt;<span class="keyword">int</span>[]&gt;[] g = <span class="keyword">new</span> ArrayList[n]; <span class="comment">// é‚»æ¥è¡¨</span></span><br><span class="line">    Arrays.setAll(g, i -&gt; <span class="keyword">new</span> ArrayList&lt;&gt;());</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span>[] t : edges) &#123;</span><br><span class="line">        g[t[<span class="number">0</span>] - <span class="number">1</span>].add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;t[<span class="number">1</span>] - <span class="number">1</span>, t[<span class="number">2</span>]&#125;); <span class="comment">// ç»ˆç‚¹, è·ç¦»</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> maxDis = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> left = n; <span class="comment">// æœªç¡®å®šæœ€çŸ­è·¯çš„èŠ‚ç‚¹ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">int</span>[] dis = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">    Arrays.fill(dis, Integer.MAX_VALUE);</span><br><span class="line">    dis[k - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    PriorityQueue&lt;<span class="keyword">int</span>[]&gt; pq = <span class="keyword">new</span> PriorityQueue&lt;&gt;((a, b) -&gt; (a[<span class="number">0</span>] - b[<span class="number">0</span>]));</span><br><span class="line">    pq.offer(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">0</span>, k - <span class="number">1</span>&#125;);</span><br><span class="line">    <span class="keyword">while</span> (!pq.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">int</span>[] p = pq.poll();</span><br><span class="line">        <span class="keyword">int</span> dx = p[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">int</span> x = p[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (dx &gt; dis[x]) &#123; <span class="comment">// x ä¹‹å‰å‡ºå †è¿‡</span></span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        maxDis = dx; <span class="comment">// æ±‚å‡ºçš„æœ€çŸ­è·¯ä¼šè¶Šæ¥è¶Šå¤§</span></span><br><span class="line">        left--;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] e : g[x]) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = e[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">int</span> newDis = dx + e[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (newDis &lt; dis[y]) &#123;</span><br><span class="line">                dis[y] = newDis; <span class="comment">// æ›´æ–° x çš„é‚»å±…çš„æœ€çŸ­è·¯</span></span><br><span class="line">                pq.offer(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;newDis, y&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> left == <span class="number">0</span> ? maxDis : -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://leetcode.cn/problems/network-delay-time/solutions/2668220/liang-chong-dijkstra-xie-fa-fu-ti-dan-py-ooe8/">https://leetcode.cn/problems/network-delay-time/solutions/2668220/liang-chong-dijkstra-xie-fa-fu-ti-dan-py-ooe8/</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;å¯»æ‰¾å›¾ä¸­å•æºæœ€çŸ­è·¯å¾„çš„ç»å…¸ç®—æ³•ï¼Œæ­»å»çš„è€ƒç ”çŸ¥è¯†ç‚¹åœ¨æ”»å‡»æˆ‘â€¦ç†è®ºä¸å®è·µé‡æ–°å¤ä¹ ä¸€ä¸‹ã€‚&lt;br&gt;</summary>
    
    
    
    
    <category term="æ•°æ®ç»“æ„ä¸ç®—æ³•" scheme="http://silencezheng.top/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeå‘¨è®° EP16</title>
    <link href="http://silencezheng.top/2024/10/13/article147/"/>
    <id>http://silencezheng.top/2024/10/13/article147/</id>
    <published>2024-10-13T12:05:28.000Z</published>
    <updated>2024-10-27T15:28:26.026Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™å‘¨AIå–œæä¸¤é¡¹è¯ºå¥–ï¼Œå·¥ä½œå®šä¸‹æ¥åè¿˜æ˜¯è¦å¤šç ”ç©¶ä¸€ä¸‹AIåº”ç”¨ã€‚</p><p>æœ¬å‘¨ä¸»é¢˜ï¼šåŠ¨æ€è§„åˆ’ã€æ»‘åŠ¨çª—å£ã€æšä¸¾</p><p>é¢˜ç›®ï¼š</p><ul><li>241007æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/minimum-number-of-refueling-stops/description">Minimum Number of Refueling Stops</a></li><li>241009æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/find-subarray-with-bitwise-or-closest-to-k/description">Find Subarray With Bitwise OR Closest to K</a></li><li>241010æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/find-the-number-of-good-pairs-ii/description">Find the Number of Good Pairs II</a><span id="more"></span></li></ul><h1 id="Minimum-Number-of-Refueling-Stops"><a href="#Minimum-Number-of-Refueling-Stops" class="headerlink" title="Minimum Number of Refueling Stops"></a><a href="https://leetcode.cn/problems/minimum-number-of-refueling-stops/description">Minimum Number of Refueling Stops</a></h1><p>è¿™é“é¢˜ç£•ç£•ç»Šç»Šä¹Ÿæ˜¯å†™å‡ºæ¥äº†ï¼Œåªæ˜¯ä¼˜åŒ–çš„æœ‰äº›æ…¢ï¼Œè¿˜æ˜¯è®°å½•ä¸€ä¸‹ã€‚</p><p>ä¸‹é¢æ˜¯æˆ‘è§£é¢˜è¿‡ç¨‹ä¸­å†™çš„æ³¨é‡Šï¼ŒåŒ…å«äº†çŠ¶æ€å®šä¹‰ä¸çŠ¶æ€è½¬ç§»ï¼š</p><blockquote><p>A pick or no-pick problem, can be solved by DP, stations is sorted<br>Define dp[i][j] = remain fuel at i when pick j stations<br>Final problem = dp[target][x] where x &gt;= 0 and no more y&gt;=0&amp;&amp;y&lt;x<br>dp[i][j] = max(dp[i-1][j]-1, dp[i-1][j-1] + stations[i][1] - 1), where stations[i][0]=i</p></blockquote><h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><p>ä»<code>dp[i-1][j-1]</code>è½¬ç§»ï¼Œå­˜åœ¨â€œä»£å¿â€æƒ…å†µï¼Œå³<code>dp[i-1][j-1]</code>æ˜¯ä¸€æ¡ä¸é€šçš„è·¯ï¼Œä½†ç”±äºåæœŸé‡åˆ°å¤§stationå¯¼è‡´è¯¥è·¯é€šè¡Œã€‚ä¸ºè§£å†³ä»£å¿ï¼Œåº”ä»…ä»åˆæ³•çŠ¶æ€è½¬ç§»è‡³æ–°çŠ¶æ€ï¼Œå®ç°æ–¹å¼æ˜¯é‡åˆ°ä¸åˆæ³•çŠ¶æ€ç›´æ¥ç½®ä¸ºæå°å€¼åå†å‚ä¸æ¯”è¾ƒã€‚<br>å®šä¹‰å¥½çŠ¶æ€åï¼Œå‘ç°ç›´æ¥å®ç°ä»ä¼šè¶…æ—¶ï¼Œé‡‡å–ä¸¤æ­¥ä¼˜åŒ–ï¼š</p><ol><li>é€šè¿‡è½¬ç§»æ–¹ç¨‹å¯ä»¥äº†è§£åˆ°å½“å‰çŠ¶æ€ä»…ä¸ä¸Šä¸€çŠ¶æ€æœ‰å…³ï¼Œå¯é‡‡ç”¨æ»šåŠ¨æ•°ç»„å‹ç¼©ä¸ºä¸¤è¡Œï¼Œä¼˜åŒ–ç©ºé—´ã€‚</li><li>åŸºäº<code>stations is sorted</code>å’Œ<code>stations[n-1]&lt;target</code>å¯é‡‡ç”¨ä¼˜åŒ–éå†ï¼Œè½¬è€Œéå†<code>stations</code>ï¼Œä¼˜åŒ–æ—¶é—´ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minRefuelStops</span><span class="params">(<span class="keyword">int</span> target, <span class="keyword">int</span> startFuel, <span class="keyword">int</span>[][] stations)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(startFuel&gt;=target) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// è¾¹ç•Œå¤„ç†1</span></span><br><span class="line">        <span class="keyword">int</span> n = stations.length;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">return</span> -<span class="number">1</span>; <span class="comment">// è¾¹ç•Œå¤„ç†2</span></span><br><span class="line">        <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>][n+<span class="number">1</span>]; <span class="comment">// æ»šåŠ¨æ•°ç»„</span></span><br><span class="line">        Arrays.fill(dp[<span class="number">0</span>], startFuel);</span><br><span class="line">        <span class="keyword">int</span> last = <span class="number">0</span>, cur = <span class="number">1</span>, cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123; <span class="comment">// ä¼˜åŒ–éå†</span></span><br><span class="line">            <span class="keyword">int</span> dist = stations[i][-<span class="number">1</span>] </span><br><span class="line">            dp[cur][-<span class="number">1</span>] </span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)&#123;</span><br><span class="line">                dp[cur][j] = Math.max(dp[last][j]&gt;=dist?dp[last][j] - dist:Integer.MIN_VALUE, </span><br><span class="line">                dp[last][j-<span class="number">1</span>]&gt;=dist?dp[last][j-<span class="number">1</span>] + stations[i][<span class="number">0</span>] </span><br><span class="line">            &#125;</span><br><span class="line">            cnt = stations[i][<span class="number">0</span>]; <span class="comment">// ç§»åŠ¨å·²èµ°è¿‡çš„è·ç¦»</span></span><br><span class="line">            <span class="keyword">int</span> t = last;</span><br><span class="line">            last = cur;</span><br><span class="line">            cur = t;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=n;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(dp[last][j]&gt;=target-stations[n-<span class="number">1</span>][<span class="number">0</span>])&#123; <span class="comment">// æ³¨æ„æ­¤æ—¶lastæ‰æ˜¯cur</span></span><br><span class="line">                res = j;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Find-Subarray-With-Bitwise-OR-Closest-to-K"><a href="#Find-Subarray-With-Bitwise-OR-Closest-to-K" class="headerlink" title="Find Subarray With Bitwise OR Closest to K"></a><a href="https://leetcode.cn/problems/find-subarray-with-bitwise-or-closest-to-k/description">Find Subarray With Bitwise OR Closest to K</a></h1><p>è¿ç»­å­æ•°ç»„å˜å½¢é¢˜ï¼Œä¸Šæ¥å°±åº”è¯¥æƒ³åˆ°æ»‘çª—çš„â€¦ä½†æ˜¯æˆ‘è¿˜æ˜¯é€‰æ‹©äº†æšä¸¾ï¼Œå°è¯•äº†ä¸€ä¸‹å¡åˆ°$O(n^2)$ä¼˜åŒ–ä¸å‡ºæ¥äº†ï¼Œå°è¯•äº†ç”¨æ¯ä¸€ä½è®¡æ•°çš„æ–¹å¼ä¹Ÿæ²¡ä»€ä¹ˆç”¨ï¼Œä¸‹é¢è´´çµç¥æ€è·¯ï¼Œæ›´ä¼˜äº›ã€‚</p><p>åŸºç¡€æšä¸¾ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æš´åŠ›ç®—æ³•ï¼Œä¼šè¶…æ—¶</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minimumDifference</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans = Integer.MAX_VALUE;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = nums[i];</span><br><span class="line">            ans = Math.min(ans, Math.abs(x - k)); <span class="comment">// å•ä¸ªå…ƒç´ ä¹Ÿç®—å­æ•°ç»„</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">                nums[j] |= x; <span class="comment">// ç°åœ¨ nums[j] = åŸæ•°ç»„ nums[j] åˆ° nums[i] çš„ OR</span></span><br><span class="line">                ans = Math.min(ans, Math.abs(nums[j] - k));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¼˜åŒ–æ€è·¯ï¼šæŠŠäºŒè¿›åˆ¶æ•°çœ‹æˆé›†åˆï¼Œä¸¤ä¸ªæ•°çš„ <code>OR</code> å°±æ˜¯ä¸¤ä¸ªé›†åˆçš„å¹¶é›†ã€‚</p><p>åœ¨ä¸Šè¿°æšä¸¾è¿‡ç¨‹ä¸­ï¼Œ<code>nums</code>ä¸­æœ€å·¦ä¾§æ˜¯æœ€å¤§çš„é›†åˆï¼Œä»å·¦å‘å³ä¾æ¬¡æ˜¯å‰åºå…ƒç´ çš„å­é›†ï¼Œåˆ™å½“ä»å³å‘å·¦å¹¶å…¥å…ƒç´ <code>x</code>çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‘ç°<code>x</code>å·²ç»æ˜¯æŸå…ƒç´ çš„å­é›†ï¼Œåˆ™ä¸éœ€è¦å†å‘å·¦ä¼ æ’­äº†ï¼Œå› ä¸ºæ­¤æ—¶<code>x</code>å·²ç»æ˜¯å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„å­é›†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minimumDifference</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans = Integer.MAX_VALUE;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = nums[i];</span><br><span class="line">            ans = Math.min(ans, Math.abs(x - k));</span><br><span class="line">            <span class="comment">// å¦‚æœ x æ˜¯ nums[j] çš„å­é›†ï¼Œå°±é€€å‡ºå¾ªç¯</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span> &amp;&amp; (nums[j] | x) != nums[j]; j--) &#123;</span><br><span class="line">                nums[j] |= x;</span><br><span class="line">                ans = Math.min(ans, Math.abs(nums[j] - k));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ»‘åŠ¨çª—å£"><a href="#æ»‘åŠ¨çª—å£" class="headerlink" title="æ»‘åŠ¨çª—å£"></a>æ»‘åŠ¨çª—å£</h2><p>å‚è€ƒå¼•æ–‡[2]çš„è§£æ³•ï¼Œå†çœ‹ä¸€ä¸‹æ»‘åŠ¨çª—å£ï¼Œç”±äºè¿ç»­å­æ•°ç»„çš„â€œORå’Œâ€æœ‰å•è°ƒæ€§ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ã€‚æ»‘åŠ¨çª—å£å³ç§»ï¼Œçª—å£å†…çš„å…ƒç´ â€œORå’Œâ€åªèƒ½å˜å¤§æˆ–è€…ä¸å˜ï¼›æ»‘åŠ¨çª—å£å·¦ç§»ï¼Œçª—å£å†…çš„å…ƒç´ â€œORå’Œâ€åªèƒ½å˜å°æˆ–è€…ä¸å˜ã€‚</p><p>æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªè¿ç»­çš„å­æ•°ç»„ï¼Œä½¿å¾—å®ƒä»¬çš„â€œORå’Œâ€çš„ç»“æœå°½å¯èƒ½æ¥è¿‘ kã€‚é€šè¿‡æ»‘åŠ¨çª—å£çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä¸æ–­æ‰©å¤§å’Œç¼©å°çª—å£æ¥å°è¯•æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å­æ•°ç»„ã€‚</p><p>ç”±äºæŒ‰ä½æˆ–è¿ç®—å…·æœ‰ä¸å¯é€†çš„ç‰¹ç‚¹ï¼ˆå³ä¸åƒåŠ æ³•æœ‰é€†è¿ç®—å‡æ³•ï¼‰ï¼Œä¸€æ—¦æŸä¸ªä½è¢«ç½®ä¸º 1ï¼Œå³ä½¿ç§»é™¤æŸäº›æ•°å­—ï¼ŒOR çš„ç»“æœä¸­è¯¥ä½ä»ç„¶å¯èƒ½ä¿æŒä¸º 1ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä»”ç»†è¿½è¸ªæ¯ä¸ªä½çš„<strong>æœ€åè´¡çŒ®ä½ç½®</strong>ã€‚</p><p>å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¤§å°ä¸º 32 çš„æ•°ç»„ maxBitPosï¼Œè®°å½•æ¯ä¸ªä½ä¸Šæœ€åä¸€æ¬¡è´¡çŒ® 1 çš„ç´¢å¼•ã€‚å½“å·¦è¾¹ç•Œç§»åŠ¨æ—¶ï¼Œæˆ‘ä»¬æ£€æŸ¥æ˜¯å¦éœ€è¦ç§»é™¤æŸä¸ªä½çš„è´¡çŒ®ï¼Œå¦‚æœè¯¥ä½çš„æœ€åè´¡çŒ®ä½ç½®æ˜¯å½“å‰çš„ leftï¼Œå°±å¯ä»¥å®‰å…¨åœ°å°†è¯¥ä½æ¸…é™¤ã€‚ï¼ˆè¿™é‡Œå¤ªå¦™äº†ï¼Œæˆ‘ä¹Ÿæƒ³åˆ°äº†ç”¨32ä½æ•°ç»„è®¡æ•°ä½†æ˜¯æ²¡æƒ³åˆ°å’Œç´¢å¼•å»ºç«‹è¿æ¥ï¼ï¼‰</p><p>æœ€åï¼Œåœ¨æ»‘åŠ¨çª—å£è¿‡ç¨‹ä¸­ï¼Œè®¡ç®—å½“å‰çª—å£çš„â€œORå’Œâ€currï¼Œå¹¶é€šè¿‡æ¯”è¾ƒ<code>abs(curr - k)</code>æ¥æ›´æ–°æœ€å°çš„ç»å¯¹å·®ã€‚å¦‚æœå½“å‰curræ­£å¥½ç­‰äº kï¼Œç›´æ¥è¿”å› 0ï¼Œå› ä¸ºç»å¯¹å·®å·²ç»æœ€å°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minimumDifference</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.length, left = <span class="number">0</span>, right = <span class="number">0</span>, ans = Integer.MAX_VALUE, curr = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span>[] maxBitPos = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">32</span>]; <span class="comment">// è®°å½•æ¯ä¸ªä½çš„æœ€å¤§ä½ç½®</span></span><br><span class="line">        Arrays.fill(maxBitPos, -<span class="number">1</span>); <span class="comment">// åˆå§‹åŒ–æ•°ç»„</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (right &lt; n) &#123;</span><br><span class="line">            curr |= nums[right]; <span class="comment">// å½“å‰çª—å£å†…çš„ OR å€¼</span></span><br><span class="line">            <span class="comment">// æ›´æ–° maxBitPosï¼Œè®°å½•æ¯ä¸ªä½çš„æœ€åå‡ºç°ä½ç½®</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (((nums[right] &gt;&gt; i) &amp; <span class="number">1</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">                    maxBitPos[i] = right;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = Math.min(ans, Math.abs(curr - k));</span><br><span class="line">            <span class="keyword">if</span> (curr == k) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// å¦‚æœå½“å‰çª—å£æ­£å¥½åŒ¹é… kï¼Œç›´æ¥è¿”å›</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¦‚æœå½“å‰ OR å€¼å¤§äº kï¼Œå¼€å§‹æ”¶ç¼©çª—å£</span></span><br><span class="line">            <span class="keyword">while</span> (left &lt; right &amp;&amp; curr &gt; k) &#123;</span><br><span class="line">                <span class="comment">// æ£€æŸ¥å½“å‰ left æ˜¯å¦åœ¨æŸä¸ªä½ä¸Šåšå‡ºäº†è´¡çŒ®</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (((nums[left] &gt;&gt; i) &amp; <span class="number">1</span>) == <span class="number">1</span> &amp;&amp; maxBitPos[i] == left) &#123;</span><br><span class="line">                        curr &amp;= ~(<span class="number">1</span> &lt;&lt; i); <span class="comment">// æ¸…é™¤è¯¥ä½çš„è´¡çŒ®</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                ans = Math.min(ans, Math.abs(curr - k));</span><br><span class="line">                <span class="keyword">if</span> (curr == k) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// åŒ¹é…åˆ° kï¼Œè¿”å›</span></span><br><span class="line">                &#125;</span><br><span class="line">                left++; <span class="comment">// ç¼©å°çª—å£</span></span><br><span class="line">            &#125;</span><br><span class="line">            right++; <span class="comment">// æ‰©å±•çª—å£</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Find-the-Number-of-Good-Pairs-II"><a href="#Find-the-Number-of-Good-Pairs-II" class="headerlink" title="Find the Number of Good Pairs II"></a><a href="https://leetcode.cn/problems/find-the-number-of-good-pairs-ii/description">Find the Number of Good Pairs II</a></h1><p>ä¼˜åŒ–æšä¸¾ï¼Œæš´åŠ›æšä¸¾å¯¹äºæ¯ä¸ª<code>nums1[i]</code>éƒ½éœ€è¦éå†<code>nums2</code>é•¿åº¦ï¼Œä¼˜åŒ–æ€è·¯æ˜¯å…ˆç»„ç»‡ä¸¤ä¸ªMapæŠŠæŸ¥æ‰¾æ•ˆç‡é™ä½ï¼Œå†éå†<code>nums2</code>ï¼Œå¯¹äºæ¯ä¸ª<code>nums2[j]</code>ï¼Œéå†å®ƒçš„<code>n*k</code>å€ï¼Œå…¶ä¸­<code>n</code>ä¸ºæ­£æ•´æ•°ï¼Œä¸Šç•Œä¸º<code>nums1</code>ä¸­çš„æœ€å¤§å€¼ã€‚æ­¤æ—¶åº•å±‚éå†çš„æ—¶é—´å¤æ‚åº¦ç”±$O(nums2.length)$å˜ä¸ºäº†$O(\max(nums1)/k \times \log nums2.length)$ï¼Œå…¶ä¸­$\log nums2.length$æ˜¯è°ƒå’Œçº§æ•°æ±‚å’Œçš„ç»“æœï¼Œå› æ­¤åœ¨$nums2.length$å¤§çš„æƒ…å†µä¸‹è¿™ç§ä¼˜åŒ–å¯ä»¥æ˜¾è‘—é™ä½åº•å±‚éå†çš„è€—æ—¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">numberOfPairs</span><span class="params">(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        Map&lt;Integer, Integer&gt; count = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        Map&lt;Integer, Integer&gt; count2 = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">int</span> max1 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> num : nums1) &#123;</span><br><span class="line">            count.put(num, count.getOrDefault(num, <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">            max1 = Math.max(max1, num);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> num : nums2) &#123;</span><br><span class="line">            count2.put(num, count2.getOrDefault(num, <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> a : count2.keySet()) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> b = a * k; b &lt;= max1; b += a * k) &#123;</span><br><span class="line">                <span class="keyword">if</span> (count.containsKey(b)) &#123;</span><br><span class="line">                    res += <span class="number">1L</span> * count.get(b) * count2.get(a); <span class="comment">// é¿å…ä¹˜ç§¯æº¢å‡º</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://leetcode.cn/problems/find-subarray-with-bitwise-or-closest-to-k/solutions/2798206/li-yong-and-de-xing-zhi-pythonjavacgo-by-gg4d/?envType=daily-question&amp;envId=2024-10-09">https://leetcode.cn/problems/find-subarray-with-bitwise-or-closest-to-k/solutions/2798206/li-yong-and-de-xing-zhi-pythonjavacgo-by-gg4d/?envType=daily-question&amp;envId=2024-10-09</a><br>[2] <a href="https://leetcode.cn/problems/find-subarray-with-bitwise-or-closest-to-k/solutions/2943534/hua-dong-chuang-kou-by-hypnotised-e-3jcd/?envType=daily-question&amp;envId=2024-10-09">https://leetcode.cn/problems/find-subarray-with-bitwise-or-closest-to-k/solutions/2943534/hua-dong-chuang-kou-by-hypnotised-e-3jcd/?envType=daily-question&amp;envId=2024-10-09</a><br>[3] <a href="https://leetcode.cn/problems/find-the-number-of-good-pairs-ii/solutions/2928182/you-zhi-shu-dui-de-zong-shu-ii-by-leetco-obro/?envType=daily-question&amp;envId=2024-10-11">https://leetcode.cn/problems/find-the-number-of-good-pairs-ii/solutions/2928182/you-zhi-shu-dui-de-zong-shu-ii-by-leetco-obro/?envType=daily-question&amp;envId=2024-10-11</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è¿™å‘¨AIå–œæä¸¤é¡¹è¯ºå¥–ï¼Œå·¥ä½œå®šä¸‹æ¥åè¿˜æ˜¯è¦å¤šç ”ç©¶ä¸€ä¸‹AIåº”ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨ä¸»é¢˜ï¼šåŠ¨æ€è§„åˆ’ã€æ»‘åŠ¨çª—å£ã€æšä¸¾&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;241007æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/minimum-number-of-refueling-stops/description&quot;&gt;Minimum Number of Refueling Stops&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;241009æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/find-subarray-with-bitwise-or-closest-to-k/description&quot;&gt;Find Subarray With Bitwise OR Closest to K&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;241010æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/find-the-number-of-good-pairs-ii/description&quot;&gt;Find the Number of Good Pairs II&lt;/a&gt;</summary>
    
    
    
    
    <category term="LeetCode" scheme="http://silencezheng.top/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeå‘¨è®° EP5</title>
    <link href="http://silencezheng.top/2024/10/12/article146/"/>
    <id>http://silencezheng.top/2024/10/12/article146/</id>
    <published>2024-10-12T11:01:13.000Z</published>
    <updated>2024-10-27T15:28:29.772Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‘¨èµ›ä¾ç„¶æ²¡æ‰“ï½</p><p>æœ¬å‘¨ä¸»é¢˜ï¼šå›¾è·¯å¾„æšä¸¾ã€æ·±åº¦ä¼˜å…ˆæœç´¢ã€è´ªå¿ƒã€çŸ©é˜µæšä¸¾</p><p>é¢˜ç›®ï¼š</p><ul><li>240702æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/maximum-path-quality-of-a-graph/description">Maximum Path Quality of a Graph</a></li><li>240704æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/minimum-moves-to-pick-k-ones/description/">Minimum Moves to Pick K Ones</a></li><li>240707æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/check-if-move-is-legal/description">Check if Move is Legal</a><span id="more"></span><h1 id="å›¾è·¯å¾„æšä¸¾ï¼ˆDFSï¼‰"><a href="#å›¾è·¯å¾„æšä¸¾ï¼ˆDFSï¼‰" class="headerlink" title="å›¾è·¯å¾„æšä¸¾ï¼ˆDFSï¼‰"></a>å›¾è·¯å¾„æšä¸¾ï¼ˆDFSï¼‰</h1><blockquote><p>Maximum Path Quality of a Graph</p><p>There is an undirected graph with n nodes numbered from 0 to n - 1 (inclusive). You are given a 0-indexed integer array values where values[i] is the value of the ith node. You are also given a 0-indexed 2D integer array edges, where each edges[j] = [uj, vj, timej] indicates that there is an undirected edge between the nodes uj and vj, and it takes timej seconds to travel between the two nodes. Finally, you are given an integer maxTime.</p><p>A valid path in the graph is any path that starts at node 0, ends at node 0, and takes at most maxTime seconds to complete. You may visit the same node multiple times. The quality of a valid path is the sum of the values of the unique nodes visited in the path (each nodeâ€™s value is added at most once to the sum).</p><p>Return the maximum quality of a valid path.</p><p>Note: There are at most four edges connected to each node.</p></blockquote></li></ul><p>è¿™é¢˜ç›´æ¥ä½œä¸ºå­¦ä¹ æšä¸¾å›¾è·¯å¾„çš„ç´ æäº†ï¼Œå¯¹äºæ•°æ®èŒƒå›´å°çš„å›¾è·¯å¾„é¢˜å¯ä»¥è€ƒè™‘ï¼Œç”±äºåŸé¢˜é€šè¿‡æ—¶é—´èŒƒå›´é™åˆ¶äº†è·¯å¾„æœ€å¤§é•¿åº¦ä¸º<code>10</code>ä¸”æ¯ä¸ªèŠ‚ç‚¹çš„åº¦æ•°ä¸è¶…è¿‡<code>4</code>ï¼Œåˆ™æšä¸¾çš„èŒƒå›´è¾ƒå°ã€‚</p><p>å¯ä»¥ä½¿ç”¨<strong>é€’å½’ + å›æº¯</strong>çš„æ–¹æ³•è¿›è¡Œæšä¸¾ã€‚é€’å½’å‡½æ•°è®°å½•å½“å‰æ‰€åœ¨çš„èŠ‚ç‚¹ç¼–å·ï¼Œå·²ç»è¿‡çš„è·¯å¾„çš„æ€»æ—¶é—´ä»¥åŠèŠ‚ç‚¹çš„ä»·å€¼ä¹‹å’Œã€‚å¦‚æœå½“å‰åœ¨èŠ‚ç‚¹ uï¼Œæˆ‘ä»¬å¯ä»¥æšä¸¾ä¸ u ç›´æ¥ç›¸è¿çš„èŠ‚ç‚¹ v è¿›è¡Œé€’å½’æœç´¢ã€‚åœ¨æœç´¢çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæˆ‘ä»¬å›åˆ°äº†èŠ‚ç‚¹ 0ï¼Œå°±å¯ä»¥å¯¹ç­”æ¡ˆè¿›è¡Œæ›´æ–°ï¼›å¦‚æœæ€»æ—¶é—´è¶…è¿‡äº† maxTimeï¼Œæˆ‘ä»¬éœ€è¦åœæ­¢æœç´¢ï¼Œè¿›è¡Œå›æº¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span>[] values;</span><br><span class="line">    <span class="keyword">int</span> maxTime;</span><br><span class="line">    List&lt;<span class="keyword">int</span>[]&gt;[] g; <span class="comment">// ç¬¬äºŒç»´å¯å˜é•¿çš„äºŒç»´æ•°ç»„</span></span><br><span class="line">    <span class="keyword">boolean</span>[] visited; <span class="comment">// ç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦è®¡ç®—ä»·å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maximalPathQuality</span><span class="params">(<span class="keyword">int</span>[] values, <span class="keyword">int</span>[][] edges, <span class="keyword">int</span> maxTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.values = values;</span><br><span class="line">        <span class="keyword">this</span>.maxTime = maxTime;</span><br><span class="line">        <span class="keyword">int</span> n = values.length;</span><br><span class="line">        g = <span class="keyword">new</span> List[n]; <span class="comment">// ç”¨äºå­˜å‚¨æ¯ä¸ªèŠ‚ç‚¹çš„é‚»æ¥èŠ‚ç‚¹ä¸ä»£ä»·</span></span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            g[i] = <span class="keyword">new</span> ArrayList&lt;<span class="keyword">int</span>[]&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] edge : edges) &#123;</span><br><span class="line">            g[edge[<span class="number">0</span>]].add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;edge[<span class="number">1</span>], edge[<span class="number">2</span>]&#125;);</span><br><span class="line">            g[edge[<span class="number">1</span>]].add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;edge[<span class="number">0</span>], edge[<span class="number">2</span>]&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        visited = <span class="keyword">new</span> <span class="keyword">boolean</span>[n];</span><br><span class="line">        visited[<span class="number">0</span>] = <span class="keyword">true</span>;</span><br><span class="line">        </span><br><span class="line">        dfs(<span class="number">0</span>, <span class="number">0</span>, values[<span class="number">0</span>]); <span class="comment">// åˆå§‹èŠ‚ç‚¹ï¼Œå·²ç»è¿‡æ—¶é—´ï¼Œå½“å‰ä»·å€¼å’Œ</span></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> time, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == <span class="number">0</span>) &#123;</span><br><span class="line">            ans = Math.max(ans, value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] arr : g[u]) &#123;</span><br><span class="line">            <span class="keyword">int</span> v = arr[<span class="number">0</span>], dist = arr[<span class="number">1</span>];</span><br><span class="line">            <span class="comment">// å¦‚æœæ—¶é—´å…è®¸åˆ™è¿›è¡Œä¸‹ä¸€æ­¥</span></span><br><span class="line">            <span class="keyword">if</span> (time + dist &lt;= maxTime) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!visited[v]) &#123;</span><br><span class="line">                    <span class="comment">// å¯¹äºåˆæ¬¡ç»è¿‡çš„èŠ‚ç‚¹ï¼Œå°è¯•æ‰€æœ‰å¯èƒ½è·¯å¾„åå›æº¯</span></span><br><span class="line">                    visited[v] = <span class="keyword">true</span>;</span><br><span class="line">                    dfs(v, time + dist, value + values[v]);</span><br><span class="line">                    visited[v] = <span class="keyword">false</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// å·²ç»èµ°è¿‡å°±æ— æ‰€è°“äº†åæ­£ä¹Ÿä¸è®¡ç®—value</span></span><br><span class="line">                    dfs(v, time + dist, value);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ—¶é—´ä¸å…è®¸åˆ™ç»“æŸ</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="çŸ©é˜µæšä¸¾"><a href="#çŸ©é˜µæšä¸¾" class="headerlink" title="çŸ©é˜µæšä¸¾"></a>çŸ©é˜µæšä¸¾</h1><blockquote><p>Check if Move is Legal</p><p>You are given a 0-indexed 8 x 8 grid board, where board[r][c] represents the cell (r, c) on a game board. On the board, free cells are represented by â€˜.â€™, white cells are represented by â€˜Wâ€™, and black cells are represented by â€˜Bâ€™.</p><p>Each move in this game consists of choosing a free cell and changing it to the color you are playing as (either white or black). However, a move is only legal if, after changing it, the cell becomes the endpoint of a good line (horizontal, vertical, or diagonal).</p><p>A good line is a line of three or more cells (including the endpoints) where the endpoints of the line are one color, and the remaining cells in the middle are the opposite color (no cells in the line are free).</p><p>Given two integers rMove and cMove and a character color representing the color you are playing as (white or black), return true if changing cell (rMove, cMove) to color color is a legal move, or false if it is not legal.</p></blockquote><p>ç”±é¢˜æ„å¯çŸ¥ï¼Œå½“å‰æ“ä½œåˆæ³•å½“ä¸”ä»…å½“ä»è¯¥ç‚¹å¼€å§‹çš„ 8 ä¸ªæ–¹å‘ï¼ˆä¸Šä¸‹å·¦å³ä¸å¯¹è§’çº¿ï¼‰ä¸­ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªæ–¹å‘å­˜åœ¨ä¸€ä¸ªä»¥è¯¥ç‚¹ä¸ºèµ·ç‚¹çš„å¥½çº¿æ®µã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥æšä¸¾è¿™ 8 ä¸ªæ–¹å‘ï¼Œå¹¶å¯¹äºæ¯ä¸ªæ–¹å‘éªŒè¯æ˜¯å¦å­˜åœ¨ä»¥è¯¥ç‚¹ä¸ºèµ·ç‚¹çš„å¥½çº¿æ®µã€‚å¦‚æœè¯¥ç‚¹ä¸å¯¹åº”æ–¹å‘ä¸‹ä¸€ä¸ªç›¸åŒé¢œè‰²çš„æ ¼ç‚¹ä¹‹é—´çš„æ‰€æœ‰æ ¼ç‚¹ï¼ˆè‡³å°‘ä¸€ä¸ªï¼‰å‡ä¸ºå¦ä¸€ç§é¢œè‰²ï¼Œé‚£ä¹ˆå®ƒä»¬æ„æˆä¸€ä¸ªå¥½çº¿æ®µã€‚</p><p>æˆ‘ä»¬ç”¨æ•°å¯¹ (dx,dy) æ¥è¡¨ç¤ºæ¯ä¸ªæ–¹å‘ä¸‹ä¸€ä¸ªæ ¼ç‚¹ç›¸å¯¹äºå½“å‰æ ¼ç‚¹çš„è¡Œåˆ—ä¸‹æ ‡å˜åŒ–é‡ï¼Œå¹¶ç”¨å‡½æ•° check(dx,dy) æ¥åˆ¤æ–­è¯¥æ–¹å‘æ˜¯å¦å­˜åœ¨ä»¥æ“ä½œä½ç½®ä¸ºèµ·ç‚¹çš„å¥½çº¿æ®µã€‚å¦‚æœæˆ‘ä»¬å¯»æ‰¾åˆ°äº†ç¬¦åˆè¦æ±‚çš„å¥½çº¿æ®µï¼Œåˆ™è¿”å› trueï¼›åä¹‹äº¦ç„¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkMove</span><span class="params">(<span class="keyword">char</span>[][] board, <span class="keyword">int</span> rMove, <span class="keyword">int</span> cMove, <span class="keyword">char</span> color)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä» x è½´æ­£æ–¹å‘å¼€å§‹é€†æ—¶é’ˆæšä¸¾ 8 ä¸ªæ–¹å‘</span></span><br><span class="line">        <span class="keyword">int</span>[] dx = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;   <span class="comment">// è¡Œæ”¹å˜é‡</span></span><br><span class="line">        <span class="keyword">int</span>[] dy = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>&#125;;   <span class="comment">// åˆ—æ”¹å˜é‡</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">8</span>; ++k) &#123;</span><br><span class="line">            <span class="keyword">if</span> (check(board, rMove, cMove, color, dx[k], dy[k])) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ¯ä¸ªæ–¹å‘æ˜¯å¦å­˜åœ¨ä»¥æ“ä½œä½ç½®ä¸ºèµ·ç‚¹çš„å¥½çº¿æ®µ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(<span class="keyword">char</span>[][] board, <span class="keyword">int</span> rMove, <span class="keyword">int</span> cMove, <span class="keyword">char</span> color, <span class="keyword">int</span> dx, <span class="keyword">int</span> dy)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = rMove + dx;</span><br><span class="line">        <span class="keyword">int</span> y = cMove + dy;</span><br><span class="line">        <span class="keyword">int</span> step = <span class="number">1</span>;   <span class="comment">// å½“å‰éå†åˆ°çš„èŠ‚ç‚¹åºå·</span></span><br><span class="line">        <span class="keyword">while</span> (x &gt;= <span class="number">0</span> &amp;&amp; x &lt; <span class="number">8</span> &amp;&amp; y &gt;= <span class="number">0</span> &amp;&amp; y &lt; <span class="number">8</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (step == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// ç¬¬ä¸€ä¸ªç‚¹å¿…é¡»ä¸ºç›¸åé¢œè‰²</span></span><br><span class="line">                <span class="keyword">if</span> (board[x][y] == <span class="string">&#x27;.&#x27;</span> || board[x][y] == color) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// å¥½çº¿æ®µä¸­ä¸åº”å­˜åœ¨ç©ºæ ¼å­</span></span><br><span class="line">                <span class="keyword">if</span> (board[x][y] == <span class="string">&#x27;.&#x27;</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// éå†åˆ°å¥½çº¿æ®µçš„ç»ˆç‚¹ï¼Œè¿”å› true</span></span><br><span class="line">                <span class="keyword">if</span> (board[x][y] == color) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ++step;</span><br><span class="line">            x += dx;</span><br><span class="line">            y += dy;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä¸å­˜åœ¨ç¬¦åˆè¦æ±‚çš„å¥½çº¿æ®µ</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="è´ªå¿ƒ"><a href="#è´ªå¿ƒ" class="headerlink" title="è´ªå¿ƒ"></a>è´ªå¿ƒ</h1><p>é¢˜ç›®ï¼š<a href="https://leetcode.cn/problems/minimum-moves-to-pick-k-ones/description/">Minimum Moves to Pick K Ones</a></p><p>è¿™é¢˜é¦–å…ˆè¦å…ˆè¯»æ˜ç™½é¢˜â€¦é¦–å…ˆæœ‰ä¸€ä¸ªâ€œ01ä¸²â€ï¼Œç›®æ ‡æ˜¯ç”¨æœ€å°‘çš„<code>moves</code>æ¡èµ·<code>k</code>ä¸ª$1$ï¼Œèµ·å§‹çŠ¶æ€æ˜¯ä»ä¸²ä¸­çš„æŸä¸ª$1$å¼€å§‹çš„ï¼Œæˆ‘ä»¬å«è¿™ä¸ª$1$çš„ä¸‹æ ‡ä¸º<code>aliceIndex</code>ï¼Œæˆ‘ä»¬å–èµ°è¿™ä¸ª$1$ä½¿è¯¥ä½ç½®å˜æˆ$0$ï¼Œæ­¤æ—¶è¿˜å·®<code>k-1</code>ä¸ª$1$éœ€è¦æ¡ã€‚æ€ä¹ˆæ¡å…¶ä»–çš„$1$å‘¢ï¼Ÿæˆ‘ä»¬é€šè¿‡å¦‚ä¸‹ä¸¤ç§æ“ä½œï¼š</p><ol><li>éšä¾¿é€‰ä¸€ä¸ª$0$å˜æˆ$1$ï¼Œä¿—ç§°ç‚¹çŸ³æˆé‡‘ï¼Œæœ‰æœ€å¤§æ“ä½œæ•°é™åˆ¶<code>maxChanges</code>ï¼›</li><li>é€‰ä¸¤ä¸ªé‚»æ¥çš„$1$å’Œ$0$ï¼Œä¸‹æ ‡åˆ†åˆ«ä¸º$x$å’Œ$y$ï¼Œäº¤æ¢å€¼ï¼Œå¦‚æœ$y==aliceIndex$åˆ™æ¡èµ·è¿™ä¸ª$1$ã€‚</li></ol><p>å› æ­¤ï¼Œå¯¹äº<code>aliceIndex</code>å·¦å³ä¸¤ä¾§æœ‰$1$çš„æƒ…å†µï¼Œæˆ‘ä»¬åªéœ€è¦$1$ä¸ªåŠ¨ä½œå°±å¯ä»¥æ¡èµ·ï¼Œå½“ä¸¤ä¾§éƒ½ä¸º$0$æ—¶ï¼Œé€šè¿‡ç‚¹çŸ³æˆé‡‘å’Œäº¤æ¢çš„ç»„åˆåŠ¨ä½œæ¥æ¡$1$ï¼Œè¿™é‡Œçš„åˆ†æƒ…å†µæ€æƒ³æ¯”è¾ƒé‡è¦ï¼Œæˆ‘ç¬¬ä¸€æ¬¡åšæ—¶å°±é”™åœ¨äº†ä»åŠ¨ä½œè§’åº¦è€ƒè™‘ï¼Œå®é™…ä¸Šåˆ†æƒ…å†µæ—¶åº”è¯¥æ³¨æ„â€œæ™®é€‚æ€§â€ä¸â€œé è¿‘ç»ˆæ€â€ï¼ˆè¿™æ˜¯æˆ‘çæ€»ç»“çš„ï¼‰ï¼Œå› æ­¤åº”è¯¥ä»æ‰€æœ‰çš„$1$æ‰€å¤„çš„ä½ç½®è€ƒè™‘ã€‚æƒ…å†µå¦‚ä¸‹ï¼š</p><ul><li>æƒ…å†µä¸€ï¼šå…ˆå°† aliceIndex é‚»è¿‘çš„æ•°å­—è®¾ç½®ä¸º 1 ï¼Œç„¶åäº¤æ¢æ•°å­—ï¼Œåªéœ€è¦ä¸¤æ¬¡è¡ŒåŠ¨å°±å¯ä»¥æ‹¾èµ·ä¸€ä¸ª 1 ã€‚</li><li>æƒ…å†µäºŒï¼šä»¤ $n u m s[x]=1$ ï¼Œé‚£ä¹ˆéœ€è¦ $\mid x$-aliceIndex $\mid$ æ¬¡è¡ŒåŠ¨æ‰å¯ä»¥æ‹¾èµ·ä¸€ä¸ª 1 ï¼Œæ ¹æ® $x$ çš„å–å€¼ï¼Œåˆå¯ä»¥åŒºåˆ†æˆä¸¤ç§ç±»å‹:<ul><li>$x \in[$ aliceIndex -1 , aliceIndex +1$]$ ï¼Œé‚£ä¹ˆæœ€å¤šéœ€è¦ 1 æ¬¡è¡ŒåŠ¨å°±å¯ä»¥æ‹¾èµ·ä¸€ä¸ª 1 ã€‚</li><li>$x \notin[$ aliceIndex -1 , aliceIndex +1$]$ ï¼Œé‚£ä¹ˆæœ€å°‘éœ€è¦ 2 æ¬¡è¡ŒåŠ¨æ‰å¯ä»¥æ‹¾èµ·ä¸€ä¸ª 1 ã€‚</li></ul></li></ul><p>ä»¤ $f($ aliceIndex $)$ è¡¨ç¤ºæ•°ç»„ nums åœ¨åŒºé—´ $[$ aliceIndex -1 , aliceIndex +1$]$ å†…çš„å…ƒç´ ä¹‹å’Œã€‚<br>å¦‚æœ $f($ aliceIndex $)+maxChanges \geq k$ ï¼Œé‚£ä¹ˆæœ€å°‘è¡ŒåŠ¨æ¬¡æ•°è‚¯å®šæ˜¯å…ˆå°†åŒºé—´ [aliceIndex -1 , aliceIndex + 1] å†…çš„æ‰€æœ‰ 1 æ‹¾èµ·, ç„¶åå‰©ä½™çš„ 1 æ ¹æ®æƒ…å†µä¸€æ¥æ‹¾èµ·ã€‚</p><p>å¦‚æœ $f($ aliceIndex $)+maxChanges &lt;k$ ï¼Œé‚£ä¹ˆå¯ä»¥è´ªå¿ƒåœ°å…ˆæ‹¾èµ·æƒ…å†µä¸€çš„æ‰€æœ‰ 1 ï¼Œå‰©ä½™ $k-maxChanges$ä¸ª 1 æ ¹æ®æƒ…å†µäºŒæ‹¾èµ·ã€‚æˆ‘ä»¬ä½¿ç”¨ $indexSum [i]$ è®°å½•æ•°ç»„ $n u m s$ åœ¨åŒºé—´ $[0, i)$ å†…æ‰€æœ‰å€¼ä¸º 1 çš„å…ƒç´ ä¸‹æ ‡ä¹‹å’Œï¼Œä½¿ç”¨ $sum[i]$ è®°å½•æ•°ç»„ nums åœ¨åŒºé—´ $[0, i)$ æ‰€æœ‰å…ƒç´ ä¹‹å’Œã€‚è¦ä½¿æƒ…å†µäºŒçš„è¡ŒåŠ¨æ¬¡æ•°ä¹‹å’Œæœ€å°‘ï¼Œé‚£ä¹ˆæ‹¾èµ·çš„ 1 è·ç¦» aliceIndex éœ€è¦å°½é‡è¿‘ã€‚æˆ‘ä»¬ä½¿ç”¨äºŒåˆ†ç®—æ³•æ¥æœç´¢æœ€çŸ­è·ç¦» $d$ ï¼Œä½¿å¾—åŒºé—´ $[aliceIndex-d, aliceIndex+d]$ å†…çš„ 1 æ•°ç›®å¤§äºç­‰äº $k-maxChanges$ ã€‚è®°é€‰æ‹©çš„åŒºé—´ä¸º $\left[i_1, i_2\right]$, é‚£ä¹ˆæœ€å°‘è¡ŒåŠ¨æ¬¡æ•°ä¸º:</p><script type="math/tex; mode=display">\begin{aligned}& \text { indexSum }\left[i_2+1\right]-\text { indexSum }[\text { aliceIndex }+1]-\text { aliceIndex } \times\left(\operatorname{sum}\left[i_2+1\right]-\operatorname{sum}[aliceIndex+1]\right)+\text { aliceIndex } \times \\& \left(\operatorname{sum}[\text { aliceIndex }+1]-\operatorname{sum}\left[i_1\right]\right)-\left(\text { indexSum }[\text { aliceIndex }+1]-\text { indexSum }\left[i_1\right]\right)+2 \times \text { maxChanges }\end{aligned}</script><p>æˆ‘ä»¬å¯ä»¥æšä¸¾ aliceIndex, ç„¶åå–æ‰€æœ‰ç»“æœçš„æœ€å°å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">minimumMoves</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k, <span class="keyword">int</span> maxChanges)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.length;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span>[] indexSum = <span class="keyword">new</span> <span class="keyword">long</span>[n + <span class="number">1</span>], sum = <span class="keyword">new</span> <span class="keyword">long</span>[n + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            indexSum[i + <span class="number">1</span>] = indexSum[i] + nums[i] * i;</span><br><span class="line">            sum[i + <span class="number">1</span>] = sum[i] + nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> res = Long.MAX_VALUE;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (f(i, nums) + maxChanges &gt;= k) &#123;</span><br><span class="line">                <span class="keyword">if</span> (k &lt;= f(i, nums)) &#123;</span><br><span class="line">                    res = Math.min(res, (<span class="keyword">long</span>)k - nums[i]);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    res = Math.min(res, (<span class="keyword">long</span>)<span class="number">2</span> * k - f(i, nums) - nums[i]);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> left = <span class="number">0</span>, right = n;</span><br><span class="line">            <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">                <span class="keyword">int</span> mid = (left + right) / <span class="number">2</span>;</span><br><span class="line">                <span class="keyword">int</span> i1 = Math.max(i - mid, <span class="number">0</span>), i2 = Math.min(i + mid, n - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (sum[i2 + <span class="number">1</span>] - sum[i1] &gt;= k - maxChanges) &#123;</span><br><span class="line">                    right = mid - <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    left = mid + <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> i1 = Math.max(i - left, <span class="number">0</span>), i2 = Math.min(i + left, n - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (sum[i2 + <span class="number">1</span>] - sum[i1] &gt; k - maxChanges) &#123;</span><br><span class="line">                i1++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">long</span> count1 = sum[i + <span class="number">1</span>] - sum[i1], count2 = sum[i2 + <span class="number">1</span>] - sum[i + <span class="number">1</span>];</span><br><span class="line">            res = Math.min(res, indexSum[i2 + <span class="number">1</span>] - indexSum[i + <span class="number">1</span>] - i * count2 + i * count1 - (indexSum[i + <span class="number">1</span>] - indexSum[i1]) + <span class="number">2</span> * maxChanges);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = nums[i];</span><br><span class="line">        <span class="keyword">if</span> (i - <span class="number">1</span> &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            x += nums[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (i + <span class="number">1</span> &lt; nums.length) &#123;</span><br><span class="line">            x += nums[i + <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://leetcode.cn/problems/minimum-moves-to-pick-k-ones/solutions/2827546/shi-qi-k-ge-1-xu-yao-de-zui-shao-xing-do-1c7m/">https://leetcode.cn/problems/minimum-moves-to-pick-k-ones/solutions/2827546/shi-qi-k-ge-1-xu-yao-de-zui-shao-xing-do-1c7m/</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;å‘¨èµ›ä¾ç„¶æ²¡æ‰“ï½&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨ä¸»é¢˜ï¼šå›¾è·¯å¾„æšä¸¾ã€æ·±åº¦ä¼˜å…ˆæœç´¢ã€è´ªå¿ƒã€çŸ©é˜µæšä¸¾&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;240702æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/maximum-path-quality-of-a-graph/description&quot;&gt;Maximum Path Quality of a Graph&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240704æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/minimum-moves-to-pick-k-ones/description/&quot;&gt;Minimum Moves to Pick K Ones&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240707æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/check-if-move-is-legal/description&quot;&gt;Check if Move is Legal&lt;/a&gt;</summary>
    
    
    
    
    <category term="LeetCode" scheme="http://silencezheng.top/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeå‘¨è®° EP15</title>
    <link href="http://silencezheng.top/2024/10/07/article145/"/>
    <id>http://silencezheng.top/2024/10/07/article145/</id>
    <published>2024-10-06T19:10:16.000Z</published>
    <updated>2024-10-28T04:59:53.043Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¢«æœ€å°é—®é¢˜çˆ†æ€çš„ä¸€å‘¨â€¦</p><p>æœ¬å‘¨ä¸»é¢˜ï¼šåŠ¨æ€è§„åˆ’ã€äºŒåˆ†æŸ¥æ‰¾ã€è®°å¿†åŒ–æœç´¢</p><p>é¢˜ç›®ï¼š</p><ul><li>241001æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/minimum-cost-for-tickets/description">Minimum Cost For Tickets</a></li><li>241003æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/minimum-cost-to-reach-destination-in-time/description">Minimum Cost to Reach Destination in Time</a></li><li>241005æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/minimum-time-to-complete-trips/description">Minimum Time to Complete Trips</a></li></ul><span id="more"></span><h1 id="Minimum-Cost-For-Tickets"><a href="#Minimum-Cost-For-Tickets" class="headerlink" title="Minimum Cost For Tickets"></a>Minimum Cost For Tickets</h1><blockquote><p>Minimum Cost For Tickets<br>You have planned some train traveling one year in advance. The days of the year in which you will travel are given as an integer array days. Each day is an integer from 1 to 365.<br>Train tickets are sold in three different ways:</p><ul><li>a 1-day pass is sold for costs[0] dollars,</li><li>a 7-day pass is sold for costs[-1] </li><li>a 30-day pass is sold for costs[-1] </li></ul><p>The passes allow that many days of consecutive travel.<br>For example, if we get a 7-day pass on day 2, then we can travel for 7 days: 2, 3, 4, 5, 6, 7, and 8.<br>Return the minimum number of dollars you need to travel every day in the given list of days.</p></blockquote><p>æ— è®ºè®°å¿†åŒ–æœç´¢è¿˜æ˜¯åŠ¨æ€è§„åˆ’ï¼Œéƒ½éœ€è¦å…ˆ<strong>åˆ’åˆ†å­é—®é¢˜</strong>å’Œ<strong>å®šä¹‰çŠ¶æ€è½¬ç§»</strong>ã€‚</p><p>å‡è®¾ç¬¬ 100 å¤©æ˜¯æ—…è¡Œçš„æœ€åä¸€å¤©ï¼Œåˆ†ç±»è®¨è®ºï¼š</p><ul><li>åœ¨ç¬¬ 100 å¤©è´­ä¹°ä¸ºæœŸ 1 å¤©çš„é€šè¡Œè¯ï¼Œæ¥ä¸‹æ¥éœ€è¦è§£å†³çš„é—®é¢˜ä¸ºï¼š1 åˆ° 99 å¤©çš„æœ€å°èŠ±è´¹ã€‚</li><li>åœ¨ç¬¬ 94 å¤©è´­ä¹°ä¸ºæœŸ 7 å¤©çš„é€šè¡Œè¯ï¼Œæ¥ä¸‹æ¥éœ€è¦è§£å†³çš„é—®é¢˜ä¸ºï¼š1 åˆ° 93 å¤©çš„æœ€å°èŠ±è´¹ã€‚</li><li>åœ¨ç¬¬ 71 å¤©è´­ä¹°ä¸ºæœŸ 30 å¤©çš„é€šè¡Œè¯ï¼Œæ¥ä¸‹æ¥éœ€è¦è§£å†³çš„é—®é¢˜ä¸ºï¼š1 åˆ° 70 å¤©çš„æœ€å°èŠ±è´¹ã€‚<br>è¿™äº›é—®é¢˜éƒ½æ˜¯å’ŒåŸé—®é¢˜ç›¸ä¼¼çš„ã€è§„æ¨¡æ›´å°çš„å­é—®é¢˜ï¼Œå¯ä»¥ç”¨é€’å½’è§£å†³ã€‚</li></ul><blockquote><p>åŠ¨æ€è§„åˆ’æœ‰ã€Œé€‰æˆ–ä¸é€‰ã€å’Œã€Œæšä¸¾é€‰å“ªä¸ªã€ä¸¤ç§åŸºæœ¬æ€è€ƒæ–¹å¼ã€‚åœ¨åšé¢˜æ—¶ï¼Œå¯æ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œé€‰æ‹©é€‚åˆé¢˜ç›®çš„ä¸€ç§æ¥æ€è€ƒã€‚æœ¬é¢˜ç”¨åˆ°çš„æ˜¯ã€Œæšä¸¾é€‰å“ªä¸ªã€ã€‚</p></blockquote><p>æ ¹æ®ä¸Šé¢çš„è®¨è®ºï¼Œå®šä¹‰ $dfs(i)$ è¡¨ç¤º $1$ åˆ° $i$ å¤©çš„æœ€å°èŠ±è´¹ã€‚å¦‚æœç¬¬ $i$ å¤©ä¸åœ¨ days ä¸­ï¼Œé‚£ä¹ˆé—®é¢˜å˜æˆ $1$ åˆ° $iâˆ’1$ å¤©çš„æœ€å°èŠ±è´¹ï¼Œå³ $dfs(i)=dfs(iâˆ’1)$</p><p>å¦‚æœç¬¬ $i$ å¤©åœ¨ days ä¸­ï¼Œåˆ†ç±»è®¨è®ºï¼š</p><ul><li>åœ¨ç¬¬ $i$ å¤©è´­ä¹°ä¸ºæœŸ $1$ å¤©çš„é€šè¡Œè¯ï¼Œæ¥ä¸‹æ¥éœ€è¦è§£å†³çš„é—®é¢˜ä¸ºï¼š$1$ åˆ° $iâˆ’1$ å¤©çš„æœ€å°èŠ±è´¹ï¼Œå³ $dfs(i)=dfs(iâˆ’1)+costs[0]$ã€‚</li><li>åœ¨ç¬¬ $iâˆ’6$ å¤©è´­ä¹°ä¸ºæœŸ $7$ å¤©çš„é€šè¡Œè¯ï¼Œæ¥ä¸‹æ¥éœ€è¦è§£å†³çš„é—®é¢˜ä¸ºï¼š$1$ åˆ° $iâˆ’7$ å¤©çš„æœ€å°èŠ±è´¹ï¼Œå³ $dfs(i)=dfs(iâˆ’7)+costs[1]$ã€‚</li><li>åœ¨ç¬¬ $iâˆ’29$ å¤©è´­ä¹°ä¸ºæœŸ $30$ å¤©çš„é€šè¡Œè¯ï¼Œæ¥ä¸‹æ¥éœ€è¦è§£å†³çš„é—®é¢˜ä¸ºï¼š$1$ åˆ° $iâˆ’30$ å¤©çš„æœ€å°èŠ±è´¹ï¼Œå³ $dfs(i)=dfs(iâˆ’30)+costs[2]$ã€‚</li></ul><p>è¿™ä¸‰ç§æƒ…å†µå–æœ€å°å€¼ï¼Œå°±å¾—åˆ°äº† dfs(i)ï¼Œå³</p><script type="math/tex; mode=display">dfs(i)=min(dfs(iâˆ’1)+costs[0],dfs(iâˆ’7)+costs[1],dfs(iâˆ’30)+costs[2])</script><p>é€’å½’è¾¹ç•Œï¼š$dfs(i)=0$ï¼Œå…¶ä¸­ $iâ‰¤0$ã€‚æ­¤æ—¶æ²¡æœ‰è¦æ—…è¡Œçš„å¤©æ•°ã€‚</p><p>é€’å½’å…¥å£ï¼š$dfs(D)$ï¼Œå…¶ä¸­ $D=days[nâˆ’1]$ æ˜¯æœ€åä¸€å¤©ã€‚ä¸ºäº†æ–¹ä¾¿ç¿»è¯‘æˆé€’æ¨ï¼Œæˆ‘ä»¬ä»æœ€åä¸€å¤©å¼€å§‹æ€è€ƒã€‚</p><h2 id="è®°å¿†åŒ–æœç´¢"><a href="#è®°å¿†åŒ–æœç´¢" class="headerlink" title="è®°å¿†åŒ–æœç´¢"></a>è®°å¿†åŒ–æœç´¢</h2><p>é‡‡ç”¨é€’å½’+è®°å¿†åŒ–çš„æ–¹å¼è‡ªé¡¶å‘ä¸‹è§£å†³é—®é¢˜ï¼Œæ‰€è°“è‡ªé¡¶å‘ä¸‹ï¼Œå³ä»æœ€ç»ˆç»“æœ$dfs(D)$å‘ä¸‹å»¶ä¼¸è‡³åº•å±‚è®¡ç®—ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">mincostTickets</span><span class="params">(<span class="keyword">int</span>[] days, <span class="keyword">int</span>[] costs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> lastDay = days[days.length - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">boolean</span>[] isTravel = <span class="keyword">new</span> <span class="keyword">boolean</span>[lastDay + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> d : days) &#123;</span><br><span class="line">            isTravel[d] = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span>[] memo = <span class="keyword">new</span> <span class="keyword">int</span>[lastDay + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> dfs(lastDay, isTravel, costs, memo);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">boolean</span>[] isTravel, <span class="keyword">int</span>[] costs, <span class="keyword">int</span>[] memo)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (memo[i] &gt; <span class="number">0</span>) &#123; <span class="comment">// ä¹‹å‰è®¡ç®—è¿‡</span></span><br><span class="line">            <span class="keyword">return</span> memo[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!isTravel[i]) &#123;</span><br><span class="line">            <span class="keyword">return</span> memo[i] = dfs(i - <span class="number">1</span>, isTravel, costs, memo);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> memo[i] = Math.min(dfs(i - <span class="number">1</span>, isTravel, costs, memo) + costs[<span class="number">0</span>],</span><br><span class="line">                         Math.min(dfs(i - <span class="number">7</span>, isTravel, costs, memo) + costs[<span class="number">1</span>],</span><br><span class="line">                                  dfs(i - <span class="number">30</span>, isTravel, costs, memo) + costs[<span class="number">2</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><p>è‡ªåº•å‘ä¸Šéå†ï¼Œå³ä»daysæ•°ç»„çš„å·¦ä¾§å¼€å§‹ï¼ŒçŠ¶æ€ $f[i]$ çš„å®šä¹‰å’Œ $dfs(i)$ çš„å®šä¹‰æ˜¯ä¸€æ ·çš„ï¼Œéƒ½è¡¨ç¤º $1$ åˆ° $i$ å¤©çš„æœ€å°èŠ±è´¹ã€‚</p><p>ç›¸åº”çš„é€’æ¨å¼ï¼ˆçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼‰ä¹Ÿå’Œ dfs ä¸€æ ·ï¼š</p><script type="math/tex; mode=display">f[i]=min(f[iâˆ’1]+costs[0],f[iâˆ’7]+costs[1],f[iâˆ’30]+costs[2])</script><p>ç”±äº $f[0]=0$ ä¸”è´Ÿæ•° $i$ çš„çŠ¶æ€å€¼ä¹Ÿä¸º $0$ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè´Ÿæ•° $i$ è§†ä½œ $0$ï¼Œä¸Šå¼ç­‰ä»·äº</p><script type="math/tex; mode=display">f[i]=min(f[iâˆ’1]+costs[0],f[max(iâˆ’7,0)]+costs[1],f[max(iâˆ’30,0)]+costs[2])</script><p>åˆå§‹å€¼ $f[0]=0$ï¼Œç¿»è¯‘è‡ªé€’å½’è¾¹ç•Œ $dfs(0)=0$ã€‚ç­”æ¡ˆä¸º $f[D]$ï¼Œç¿»è¯‘è‡ªé€’å½’å…¥å£ $dfs(D)$ã€‚æ‰€è°“è‡ªåº•å‘ä¸Šï¼Œå³å…ˆè®¡ç®—åº•å±‚ç»“æœï¼Œæœ€åè·å¾—æœ€ç»ˆç­”æ¡ˆ $f[D]$ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">mincostTickets</span><span class="params">(<span class="keyword">int</span>[] days, <span class="keyword">int</span>[] costs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> lastDay = days[days.length - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">boolean</span>[] isTravel = <span class="keyword">new</span> <span class="keyword">boolean</span>[lastDay + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> d : days) &#123;</span><br><span class="line">            isTravel[d] = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span>[] f = <span class="keyword">new</span> <span class="keyword">int</span>[lastDay + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= lastDay; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!isTravel[i]) &#123;</span><br><span class="line">                f[i] = f[i - <span class="number">1</span>];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                f[i] = Math.min(f[i - <span class="number">1</span>] + costs[<span class="number">0</span>],</span><br><span class="line">                       Math.min(f[Math.max(i - <span class="number">7</span>, <span class="number">0</span>)] + costs[<span class="number">1</span>],</span><br><span class="line">                                f[Math.max(i - <span class="number">30</span>, <span class="number">0</span>)] + costs[<span class="number">2</span>]));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> f[lastDay];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h2><p>å¯¹äºæœ¬é¢˜ï¼Œæœ€ç†æƒ³çš„æƒ…å†µæ˜¯æ—¶é—´å¤æ‚åº¦ä»…ä¸daysæ•°ç»„çš„é•¿åº¦æœ‰å…³è€Œä¸$D=days[nâˆ’1]$çš„å¤§å°æ— å…³ã€‚</p><p>é‡æ–°å®šä¹‰ $f[i]$ è¡¨ç¤ºæ—…è¡Œäº† $i$ å¤©çš„æœ€å°èŠ±è´¹ï¼š</p><ul><li>$f[0]$ è¡¨ç¤ºæ—…è¡Œ $0$ å¤©çš„æœ€å°èŠ±è´¹ï¼Œæ ¹æ®å®šä¹‰ï¼Œ$f[0]=0$ã€‚</li><li>$f[1]$ è¡¨ç¤ºæ—…è¡Œ $1$ å¤©çš„æœ€å°èŠ±è´¹ï¼Œä¹Ÿå°±æ˜¯å®Œæˆ $days[0]$ çš„æœ€å°èŠ±è´¹ã€‚</li><li>$f[2]$ è¡¨ç¤ºæ—…è¡Œ $2$ å¤©çš„æœ€å°èŠ±è´¹ï¼Œä¹Ÿå°±æ˜¯å®Œæˆ $days[0]$ å’Œ $days[1]$ çš„æœ€å°èŠ±è´¹ã€‚</li><li>ä¸€èˆ¬åœ°ï¼Œ$f[i+1]$ è¡¨ç¤ºå®Œæˆ $days[0]$ åˆ° $days[i]$ çš„æœ€å°èŠ±è´¹ã€‚</li></ul><p>åˆ†ç±»è®¨è®ºï¼š</p><ul><li>åœ¨ $days[i]$ è´­ä¹°ä¸ºæœŸ $1$ å¤©çš„é€šè¡Œè¯ï¼Œæ¥ä¸‹æ¥éœ€è¦è§£å†³çš„é—®é¢˜ä¸ºï¼šå®Œæˆ $days[0]$ åˆ° $days[iâˆ’1]$ çš„æœ€å°èŠ±è´¹ï¼Œå³ $f[i+1]=f[i]+costs[0]$ã€‚</li><li>åœ¨ç¬¬ $days[j]$ å¤©è´­ä¹°ä¸ºæœŸ $7$ å¤©çš„é€šè¡Œè¯ï¼Œæ»¡è¶³ $days[j]+7&gt;days[i]$ï¼ˆæ³¨æ„ä¸æ˜¯ â‰¥ï¼‰ï¼Œæ¥ä¸‹æ¥éœ€è¦è§£å†³çš„é—®é¢˜ä¸ºï¼šå®Œæˆ $days[0]$ åˆ° $days[jâˆ’1]$ çš„æœ€å°èŠ±è´¹ï¼Œå³ $f[i+1]=f[j]+costs[1]$ã€‚</li><li>åœ¨ç¬¬ $days[k]$ å¤©è´­ä¹°ä¸ºæœŸ $30$ å¤©çš„é€šè¡Œè¯ï¼Œæ»¡è¶³ $days[k]+30&gt;days[i]$ï¼Œæ¥ä¸‹æ¥éœ€è¦è§£å†³çš„é—®é¢˜ä¸ºï¼šå®Œæˆ $days[0]$ åˆ° $days[kâˆ’1]$ çš„æœ€å°èŠ±è´¹ï¼Œå³ $f[i+1]=f[k]+costs[2]$ã€‚ </li></ul><p>è¿™ä¸‰ç§æƒ…å†µå–æœ€å°å€¼ï¼Œå°±å¾—åˆ°äº† $f[i+1]$ï¼Œå³</p><script type="math/tex; mode=display">f[i+1]=min(f[i]+costs[0],f[j]+costs[1],f[k]+costs[2])</script><p>å…¶ä¸­ï¼š</p><ul><li>$j$ æ˜¯æ»¡è¶³ $days[j]&gt;days[i]âˆ’7$ çš„æœ€å°çš„ $j$ã€‚</li><li>$k$ æ˜¯æ»¡è¶³ $days[k]&gt;days[i]âˆ’30$ çš„æœ€å°çš„ $k$ã€‚<br>ç”±äº $days$ æ˜¯æœ‰åºæ•°ç»„ï¼Œè®¡ç®— $j$ å’Œ $k$ å¯ä»¥ç”¨åŒæŒ‡é’ˆï¼ˆä¸‰æŒ‡é’ˆï¼‰ç®—æ³•ã€‚åˆå§‹å€¼ $f[0]=0, j=0, k=0$ã€‚ç­”æ¡ˆä¸º $f[n]$ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">mincostTickets</span><span class="params">(<span class="keyword">int</span>[] days, <span class="keyword">int</span>[] costs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = days.length;</span><br><span class="line">        <span class="keyword">int</span>[] f = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> d = days[i];</span><br><span class="line">            <span class="keyword">while</span> (days[j] &lt;= d - <span class="number">7</span>) &#123;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (days[k] &lt;= d - <span class="number">30</span>) &#123;</span><br><span class="line">                k++;</span><br><span class="line">            &#125;</span><br><span class="line">            f[i + <span class="number">1</span>] = Math.min(f[i] + costs[<span class="number">0</span>], Math.min(f[j] + costs[<span class="number">1</span>], f[k] + costs[<span class="number">2</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> f[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Minimum-Cost-to-Reach-Destination-in-Time"><a href="#Minimum-Cost-to-Reach-Destination-in-Time" class="headerlink" title="Minimum Cost to Reach Destination in Time"></a><a href="https://leetcode.cn/problems/minimum-cost-to-reach-destination-in-time/description">Minimum Cost to Reach Destination in Time</a></h1><p>é¢˜æ„ï¼šä»èµ·ç‚¹åˆ°ç»ˆç‚¹ï¼Œåˆ¤æ–­æ˜¯å¦å¯åœ¨<code>maxTime</code>å†…åˆ°è¾¾ï¼Œå¹¶è®¡ç®—æœ€å°è¿‡è·¯è´¹ã€‚</p><p>æ³¨æ„ï¼šåœ¨$[1, maxTime]$ä¸­ä»»ä¸€æ—¶é—´åˆ°è¾¾ç»ˆç‚¹ï¼Œæ‰€èŠ±è´¹çš„è¿‡è·¯è´¹å¤šå°‘ä¸ä¸€å®šï¼Œå³æ—¶é—´ä¸èŠ±è´¹æ— å…³ï¼Œå› æ­¤éœ€è¦è®¡ç®—å…¨éƒ¨åç­›é€‰å‡ºæœ€å°èŠ±è´¹ã€‚</p><h2 id="åŠ¨æ€è§„åˆ’-1"><a href="#åŠ¨æ€è§„åˆ’-1" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><p>æˆ‘ä»¬ç”¨ $f[t][i]$ è¡¨ç¤ºä½¿ç”¨æ°å¥½ $t$ åˆ†é’Ÿåˆ°è¾¾åŸå¸‚ $i$ éœ€è¦çš„æœ€å°‘é€šè¡Œè´¹æ€»å’Œã€‚<br>åœ¨çŠ¶æ€è½¬ç§»æ—¶ï¼Œæˆ‘ä»¬è€ƒè™‘æœ€åä¸€æ¬¡é€šè¡Œæ˜¯ä»åŸå¸‚ $j$ åˆ°è¾¾åŸå¸‚ $i$ çš„ï¼Œé‚£ä¹ˆæœ‰çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f[t][i]=\min _{(j, i) \in E}\{f[t-\operatorname{cost}(j, i)][j]+\text { passingFees }[i]\}</script><p>å…¶ä¸­ $(j, i) \in E$ è¡¨ç¤ºåŸå¸‚ $j$ ä¸ $i$ å­˜åœ¨ä¸€æ¡é“è·¯ï¼Œ $\operatorname{cost}(j, i)$ è¡¨ç¤ºè¿™æ¡é“è·¯çš„è€—è´¹æ—¶é—´ã€‚<br>æœ€ç»ˆçš„ç­”æ¡ˆå³ä¸º $f[1][n-1], f[2][n-1], \cdots, f[\operatorname{maxTime}][n-1]$ ä¸­çš„æœ€å°å€¼ã€‚</p><p>åˆå§‹çŠ¶æ€ä¸º $f[0][0]=passingFees[0]$, å³æˆ‘ä»¬ä¸€å¼€å§‹ä½äº 0 å·åŸå¸‚, éœ€è¦äº¤ $passingFees[0]$çš„é€šè¡Œè´¹ã€‚</p><p>ç”±äºçŠ¶æ€ä¸­å­˜æ”¾æœ€å°å€¼ï¼Œå› æ­¤å¯¹äºå…¶å®ƒçš„çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€å¼€å§‹èµ‹äºˆå®ƒä»¬ä¸€ä¸ªæå¤§å€¼ $\infty$ ã€‚å¦‚æœæœ€ç»ˆçš„ç­”æ¡ˆä¸º $\infty$, è¯´æ˜æ— æ³•åœ¨ maxTime åŠä»¥å†…å®Œæˆæ—…è¡Œ, è¿”å› $-1$ ã€‚</p><p>æ­¤å¤–, æœ¬é¢˜ä¸­çš„é“è·¯æ˜¯ä»¥æ•°ç»„ $edges$ çš„å½¢å¼ç»™å®šçš„, åœ¨åŠ¨æ€è§„åˆ’çš„è¿‡ç¨‹ä¸­, å¦‚æœæˆ‘ä»¬ä½¿ç”¨ä¸¤é‡å¾ªç¯æšä¸¾ $t$ å’Œ $i$, å°±ä¸èƒ½åˆ©ç”¨ $edges$, è€Œéœ€è¦ä½¿ç”¨é¢å¤–çš„æ•°æ®ç»“æ„å­˜å‚¨ä»¥ $i$ ä¸ºç«¯ç‚¹çš„æ‰€æœ‰é“è·¯ã€‚ä¸€ç§åˆç†çš„è§£å†³æ–¹æ³•æ˜¯, æˆ‘ä»¬ä½¿ç”¨ä¸€é‡å¾ªç¯æšä¸¾ $t$, å¦ä¸€é‡å¾ªç¯æšä¸¾ edges ä¸­çš„æ¯ä¸€æ¡è¾¹ $(i, j, cost )$, é€šè¿‡è¿™æ¡è¾¹æ›´æ–° $f[t][i]$ ä»¥åŠ $f[t][j]$ çš„å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minCost</span><span class="params">(<span class="keyword">int</span> maxTime, <span class="keyword">int</span>[][] edges, <span class="keyword">int</span>[] passingFees)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = passingFees.length;</span><br><span class="line">        <span class="keyword">int</span>[][] f = <span class="keyword">new</span> <span class="keyword">int</span>[maxTime + <span class="number">1</span>][n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= maxTime; i++) &#123;</span><br><span class="line">            Arrays.fill(f[i], Integer.MAX_VALUE);</span><br><span class="line">        &#125;</span><br><span class="line">        f[<span class="number">0</span>][<span class="number">0</span>] = passingFees[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> t = <span class="number">1</span>; t &lt;= maxTime; t++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span>[] edge : edges) &#123;</span><br><span class="line">                <span class="keyword">int</span> i = edge[<span class="number">0</span>], j = edge[<span class="number">1</span>], cost = edge[<span class="number">2</span>];</span><br><span class="line">                <span class="keyword">if</span> (cost &lt;= t) &#123;</span><br><span class="line">                    <span class="comment">// ç¡®ä¿ä»å‰åºæ›´æ–°è¿‡çš„çŠ¶æ€è½¬ç§»ï¼Œä¸”åŒå‘éƒ½å¯ä»¥æ›´æ–°</span></span><br><span class="line">                    <span class="keyword">if</span> (f[t - cost][j] != Integer.MAX_VALUE) &#123;</span><br><span class="line">                        f[t][i] = Math.min(f[t][i], f[t - cost][j] + passingFees[i]);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (f[t - cost][i] != Integer.MAX_VALUE) &#123;</span><br><span class="line">                        f[t][j] = Math.min(f[t][j], f[t - cost][i] + passingFees[j]);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> ans = Integer.MAX_VALUE;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> t = <span class="number">1</span>; t &lt;= maxTime; t++) &#123;</span><br><span class="line">            ans = Math.min(ans, f[t][n - <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans == Integer.MAX_VALUE ? -<span class="number">1</span> : ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Minimum-Time-to-Complete-Trips"><a href="#Minimum-Time-to-Complete-Trips" class="headerlink" title="Minimum Time to Complete Trips"></a>Minimum Time to Complete Trips</h1><blockquote><p>Minimum Time to Complete Trips</p><p>You are given an array time where time[i] denotes the time taken by the ith bus to complete one trip.</p><p>Each bus can make multiple trips successively; that is, the next trip can start immediately after completing the current trip. Also, each bus operates independently; that is, the trips of one bus do not influence the trips of any other bus.</p><p>You are also given an integer totalTrips, which denotes the number of trips all buses should make in total. Return the minimum time required for all buses to complete at least totalTrips trips.</p></blockquote><p>é¦–å…ˆå»ºç«‹ä¸€ä¸ªMapï¼Œå…¶ä¸­keyä¸ºæ—¶é—´ï¼Œvalueä¸ºè¯¥æ—¶é—´å¯¹åº”çš„tripæ•°é‡ï¼Œå‡è®¾è¯¥Mapä¸º<code>m</code>ã€‚å‡è®¾å½“å‰å­˜åœ¨çš„keyä¸º<code>k1, k2, k3,...,kn</code>ï¼Œåˆ™å¯¹äºæ—¶é—´<code>t</code>ï¼Œå®Œæˆçš„tripæ•°é‡<code>f(t)</code>å¯å¦‚æ­¤è®¡ç®—ï¼š</p><script type="math/tex; mode=display">f(t) = t/k1*v1 + t/k2*v2 + ... + t/kn*vn</script><p>å¯ä»¥å‘ç°<code>f(t)</code>å…·æœ‰å•è°ƒæ€§ï¼Œæ•…è€ƒè™‘äºŒåˆ†æŸ¥æ‰¾ã€‚</p><h2 id="äºŒåˆ†æŸ¥æ‰¾"><a href="#äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾"></a>äºŒåˆ†æŸ¥æ‰¾</h2><p>äºŒåˆ†æŸ¥æ‰¾çš„ä¸‹ç•Œä¸º$1$ï¼Œä¸Šç•Œä¸ºè¿è¡Œæ—¶é—´æœ€çŸ­çš„busè¿è¡Œ<code>totalTrips</code>è¶Ÿæ‰€ç”¨æ—¶é—´ã€‚å®é™…æµ‹è¯•ä¸­ä½¿ç”¨Mapçš„æ–¹æ³•æ—¶ç©ºæ•ˆç‡å‡ä¸å¦‚ç›´æ¥ä½¿ç”¨<code>time</code>æ•°ç»„è¿›è¡Œ<code>check</code>ï¼Œåœ¨é‡å¤busä¸å¤šçš„æƒ…å†µä¸‹å¯ä»¥é€‰æ‹©ä¸ä½¿ç”¨Mapã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    Map&lt;Integer, Integer&gt; map;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">minimumTime</span><span class="params">(<span class="keyword">int</span>[] time, <span class="keyword">int</span> totalTrips)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// map</span></span><br><span class="line">        map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> x:time) map.merge(x, <span class="number">1</span>, Integer::sum);</span><br><span class="line">        <span class="comment">// äºŒåˆ†æŸ¥æ‰¾ä¸‹ç•Œä¸ä¸Šç•Œ</span></span><br><span class="line">        <span class="keyword">long</span> l = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">long</span> r = (<span class="keyword">long</span>) totalTrips * Arrays.stream(time).min().orElse(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// äºŒåˆ†æŸ¥æ‰¾å¯»æ‰¾æ»¡è¶³è¦æ±‚çš„æœ€å°çš„ t</span></span><br><span class="line">        <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">            <span class="keyword">long</span> mid = l + (r - l) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (check(mid, totalTrips)) &#123;</span><br><span class="line">                r = mid;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                l = mid + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> l;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ¤æ–­ t æ—¶é—´å†…æ˜¯å¦å¯ä»¥å®Œæˆ totalTrips è¶Ÿæ—…é€”</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(<span class="keyword">long</span> t, <span class="keyword">int</span> totalTrips)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> period : map.keySet()) &#123;</span><br><span class="line">            cnt += t / period * map.get(period);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cnt &gt;= totalTrips;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://leetcode.cn/problems/minimum-cost-for-tickets/solutions/2936177/jiao-ni-yi-bu-bu-si-kao-dpcong-ji-yi-hua-tkw4/?envType=daily-question&amp;envId=2024-10-01">https://leetcode.cn/problems/minimum-cost-for-tickets/solutions/2936177/jiao-ni-yi-bu-bu-si-kao-dpcong-ji-yi-hua-tkw4/?envType=daily-question&amp;envId=2024-10-01</a><br>[2] <a href="https://leetcode.cn/problems/minimum-cost-to-reach-destination-in-time/solutions/869919/gui-ding-shi-jian-nei-dao-da-zhong-dian-n3ews/?envType=daily-question&amp;envId=2024-10-03">https://leetcode.cn/problems/minimum-cost-to-reach-destination-in-time/solutions/869919/gui-ding-shi-jian-nei-dao-da-zhong-dian-n3ews/?envType=daily-question&amp;envId=2024-10-03</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è¢«æœ€å°é—®é¢˜çˆ†æ€çš„ä¸€å‘¨â€¦&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨ä¸»é¢˜ï¼šåŠ¨æ€è§„åˆ’ã€äºŒåˆ†æŸ¥æ‰¾ã€è®°å¿†åŒ–æœç´¢&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;241001æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/minimum-cost-for-tickets/description&quot;&gt;Minimum Cost For Tickets&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;241003æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/minimum-cost-to-reach-destination-in-time/description&quot;&gt;Minimum Cost to Reach Destination in Time&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;241005æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/minimum-time-to-complete-trips/description&quot;&gt;Minimum Time to Complete Trips&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    
    <category term="LeetCode" scheme="http://silencezheng.top/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeå‘¨è®° EP14</title>
    <link href="http://silencezheng.top/2024/10/05/article144/"/>
    <id>http://silencezheng.top/2024/10/05/article144/</id>
    <published>2024-10-05T09:58:33.000Z</published>
    <updated>2024-10-27T15:28:37.314Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>é¢çš„æœ‰ç‚¹éº»äº†ï¼Œåšé¢˜åè€Œæœ‰æ„æ€ç‚¹ã€‚</p><p>æœ¬å‘¨ä¸»é¢˜ï¼šä¼˜åŒ–éå†ã€æ»‘åŠ¨çª—å£ã€çº¿æ®µæ ‘ã€é›†åˆ</p><p>é¢˜ç›®ï¼š</p><ul><li>240923æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/best-sightseeing-pair/description">Best Sightseeing Pair</a></li><li>240925æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/naming-a-company/description">Naming a Company</a></li><li>240927æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/take-k-of-each-character-from-left-and-right/description">Take K of Each Character From Left and Right</a></li><li>240928æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/booking-concert-tickets-in-groups/description">Booking Concert Tickets in Groups</a></li></ul><span id="more"></span><h1 id="Best-Sightseeing-Pair"><a href="#Best-Sightseeing-Pair" class="headerlink" title="Best Sightseeing Pair"></a>Best Sightseeing Pair</h1><blockquote><p>Best Sightseeing Pair</p><p>You are given an integer array values where values[i] represents the value of the ith sightseeing spot. Two sightseeing spots i and j have a distance j - i between them.</p><p>The score of a pair (i &lt; j) of sightseeing spots is values[i] + values[j] + i - j: the sum of the values of the sightseeing spots, minus the distance between them.</p><p>Return the maximum score of a pair of sightseeing spots.</p></blockquote><p>æš´åŠ›è¶…æ—¶ï¼Œä¼˜åŒ–æˆæ’åºè¿˜æ˜¯è¶…æ—¶â€¦æ²¡æƒ³åˆ°å¦‚ä½•ä¼˜åŒ–éå†ï¼Œäºæ˜¯è®°å½•ä¸€ä¸‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxScoreSightseeingPair</span><span class="params">(<span class="keyword">int</span>[] values)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> n = values.length;</span><br><span class="line">        <span class="keyword">int</span>[][] arr1 = <span class="keyword">new</span> <span class="keyword">int</span>[n][<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            arr1[i] = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i, values[i]-i&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        Arrays.sort(arr1, (a,b)-&gt;b[<span class="number">1</span>]-a[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span>[] x:arr1)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;x[<span class="number">0</span>];i++)&#123;</span><br><span class="line">                res = Math.max(res, values[i]+i+x[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¼˜åŒ–éå†"><a href="#ä¼˜åŒ–éå†" class="headerlink" title="ä¼˜åŒ–éå†"></a>ä¼˜åŒ–éå†</h2><p>å…¶å®å¯¹äºæ¯ä¸€ä¸ª$values[j]-j$å°±æ˜¯è¦æ‰¾åˆ°$[0, j-1]$ä¸­æœ€å¤§çš„$values[i]+i$ã€‚æ‰€ä»¥å…¶å®ä»å‰å¾€åéå†çš„è¿‡ç¨‹ä¸­ç»´æŠ¤$mx = Max(values[i]+i)$å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxScoreSightseeingPair</span><span class="params">(<span class="keyword">int</span>[] values)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>, mx = values[<span class="number">0</span>] + <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; values.length; ++j) &#123;</span><br><span class="line">            ans = Math.max(ans, mx + values[j] - j);</span><br><span class="line">            <span class="comment">// è¾¹éå†è¾¹ç»´æŠ¤</span></span><br><span class="line">            mx = Math.max(mx, values[j] + j);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Naming-a-Company"><a href="#Naming-a-Company" class="headerlink" title="Naming a Company"></a><a href="https://leetcode.cn/problems/naming-a-company/description">Naming a Company</a></h1><p>ç”¨å“ˆå¸Œæ˜ å°„ names å­˜å‚¨æ‰€æœ‰çš„å€™é€‰åå­—ï¼Œå®ƒçš„é”®æ˜¯é¦–å­—æ¯ï¼Œå€¼æ˜¯å»é™¤é¦–å­—æ¯åï¼Œæ¯ä¸ªå€™é€‰åå­—çš„å‰©ä½™éƒ¨åˆ†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æšä¸¾ä¸¤ä¸ªä¸åŒçš„é¦–å­—æ¯ $p r e_A$ å’Œ $p r e_B$ï¼Œè®¡ç®—ä»¥å®ƒä»¬ä¸ºé¦–å­—æ¯çš„æœ‰æ•ˆçš„å…¬å¸åå­—æ•°é‡ã€‚</p><p>ä¸¤é›†åˆ$p r e_A$ å’Œ $p r e_B$çš„ç¬¦åˆæ¡ä»¶ç»„åˆæ•°é‡ä¸ºï¼š</p><script type="math/tex; mode=display">\left.\mid \text { names }\left[\text { pre }_A\right]-\text { names }\left[\text { pre }_B\right]|\times|{\text { names }\left[\text { pre }_B\right]-\text { names }[\text { pre }}_A\right] \mid</script><p>å…¶ä¸­ $|\cdot|$ è¡¨ç¤ºé›†åˆå¤§å°ï¼Œ $-$ è¡¨ç¤ºé›†åˆçš„å·®é›†è¿ç®—ã€‚æšä¸¾æ‰€æœ‰ä¸åŒçš„ $\mathrm{pre}_A$ å’Œ $p r e_B$, å³å¯å¾—åˆ°æœ€ç»ˆçš„ç­”æ¡ˆã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ä¸Šå¼éœ€è¦è®¡ç®—ä¸¤æ¬¡é›†åˆçš„å·®é›†ï¼Œä½†å®é™…ä¸Šæˆ‘ä»¬åªéœ€è¦çŸ¥é“å·®é›†çš„å¤§å°è€Œä¸æ˜¯å·®é›†æœ¬èº«ã€‚å¯¹äºé›†åˆ $A, B$, æœ‰ $A-B=A \backslash(A \cap B)$, å…¶ä¸­ $\backslash$ è¡¨ç¤ºå°†å…ƒç´ å»é™¤, $\cap$ è¡¨ç¤ºé›†åˆçš„äº¤é›†è¿ç®—ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®—ä¸€æ¬¡é›†åˆçš„äº¤é›†å³å¯ï¼Œé€šè¿‡ $|A|-|A \cap B|$ ä»¥åŠ $|B|-|A \cap B|$ å³å¯å¿«é€Ÿå¾—åˆ°ä¸¤ä¸ªå·®é›†çš„å¤§å°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">distinctNames</span><span class="params">(String[] ideas)</span> </span>&#123;</span><br><span class="line">        Map&lt;Character, Set&lt;String&gt;&gt; names = <span class="keyword">new</span> HashMap&lt;Character, Set&lt;String&gt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (String idea : ideas) names.computeIfAbsent(idea.charAt(<span class="number">0</span>), x-&gt;<span class="keyword">new</span> HashSet&lt;String&gt;()).add(idea.substring(<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;Character, Set&lt;String&gt;&gt; entryA : names.entrySet()) &#123;</span><br><span class="line">            <span class="keyword">char</span> preA = entryA.getKey();</span><br><span class="line">            Set&lt;String&gt; setA = entryA.getValue();</span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;Character, Set&lt;String&gt;&gt; entryB : names.entrySet()) &#123;</span><br><span class="line">                <span class="keyword">char</span> preB = entryB.getKey();</span><br><span class="line">                Set&lt;String&gt; setB = entryB.getValue();</span><br><span class="line">                <span class="keyword">if</span> (preA == preB) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">int</span> intersect = getIntersectSize(setA, setB);</span><br><span class="line">                ans += (<span class="keyword">long</span>) (setA.size() - intersect) * (setB.size() - intersect);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getIntersectSize</span><span class="params">(Set&lt;String&gt; a, Set&lt;String&gt; b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (String s : a) &#123;</span><br><span class="line">            <span class="keyword">if</span> (b.contains(s)) &#123;</span><br><span class="line">                ans++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Take-K-of-Each-Character-From-Left-and-Right"><a href="#Take-K-of-Each-Character-From-Left-and-Right" class="headerlink" title="Take K of Each Character From Left and Right"></a>Take K of Each Character From Left and Right</h1><blockquote><p>Take K of Each Character From Left and Right</p><p>You are given a string s consisting of the characters â€˜aâ€™, â€˜bâ€™, and â€˜câ€™ and a non-negative integer k. Each minute, you may take either the leftmost character of s, or the rightmost character of s.</p><p>Return the minimum number of minutes needed for you to take at least k of each character, or return -1 if it is not possible to take k of each character.</p></blockquote><p>ä¸€å¼€å§‹çš„æ€è·¯æ˜¯æ¨¡æ‹Ÿï¼Œç„¶åå¯¹äºå·¦å³éƒ½å¯å–çš„æƒ…å†µéœ€è¦åˆ†æ”¯å°è¯•ï¼Œè¿™æ ·ä¼šé€ æˆåˆ†æ”¯å¤ªå¤šè¶…æ—¶ã€‚å…¶å®è¿™ä¹Ÿæ˜¯æ­£å‘æ¨¡æ‹Ÿèµ°ä¸é€šçš„åŸå› ï¼Œæˆ‘ä»¬åœ¨é€‰å–å·¦å³ä¸¤è¾¹æ—¶æ— æ³•äº†è§£åç»­æƒ…å†µã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">takeCharacters</span><span class="params">(String s, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.k = k;</span><br><span class="line">        <span class="keyword">int</span> n = s.length();</span><br><span class="line">        <span class="keyword">int</span> ta = <span class="number">0</span>, tb = <span class="number">0</span>, tc = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s.charAt(i)==<span class="string">&#x27;a&#x27;</span>) ta++;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(s.charAt(i)==<span class="string">&#x27;b&#x27;</span>) tb++;</span><br><span class="line">            <span class="keyword">else</span> tc++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(ta&lt;k||tb&lt;k||tc&lt;k) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="comment">// what is the problem?</span></span><br><span class="line">        <span class="comment">// let&#x27;s define the last pick index from left to right is f(i)</span></span><br><span class="line">        <span class="comment">// the penultimate valid pick index is f(i-1)</span></span><br><span class="line">        <span class="comment">// then the picks from f(i-1) to f(i) is redundant</span></span><br><span class="line">        <span class="comment">// if s[f(i)] == x and there is index j from right to left</span></span><br><span class="line">        <span class="comment">// where s[j] == x and rightEnd - j &lt; f(i)-f(i-1)</span></span><br><span class="line">        <span class="comment">// It&#x27;s a better solution to pick f(i-1) and j instead of f(i)</span></span><br><span class="line">        <span class="comment">// Let&#x27;s define f(i) is next pick, and the computation relys on following parameters:</span></span><br><span class="line">        <span class="comment">// 1. what we got, use count(&#x27;a&#x27;), count(&#x27;b&#x27;) and count(&#x27;c&#x27;)</span></span><br><span class="line">        <span class="comment">// 2. 2 pointers l and r, which means where we picked now</span></span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, r = n-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span>[] cnt = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">return</span> pick(s, l, r, cnt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">pick</span><span class="params">(String s, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span>[] cnt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(cnt[<span class="number">0</span>]&lt;k||cnt[<span class="number">1</span>]&lt;k||cnt[<span class="number">2</span>]&lt;k)&#123;</span><br><span class="line">            <span class="keyword">int</span> pl = l, pr = r, cl = <span class="number">0</span>, cr = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(pl+cl&lt;s.length()-<span class="number">1</span>&amp;&amp;!valid(s.charAt(pl+cl), cnt)) cl++;</span><br><span class="line">            <span class="keyword">while</span>(pr-cr&gt;<span class="number">0</span>&amp;&amp;!valid(s.charAt(pr-cr), cnt)) cr++;</span><br><span class="line">            <span class="keyword">if</span>(cl==cr)&#123;</span><br><span class="line">                <span class="keyword">int</span>[] cnt1 = Arrays.copyOf(cnt, cnt.length);</span><br><span class="line">                <span class="keyword">int</span>[] cnt2 = Arrays.copyOf(cnt, cnt.length);</span><br><span class="line">                take(s.charAt(pl+cl), cnt1);</span><br><span class="line">                take(s.charAt(pr-cr), cnt2);</span><br><span class="line">                <span class="keyword">return</span> Math.min(pick(s, pl+cl+<span class="number">1</span>, r, cnt1), pick(s, l, pr-cr-<span class="number">1</span>, cnt2));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(cl&gt;cr)&#123;</span><br><span class="line">                <span class="keyword">int</span>[] cnt1 = Arrays.copyOf(cnt, cnt.length);</span><br><span class="line">                take(s.charAt(pr-cr), cnt1);</span><br><span class="line">                <span class="keyword">return</span> pick(s, l, pr-cr-<span class="number">1</span>, cnt1);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">int</span>[] cnt1 = Arrays.copyOf(cnt, cnt.length);</span><br><span class="line">                take(s.charAt(pl+cl), cnt1);</span><br><span class="line">                <span class="keyword">return</span> pick(s, pl+cl+<span class="number">1</span>, r, cnt1);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">return</span> s.length()-(r-l+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">valid</span><span class="params">(<span class="keyword">char</span> ch, <span class="keyword">int</span>[] cnt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>((ch==<span class="string">&#x27;a&#x27;</span>&amp;&amp;cnt[<span class="number">0</span>]&lt;k)||(ch==<span class="string">&#x27;b&#x27;</span>&amp;&amp;cnt[<span class="number">1</span>]&lt;k)||(ch==<span class="string">&#x27;c&#x27;</span>&amp;&amp;cnt[<span class="number">2</span>]&lt;k)) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">take</span><span class="params">(<span class="keyword">char</span> ch, <span class="keyword">int</span>[] cnt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(ch==<span class="string">&#x27;a&#x27;</span>) cnt[<span class="number">0</span>]++;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(ch==<span class="string">&#x27;b&#x27;</span>) cnt[<span class="number">1</span>]++;</span><br><span class="line">        <span class="keyword">else</span> cnt[<span class="number">2</span>]++;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ»‘åŠ¨çª—å£"><a href="#æ»‘åŠ¨çª—å£" class="headerlink" title="æ»‘åŠ¨çª—å£"></a>æ»‘åŠ¨çª—å£</h2><p>å¯ä»¥è¿™æ ·è€ƒè™‘ï¼Œå‡å¦‚ $s$ ä¸­æœ‰ 3 ä¸ª $\mathrm{a}, 4$ ä¸ª $\mathrm{b}, 5$ ä¸ª $\mathrm{c}, k=2$, æ¯ç§å­—æ¯è‡³å°‘å–èµ° 2 ä¸ª, ç­‰ä»·äºå‰©ä¸‹çš„å­—æ¯è‡³å¤šæœ‰ 1 ä¸ª $a, 2$ ä¸ª $b$ å’Œ 3 ä¸ª $c$ ã€‚</p><p>ç”±äºåªèƒ½ä» $s$ æœ€å·¦ä¾§å’Œæœ€å³ä¾§å–èµ°å­—æ¯, æ‰€ä»¥å‰©ä¸‹çš„å­—æ¯æ˜¯ $s$ çš„å­ä¸²ã€‚<br>è®¾ $s$ ä¸­çš„ $\mathrm{a}, \mathrm{b}, \mathrm{c}$ çš„ä¸ªæ•°åˆ†åˆ«ä¸º $x, y, z$, å¯ä»¥è½¬åŒ–é—®é¢˜ä¸º:</p><ul><li>è®¡ç®— $s$ çš„æœ€é•¿å­ä¸²é•¿åº¦, è¯¥å­ä¸²æ»¡è¶³ $\mathrm{a}, \mathrm{b}, \mathrm{c}$ çš„ä¸ªæ•°åˆ†åˆ«è‡³å¤šä¸º $x-k, y-k, z-k$ ã€‚</li></ul><p>ç”±äºå­ä¸²è¶ŠçŸ­è¶Šèƒ½æ»¡è¶³è¦æ±‚, è¶Šé•¿è¶Šä¸èƒ½æ»¡è¶³è¦æ±‚, <strong>æœ‰å•è°ƒæ€§, å¯ä»¥ç”¨æ»‘åŠ¨çª—å£è§£å†³</strong>ã€‚</p><p>åœ¨å®ç°ä¸Šï¼Œä¸å…¶ç»´æŠ¤çª—å£å†…çš„å­—æ¯ä¸ªæ•°, ä¸å¦‚ç›´æ¥ç»´æŠ¤çª—å£å¤–çš„å­—æ¯ä¸ªæ•°, è¿™ä¹Ÿæ˜¯æˆ‘ä»¬å–èµ°çš„å­—æ¯ä¸ªæ•°ã€‚</p><ul><li>ä¸€å¼€å§‹, å‡è®¾æˆ‘ä»¬å–èµ°äº†æ‰€æœ‰çš„å­—æ¯ã€‚æˆ–è€…è¯´, åˆå§‹çª—å£æ˜¯ç©ºçš„, çª—å£å¤–çš„å­—æ¯ä¸ªæ•°å°±æ˜¯ $s$ çš„æ¯ä¸ªå­—æ¯çš„å‡ºç°æ¬¡æ•°ã€‚</li><li>çª—å£ä»å·¦å‘å³æ»‘åŠ¨ï¼Œå³ç«¯ç‚¹å­—æ¯è¿›å…¥çª—å£å, è¯¥å­—æ¯å–èµ°çš„ä¸ªæ•°å‡ä¸€ã€‚</li><li>å¦‚æœå‡ä¸€å, çª—å£å¤–è¯¥å­—æ¯çš„ä¸ªæ•°å°äº $k$, è¯´æ˜å­ä¸²å¤ªé•¿äº†, æˆ–è€…å–èµ°çš„å­—æ¯ä¸ªæ•°å¤ªå°‘äº†,é‚£ä¹ˆå°±ä¸æ–­å³ç§»å·¦ç«¯ç‚¹, æŠŠå·¦ç«¯ç‚¹å­—æ¯ç§»å‡ºçª—å£, ç›¸å½“äºæˆ‘ä»¬å–èµ°ç§»å‡ºçª—å£çš„å­—æ¯, ç›´åˆ°è¯¥å­—æ¯ä¸ªæ•°ç­‰äº $k$, é€€å‡ºå†…å±‚å¾ªç¯ã€‚</li><li>å†…å±‚å¾ªç¯ç»“æŸå, ç”¨çª—å£é•¿åº¦ right - left +1 æ›´æ–°å­ä¸²é•¿åº¦çš„æœ€å¤§å€¼ã€‚</li></ul><p>æœ€å, åŸé—®é¢˜çš„ç­”æ¡ˆä¸º $n$ å‡å»å­ä¸²é•¿åº¦çš„æœ€å¤§å€¼ã€‚ç‰¹åˆ«åœ°, å¦‚æœ $s$ ä¸­æŸä¸ªå­—æ¯çš„ä¸ªæ•°ä¸è¶³ $k$, é‚£ä¹ˆæ— æ³•æ»¡è¶³é¢˜ç›®è¦æ±‚, è¿”å› -1 ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">takeCharacters</span><span class="params">(String S, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span>[] s = S.toCharArray();</span><br><span class="line">        <span class="keyword">int</span>[] cnt = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c : s) &#123;</span><br><span class="line">            cnt[c - <span class="string">&#x27;a&#x27;</span>]++; <span class="comment">// ä¸€å¼€å§‹ï¼ŒæŠŠæ‰€æœ‰å­—æ¯éƒ½å–èµ°</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cnt[<span class="number">0</span>] &lt; k || cnt[<span class="number">1</span>] &lt; k || cnt[<span class="number">2</span>] &lt; k) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>; <span class="comment">// å­—æ¯ä¸ªæ•°ä¸è¶³ k</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> mx = <span class="number">0</span>; <span class="comment">// å­ä¸²æœ€å¤§é•¿åº¦</span></span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> right = <span class="number">0</span>; right &lt; s.length; right++) &#123;</span><br><span class="line">            <span class="keyword">int</span> c = s[right] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">            cnt[c]--; <span class="comment">// ç§»å…¥çª—å£ï¼Œç›¸å½“äºä¸å–èµ° c</span></span><br><span class="line">            <span class="keyword">while</span> (cnt[c] &lt; k) &#123; <span class="comment">// çª—å£ä¹‹å¤–çš„ c ä¸è¶³ k</span></span><br><span class="line">                cnt[s[left] - <span class="string">&#x27;a&#x27;</span>]++; <span class="comment">// ç§»å‡ºçª—å£ï¼Œç›¸å½“äºå–èµ° s[left]</span></span><br><span class="line">                left++;</span><br><span class="line">            &#125;</span><br><span class="line">            mx = Math.max(mx, right - left + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s.length - mx;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Booking-Concert-Tickets-in-Groups"><a href="#Booking-Concert-Tickets-in-Groups" class="headerlink" title="Booking Concert Tickets in Groups"></a><a href="https://leetcode.cn/problems/booking-concert-tickets-in-groups/description">Booking Concert Tickets in Groups</a></h1><p>é¢˜ç›®å¤ªé•¿å°±ä¸ç²˜äº†ï¼Œç®€å•æ¥è¯´å°±æ˜¯å®ç°ä¸€ä¸ªæ¼”å”±ä¼šè´­ç¥¨ç±»ï¼Œå¯ä»¥å®ç°è¿åº§å’Œæ•£åº§è®¢ç¥¨ã€‚</p><p>æŒ‰ç…§é¢˜ç›®åŸæ„å†™å‡ºåŸºç¡€è§£æ³•å¹¶ä¸éš¾ï¼Œåªæ˜¯ä¼šOOMã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookMyShow</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ç”¨æœ€åä¸€ä¸ªå…ƒç´ è®°å½•å‰©ä½™å®¹é‡, å‰©ä½™çš„0è¡¨ç¤ºç©ºåº§</span></span><br><span class="line">    <span class="keyword">int</span>[][] hall; </span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">int</span> m;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BookMyShow</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">        hall = <span class="keyword">new</span> <span class="keyword">int</span>[n][m+<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">this</span>.n = n;</span><br><span class="line">        <span class="keyword">this</span>.m = m;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) hall[i][m] = m;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">view</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span>[] r:hall) System.out.println(Arrays.toString(r));</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] gather(<span class="keyword">int</span> k, <span class="keyword">int</span> maxRow) &#123;</span><br><span class="line">        <span class="keyword">if</span>(preBook(k, maxRow, <span class="keyword">false</span>)) <span class="keyword">return</span> book(k, maxRow, <span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">scatter</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> maxRow)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preBook(k, maxRow, <span class="keyword">true</span>))&#123;</span><br><span class="line">            book(k, maxRow, <span class="keyword">true</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">preBook</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> maxRow, <span class="keyword">boolean</span> isScatter)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(isScatter)&#123;</span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=maxRow;i++)&#123;</span><br><span class="line">                cnt+=hall[i][m];</span><br><span class="line">                <span class="keyword">if</span>(cnt&gt;=k) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=maxRow;i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(hall[i][m]&gt;=k) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] book(<span class="keyword">int</span> k, <span class="keyword">int</span> maxRow, <span class="keyword">boolean</span> isScatter)&#123;</span><br><span class="line">        <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</span><br><span class="line">        Arrays.fill(res, -<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> toDo = k;</span><br><span class="line">        <span class="keyword">if</span>(isScatter)&#123;</span><br><span class="line">            <span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(toDo&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(hall[p][m]==<span class="number">0</span>)&#123;</span><br><span class="line">                    p++;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(hall[p][m]&gt;=toDo)&#123;</span><br><span class="line">                    doBook(p, m-hall[p][m], m-hall[p][m]+toDo);</span><br><span class="line">                    toDo = <span class="number">0</span>;</span><br><span class="line">                &#125; </span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    toDo-=hall[p][m];</span><br><span class="line">                    doBook(p, m-hall[p][m], m);</span><br><span class="line">                &#125;</span><br><span class="line">                p++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=maxRow;i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(hall[i][m]&gt;=toDo)&#123;</span><br><span class="line">                    res[<span class="number">0</span>] = i;</span><br><span class="line">                    res[<span class="number">1</span>] = m-hall[i][m];</span><br><span class="line">                    doBook(i, m-hall[i][m], m-hall[i][m]+toDo);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doBook</span><span class="params">(<span class="keyword">int</span> row, <span class="keyword">int</span> s, <span class="keyword">int</span> e)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=s;i&lt;e;i++) hall[row][i] = <span class="number">1</span>;</span><br><span class="line">        hall[row][m]-=(e-s);</span><br><span class="line">        <span class="comment">// view();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="çº¿æ®µæ ‘"><a href="#çº¿æ®µæ ‘" class="headerlink" title="çº¿æ®µæ ‘"></a>çº¿æ®µæ ‘</h2><p>å°†æ¯ä¸€æ’åº§ä½çœ‹æˆä¸€ä¸ªæ•´ä½“ï¼Œå¯å°†ä¸¤ç§æ“ä½œæ€»ç»“å¦‚ä¸‹ï¼š</p><ul><li>gatherï¼šåœ¨å‰ maxRow æ’ä¸­ï¼Œæ‰¾ç¬¬ä¸€ä¸ªè¿˜èƒ½è‡³å°‘æœ‰ k ä¸ªç©ºåº§ä½çš„æ’ï¼Œé¢„å®š k ä¸ªè¿ç»­çš„åº§ä½ã€‚å¦‚æœæœ‰è¿™æ ·çš„æ’ï¼Œè¿”å›ç¼–å·ï¼Œä»¥åŠåœ¨é¢„å®šå‰æœ‰å¤šå°‘éç©ºåº§ä½ï¼›å¦‚æœæ²¡æœ‰è¿™æ ·çš„æ’ï¼Œè¿”å›ç©ºåˆ—è¡¨ã€‚</li><li>scatterï¼šåœ¨å‰ maxRow ä¸ªæ’ä¸­é¢„å®šæ€»é‡ä¸º k çš„åº§ä½ã€‚ä»å·¦åˆ°å³é€‰æ‹©æœ‰ç©ºåº§ä½çš„æ’ä¾æ¬¡å åº§ã€‚å¦‚æœæ— æ³•é¢„å®šæ€»é‡ä¸º k çš„åº§ä½ï¼Œåˆ™ä¸æ‰§è¡Œæ“ä½œï¼Œå¹¶è¿”å› falseï¼›å¦åˆ™æ‰§è¡Œæ“ä½œï¼Œå¹¶è¿”å› trueã€‚</li></ul><p>æ­¤æ—¶å°†åŸé—®é¢˜å‹ç¼©ä¸ºä¸€ç»´æ•°ç»„ï¼Œèƒ½è¿™æ ·åšçš„åŸå› æ˜¯ä¸¤ç§æ“ä½œå‡ä¸ä¼šäº§ç”Ÿâ€œé—´éš”çš„ç©ºåº§ä½â€ã€‚å› æ­¤éœ€è¦çš„æ“ä½œå¦‚ä¸‹ï¼š</p><ul><li>æ±‚å‡ºå‰ maxRow æ’ä¸­ï¼Œç¬¬ä¸€ä¸ªå‰©ä½™å®¹é‡ â‰¥kï¼Œä¹Ÿå°±æ˜¯å·²é¢„å®šé‡ â‰¤ mâˆ’k çš„æ’ã€‚</li><li>ç»´æŠ¤æ¯æ’çš„å·²é¢„å®šé‡ã€‚</li><li>ç»´æŠ¤å‰ maxRow æ’çš„å·²é¢„å®šé‡ä¹‹å’Œï¼Œä»è€Œåˆ¤æ–­ scatter èƒ½å¦å®ç°ã€‚</li></ul><p>å¯ä»¥ç”¨çº¿æ®µæ ‘å¤„ç†ä¸Šè¿°æ“ä½œï¼Œçº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸ªåŒºé—´ï¼ˆåŒºé—´å³æŸå‡ æ’ï¼‰å·²é¢„å®šé‡çš„æœ€å°å€¼ $\min$ ï¼Œä»¥åŠæ¯ä¸ªåŒºé—´çš„å·²é¢„å®šé‡ä¹‹å’Œ $sum$ã€‚</p><p>å¯¹äº gatherï¼Œä»çº¿æ®µæ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹é€’å½’ï¼š</p><ul><li>å¦‚æœå½“å‰åŒºé—´ $\min &gt; m-k$, åˆ™æ— æ³•é¢„å®š $k$ ä¸ªè¿ç»­åº§ä½ï¼Œè¿”å› 0 ã€‚</li><li>å¦‚æœå½“å‰åŒºé—´é•¿åº¦ä¸º 1 ï¼Œè¿”å›åŒºé—´ç«¯ç‚¹ã€‚</li><li>å¦‚æœå·¦åŠåŒºé—´ $\min \leq m-k$, åˆ™ç­”æ¡ˆåœ¨å·¦åŠåŒºé—´ä¸­, é€’å½’å·¦åŠåŒºé—´ã€‚</li><li>å¦åˆ™å¦‚æœ maxRow åœ¨å³åŠåŒºé—´å†…, é€’å½’å³åŠåŒºé—´ã€‚</li><li>å¦åˆ™è¿”å› -1 ï¼Œè¡¨ç¤ºæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æ’ã€‚</li></ul><p>ä¸Šè¿°è¿‡ç¨‹å«åš<strong>çº¿æ®µæ ‘äºŒåˆ†</strong>ï¼Œ</p><p>å¯¹äº scatterï¼Œå¦‚æœåŒºé—´ $[0$, maxRow] çš„å·²é¢„å®šé‡ä¹‹å’Œå¤§äº $m \cdot(\operatorname{maxRow}+1)-k$ ï¼Œåˆ™æ— æ³•æ‰§è¡Œæ“ä½œã€‚å¦åˆ™å¯ä»¥æ‰§è¡Œæ“ä½œã€‚ä»ç¬¬ä¸€ä¸ªæ²¡æœ‰è£…æ»¡ï¼Œä¹Ÿå°±æ˜¯å·²é¢„å®šé‡ $\leq m-1$ çš„æ’å¼€å§‹é¢„å®šï¼Œè¿™ä¹Ÿå¯ä»¥ç”¨çº¿æ®µæ ‘äºŒåˆ†æ±‚å‡ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookMyShow</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> m;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] min;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span>[] sum;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BookMyShow</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.n = n;</span><br><span class="line">        <span class="keyword">this</span>.m = m;</span><br><span class="line">        <span class="keyword">int</span> size = <span class="number">2</span> &lt;&lt; (<span class="number">32</span> - Integer.numberOfLeadingZeros(n)); <span class="comment">// æ¯” 4n æ›´å°</span></span><br><span class="line">        min = <span class="keyword">new</span> <span class="keyword">int</span>[size];</span><br><span class="line">        sum = <span class="keyword">new</span> <span class="keyword">long</span>[size];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] gather(<span class="keyword">int</span> k, <span class="keyword">int</span> maxRow) &#123;</span><br><span class="line">        <span class="comment">// æ‰¾ç¬¬ä¸€ä¸ªèƒ½é¢„å®š k ä¸ªåº§ä½çš„row</span></span><br><span class="line">        <span class="keyword">int</span> r = findFirst(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, maxRow, m - k);</span><br><span class="line">        <span class="keyword">if</span> (r &lt; <span class="number">0</span>) &#123; <span class="comment">// æ²¡æœ‰è¿™æ ·çš„row</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> c = (<span class="keyword">int</span>) querySum(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, r, r);</span><br><span class="line">        update(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, r, k); <span class="comment">// é¢„å®š</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;r, c&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">scatter</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> maxRow)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// [0,maxRow] çš„å·²é¢„å®šé‡ä¹‹å’Œ</span></span><br><span class="line">        <span class="keyword">long</span> s = querySum(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, <span class="number">0</span>, maxRow);</span><br><span class="line">        <span class="keyword">if</span> (s &gt; (<span class="keyword">long</span>) m * (maxRow + <span class="number">1</span>) - k) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>; <span class="comment">// ç©ºåº§ä½ä¸è¶³</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä»ç¬¬ä¸€ä¸ªæ²¡æœ‰å®šæ»¡çš„rowå¼€å§‹</span></span><br><span class="line">        <span class="keyword">int</span> i = findFirst(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, maxRow, m - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span> (k &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> left = Math.min(m - (<span class="keyword">int</span>) querySum(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, i, i), k);</span><br><span class="line">            update(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, i, left); <span class="comment">// é¢„å®š</span></span><br><span class="line">            k -= left;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŠŠä¸‹æ ‡ i ä¸Šçš„å…ƒç´ å€¼å¢åŠ  val</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> o, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> i, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">            min[o] += val;</span><br><span class="line">            sum[o] += val;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> m = (l + r) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &lt;= m) &#123;</span><br><span class="line">            update(o * <span class="number">2</span>, l, m, i, val);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            update(o * <span class="number">2</span> + <span class="number">1</span>, m + <span class="number">1</span>, r, i, val);</span><br><span class="line">        &#125;</span><br><span class="line">        min[o] = Math.min(min[o * <span class="number">2</span>], min[o * <span class="number">2</span> + <span class="number">1</span>]);</span><br><span class="line">        sum[o] = sum[o * <span class="number">2</span>] + sum[o * <span class="number">2</span> + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å›åŒºé—´ [L,R] å†…çš„å…ƒç´ å’Œ</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">querySum</span><span class="params">(<span class="keyword">int</span> o, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class="line">            <span class="keyword">return</span> sum[o];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> m = (l + r) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (L &lt;= m) &#123;</span><br><span class="line">            res = querySum(o * <span class="number">2</span>, l, m, L, R);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (R &gt; m) &#123;</span><br><span class="line">            res += querySum(o * <span class="number">2</span> + <span class="number">1</span>, m + <span class="number">1</span>, r, L, R);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å›åŒºé—´ [0,R] ä¸­ &lt;= val çš„æœ€é å·¦çš„ä½ç½®ï¼Œä¸å­˜åœ¨æ—¶è¿”å› -1</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">findFirst</span><span class="params">(<span class="keyword">int</span> o, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> R, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (min[o] &gt; val) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>; <span class="comment">// æ•´ä¸ªåŒºé—´çš„å…ƒç´ å€¼éƒ½å¤§äº val</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">            <span class="keyword">return</span> l;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> m = (l + r) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (min[o * <span class="number">2</span>] &lt;= val) &#123;</span><br><span class="line">            <span class="keyword">return</span> findFirst(o * <span class="number">2</span>, l, m, R, val);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (R &gt; m) &#123;</span><br><span class="line">            <span class="keyword">return</span> findFirst(o * <span class="number">2</span> + <span class="number">1</span>, m + <span class="number">1</span>, r, R, val);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://leetcode.cn/problems/booking-concert-tickets-in-groups/solutions/1523876/by-endlesscheng-okcu/?envType=daily-question&amp;envId=2024-09-28">https://leetcode.cn/problems/booking-concert-tickets-in-groups/solutions/1523876/by-endlesscheng-okcu/?envType=daily-question&amp;envId=2024-09-28</a><br>[2] <a href="https://leetcode.cn/problems/take-k-of-each-character-from-left-and-right/solutions/2031995/on-shuang-zhi-zhen-by-endlesscheng-4g9p/?envType=daily-question&amp;envId=2024-09-27">https://leetcode.cn/problems/take-k-of-each-character-from-left-and-right/solutions/2031995/on-shuang-zhi-zhen-by-endlesscheng-4g9p/?envType=daily-question&amp;envId=2024-09-27</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;é¢çš„æœ‰ç‚¹éº»äº†ï¼Œåšé¢˜åè€Œæœ‰æ„æ€ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨ä¸»é¢˜ï¼šä¼˜åŒ–éå†ã€æ»‘åŠ¨çª—å£ã€çº¿æ®µæ ‘ã€é›†åˆ&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;240923æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/best-sightseeing-pair/description&quot;&gt;Best Sightseeing Pair&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240925æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/naming-a-company/description&quot;&gt;Naming a Company&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240927æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/take-k-of-each-character-from-left-and-right/description&quot;&gt;Take K of Each Character From Left and Right&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240928æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/booking-concert-tickets-in-groups/description&quot;&gt;Booking Concert Tickets in Groups&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    
    <category term="LeetCode" scheme="http://silencezheng.top/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>çº¿æ®µæ ‘</title>
    <link href="http://silencezheng.top/2024/10/05/article143/"/>
    <id>http://silencezheng.top/2024/10/05/article143/</id>
    <published>2024-10-04T17:55:12.000Z</published>
    <updated>2024-10-04T17:57:07.824Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>çº¿æ®µæ ‘æ˜¯ç®—æ³•ç«èµ›ä¸­å¸¸ç”¨çš„ç”¨æ¥ç»´æŠ¤â€œåŒºé—´ä¿¡æ¯â€çš„æ•°æ®ç»“æ„ã€‚çº¿æ®µæ ‘å¯ä»¥åœ¨ $O(\log N)$ çš„æ—¶é—´å¤æ‚åº¦å†…å®ç°å•ç‚¹ä¿®æ”¹ã€åŒºé—´ä¿®æ”¹ã€åŒºé—´æŸ¥è¯¢ï¼ˆåŒºé—´æ±‚å’Œï¼Œæ±‚åŒºé—´æœ€å¤§å€¼ï¼Œæ±‚åŒºé—´æœ€å°å€¼ï¼‰ç­‰æ“ä½œã€‚</p><span id="more"></span><h1 id="çº¿æ®µæ ‘ï¼ˆSegment-Treeï¼‰"><a href="#çº¿æ®µæ ‘ï¼ˆSegment-Treeï¼‰" class="headerlink" title="çº¿æ®µæ ‘ï¼ˆSegment Treeï¼‰"></a>çº¿æ®µæ ‘ï¼ˆSegment Treeï¼‰</h1><p>çº¿æ®µæ ‘å°†æ¯ä¸ªé•¿åº¦ä¸ä¸º$1$çš„åŒºé—´åˆ’åˆ†æˆå·¦å³ä¸¤ä¸ªåŒºé—´é€’å½’æ±‚è§£ï¼ŒæŠŠæ•´ä¸ªçº¿æ®µåˆ’åˆ†ä¸ºä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œé€šè¿‡åˆå¹¶å·¦å³ä¸¤åŒºé—´ä¿¡æ¯æ¥æ±‚å¾—è¯¥åŒºé—´çš„ä¿¡æ¯ã€‚è¿™ç§æ•°æ®ç»“æ„å¯ä»¥æ–¹ä¾¿çš„è¿›è¡Œå¤§éƒ¨åˆ†çš„åŒºé—´æ“ä½œã€‚</p><h2 id="åŸºæœ¬ç»“æ„"><a href="#åŸºæœ¬ç»“æ„" class="headerlink" title="åŸºæœ¬ç»“æ„"></a>åŸºæœ¬ç»“æ„</h2><p>æœ‰ä¸ªå¤§å°ä¸º$5$çš„æ•°ç»„ a={10,11,12,13,14}ï¼Œè¦å°†å…¶è½¬åŒ–ä¸ºçº¿æ®µæ ‘ï¼Œæœ‰ä»¥ä¸‹åšæ³•ï¼šè®¾çº¿æ®µæ ‘çš„æ ¹èŠ‚ç‚¹ç¼–å·ä¸º$1$ï¼Œç”¨æ•°ç»„ $d$ æ¥ä¿å­˜æˆ‘ä»¬çš„çº¿æ®µæ ‘ï¼Œ$d_i$ ç”¨æ¥ä¿å­˜çº¿æ®µæ ‘ä¸Šç¼–å·ä¸º $i$ çš„èŠ‚ç‚¹çš„å€¼ï¼ˆè¿™é‡Œæ¯ä¸ªèŠ‚ç‚¹æ‰€ç»´æŠ¤çš„å€¼å°±æ˜¯è¿™ä¸ªèŠ‚ç‚¹æ‰€è¡¨ç¤ºçš„åŒºé—´æ€»å’Œï¼‰ã€‚è¿™æ£µçº¿æ®µæ ‘çš„å½¢æ€å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/assets/post_img/article143/segt1.svg" alt="segt1"></p><p>å›¾ä¸­æ¯ä¸ªèŠ‚ç‚¹ä¸­ç”¨çº¢è‰²å­—ä½“æ ‡æ˜çš„åŒºé—´ï¼Œè¡¨ç¤ºè¯¥èŠ‚ç‚¹ç®¡è¾–çš„ $a$ æ•°ç»„ä¸Šçš„ä½ç½®åŒºé—´ã€‚å¦‚ $d_1$ æ‰€ç®¡è¾–çš„åŒºé—´å°±æ˜¯ $[1,5]$ï¼ˆ$a_1,a_2, \cdots ,a_5$ï¼‰ï¼Œå³ $d_1$ æ‰€ä¿å­˜çš„å€¼æ˜¯ $a_1+a_2+ \cdots +a_5$ï¼Œ$d_1=60$ è¡¨ç¤ºçš„æ˜¯ $a_1+a_2+ \cdots +a_5=60$ã€‚</p><p>é€šè¿‡è§‚å¯Ÿä¸éš¾å‘ç°ï¼Œ$d_i$ çš„å·¦å„¿å­èŠ‚ç‚¹å°±æ˜¯ $d_{2\times i}$ï¼Œ$d_i$ çš„å³å„¿å­èŠ‚ç‚¹å°±æ˜¯ $d_{2\times i+1}$ã€‚å¦‚æœ $d_i$ è¡¨ç¤ºçš„æ˜¯åŒºé—´ $[s,t]$ï¼ˆå³ $d_i=a_s+a_{s+1}+ \cdots +a_t$ï¼‰çš„è¯ï¼Œé‚£ä¹ˆ $d_i$ çš„å·¦å„¿å­èŠ‚ç‚¹è¡¨ç¤ºçš„æ˜¯åŒºé—´ $[ s, \frac{s+t}{2} ]$ï¼Œ$d_i$ çš„å³å„¿å­è¡¨ç¤ºçš„æ˜¯åŒºé—´ $[ \frac{s+t}{2} +1,t ]$ã€‚</p><h2 id="å»ºæ ‘è¿‡ç¨‹"><a href="#å»ºæ ‘è¿‡ç¨‹" class="headerlink" title="å»ºæ ‘è¿‡ç¨‹"></a>å»ºæ ‘è¿‡ç¨‹</h2><p>å¯ä»¥ä½¿ç”¨é€’å½’å»ºæ ‘ï¼Œè®¾å½“å‰çš„æ ¹èŠ‚ç‚¹ä¸º $p$ï¼Œå¦‚æœæ ¹èŠ‚ç‚¹ç®¡è¾–çš„åŒºé—´é•¿åº¦å·²ç»æ˜¯ $1$ï¼Œåˆ™å¯ä»¥ç›´æ¥æ ¹æ® $a$ æ•°ç»„ä¸Šç›¸åº”ä½ç½®çš„å€¼åˆå§‹åŒ–è¯¥èŠ‚ç‚¹ã€‚å¦åˆ™æˆ‘ä»¬å°†è¯¥åŒºé—´ä»ä¸­ç‚¹å¤„åˆ†å‰²ä¸ºä¸¤ä¸ªå­åŒºé—´ï¼Œåˆ†åˆ«è¿›å…¥å·¦å³å­èŠ‚ç‚¹é€’å½’å»ºæ ‘ï¼Œæœ€ååˆå¹¶ä¸¤ä¸ªå­èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚</p><p>é‡‡ç”¨æ•°ç»„å †å¼å­˜å‚¨ï¼ˆ$2p$ æ˜¯ $p$ çš„å·¦å„¿å­ï¼Œ$2p+1$ æ˜¯ $p$ çš„å³å„¿å­ï¼‰ï¼Œè‹¥æœ‰ $n$ ä¸ªå¶å­ç»“ç‚¹ï¼Œåˆ™æ•°ç»„çš„èŒƒå›´æœ€å¤§ä¸º $2^{\left\lceil\log{n}\right\rceil+1}$ã€‚</p><p>åˆ†æï¼šå®¹æ˜“çŸ¥é“çº¿æ®µæ ‘çš„æ·±åº¦æ˜¯ $\left\lceil\log{n}\right\rceil$ çš„ï¼Œåˆ™åœ¨å †å¼å‚¨å­˜æƒ…å†µä¸‹å¶å­èŠ‚ç‚¹ï¼ˆåŒ…æ‹¬æ— ç”¨çš„å¶å­èŠ‚ç‚¹ï¼‰æ•°é‡ä¸º $2^{\left\lceil\log{n}\right\rceil}$ ä¸ªï¼Œåˆç”±äºå…¶ä¸ºä¸€æ£µå®Œå…¨äºŒå‰æ ‘ï¼Œåˆ™å…¶æ€»èŠ‚ç‚¹ä¸ªæ•° $2^{\left\lceil\log{n}\right\rceil+1}-1$ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥æŠŠæ•°ç»„é•¿åº¦è®¾ä¸º $4n$ï¼Œå› ä¸º $\frac{2^{\left\lceil\log{n}\right\rceil+1}-1}{n}$ çš„æœ€å¤§å€¼åœ¨ $n=2^{x}+1(x\in N_{+})$ æ—¶å–åˆ°ï¼Œæ­¤æ—¶èŠ‚ç‚¹æ•°ä¸º $2^{\left\lceil\log{n}\right\rceil+1}-1=2^{x+2}-1=4n-5$ã€‚</p><h2 id="åŒºé—´æŸ¥è¯¢"><a href="#åŒºé—´æŸ¥è¯¢" class="headerlink" title="åŒºé—´æŸ¥è¯¢"></a>åŒºé—´æŸ¥è¯¢</h2><p>ä»ç„¶ä»¥æœ€å¼€å§‹çš„å›¾ä¸ºä¾‹ï¼Œå¦‚æœè¦æŸ¥è¯¢åŒºé—´ $[1,5]$ çš„å’Œï¼Œé‚£ç›´æ¥è·å– $d_1$ çš„å€¼å³å¯ã€‚</p><p>å¦‚æœè¦æŸ¥è¯¢çš„åŒºé—´ä¸º $[3,5]$ï¼Œæ­¤æ—¶å°±ä¸èƒ½ç›´æ¥è·å–åŒºé—´çš„å€¼ï¼Œä½†æ˜¯ $[3,5]$ å¯ä»¥æ‹†æˆ $[3,3]$ å’Œ $[4,5]$ï¼Œå¯ä»¥é€šè¿‡åˆå¹¶è¿™ä¸¤ä¸ªåŒºé—´çš„ç­”æ¡ˆæ¥æ±‚å¾—è¿™ä¸ªåŒºé—´çš„ç­”æ¡ˆã€‚</p><p>ä¸€èˆ¬åœ°ï¼Œå¦‚æœè¦æŸ¥è¯¢çš„åŒºé—´æ˜¯ $[l,r]$ï¼Œåˆ™å¯ä»¥å°†å…¶æ‹†æˆæœ€å¤šä¸º $O(\log n)$ ä¸ªâ€œæå¤§â€çš„åŒºé—´ï¼Œåˆå¹¶è¿™äº›åŒºé—´å³å¯æ±‚å‡º $[l,r]$ çš„ç­”æ¡ˆã€‚</p><h2 id="åŒºé—´ä¿®æ”¹ä¸æ‡’æƒ°æ ‡è®°"><a href="#åŒºé—´ä¿®æ”¹ä¸æ‡’æƒ°æ ‡è®°" class="headerlink" title="åŒºé—´ä¿®æ”¹ä¸æ‡’æƒ°æ ‡è®°"></a>åŒºé—´ä¿®æ”¹ä¸æ‡’æƒ°æ ‡è®°</h2><p>å¦‚æœè¦æ±‚ä¿®æ”¹åŒºé—´ $[l,r]$ï¼ŒæŠŠæ‰€æœ‰åŒ…å«åœ¨åŒºé—´ $[l,r]$ ä¸­çš„èŠ‚ç‚¹éƒ½éå†ä¸€æ¬¡ã€ä¿®æ”¹ä¸€æ¬¡ï¼Œæ—¶é—´å¤æ‚åº¦æ— æ³•æ‰¿å—ã€‚æˆ‘ä»¬è¿™é‡Œè¦å¼•å…¥ä¸€ä¸ªå«åš ã€Œæ‡’æƒ°æ ‡è®°ã€ çš„ä¸œè¥¿ã€‚</p><p>æ‡’æƒ°æ ‡è®°ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯é€šè¿‡å»¶è¿Ÿå¯¹èŠ‚ç‚¹ä¿¡æ¯çš„æ›´æ”¹ï¼Œä»è€Œå‡å°‘å¯èƒ½ä¸å¿…è¦çš„æ“ä½œæ¬¡æ•°ã€‚æ¯æ¬¡æ‰§è¡Œä¿®æ”¹æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡æ‰“æ ‡è®°çš„æ–¹æ³•è¡¨æ˜è¯¥èŠ‚ç‚¹å¯¹åº”çš„åŒºé—´åœ¨æŸä¸€æ¬¡æ“ä½œä¸­è¢«æ›´æ”¹ï¼Œä½†ä¸æ›´æ–°è¯¥èŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚å®è´¨æ€§çš„ä¿®æ”¹åˆ™åœ¨ä¸‹ä¸€æ¬¡è®¿é—®å¸¦æœ‰æ ‡è®°çš„èŠ‚ç‚¹æ—¶æ‰è¿›è¡Œã€‚</p><h2 id="Javaçº¿æ®µæ ‘æ¨¡ç‰ˆï¼ˆ4nå†…å­˜ï¼‰"><a href="#Javaçº¿æ®µæ ‘æ¨¡ç‰ˆï¼ˆ4nå†…å­˜ï¼‰" class="headerlink" title="Javaçº¿æ®µæ ‘æ¨¡ç‰ˆï¼ˆ4nå†…å­˜ï¼‰"></a>Javaçº¿æ®µæ ‘æ¨¡ç‰ˆï¼ˆ4nå†…å­˜ï¼‰</h2><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒJavaçš„æ³›å‹ç”±äºå­˜åœ¨æ“¦é™¤ï¼Œå› æ­¤åœ¨ç¼–è¯‘åå®é™…ä¸Šå¹¶ä¸èƒ½æ‹¿åˆ°ç±»å‹ä¿¡æ¯ï¼Œæ‰€æœ‰çš„ç±»å‹éƒ½æ˜¯åŸºç±»ï¼Œå¯¼è‡´ä¸èƒ½å®ç°ç®—æ•°è¿ç®—ï¼Œåœ¨é™å®š<code>Number</code>çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨<code>double</code>å€¼è®¡ç®—ç»“æœï¼Œéœ€è¦åœ¨å¤–éƒ¨è°ƒç”¨åè¿›è¡Œç±»å‹è½¬æ¢ã€‚</p><p>å¯ä»¥åŒºé—´åŠ /æ±‚å’Œçš„çº¿æ®µæ ‘æ¨¡æ¿ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SegTreeLazyRangeAdd</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Number</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] tree; <span class="comment">// ä½¿ç”¨ double æ•°ç»„æ¥å­˜å‚¨æ ‘èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] lazy; <span class="comment">// æ‡’æƒ°æ ‡è®°æ•°ç»„</span></span><br><span class="line">    <span class="keyword">private</span> T[] arr; <span class="comment">// åŸå§‹æ•°ç»„</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> n, root, n4, end;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SegTreeLazyRangeAdd</span><span class="params">(T[] v)</span> </span>&#123;</span><br><span class="line">        n = v.length;</span><br><span class="line">        n4 = n * <span class="number">4</span>;</span><br><span class="line">        tree = <span class="keyword">new</span> <span class="keyword">double</span>[n4];</span><br><span class="line">        lazy = <span class="keyword">new</span> <span class="keyword">double</span>[n4];</span><br><span class="line">        arr = v;</span><br><span class="line">        Arrays.fill(tree, <span class="number">0</span>);</span><br><span class="line">        Arrays.fill(lazy, <span class="number">0</span>);</span><br><span class="line">        end = n - <span class="number">1</span>;</span><br><span class="line">        root = <span class="number">1</span>;</span><br><span class="line">        build(<span class="number">0</span>, end, <span class="number">1</span>);</span><br><span class="line">        arr = <span class="keyword">null</span>; <span class="comment">// Clear reference to the original array</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">maintain</span><span class="params">(<span class="keyword">int</span> cl, <span class="keyword">int</span> cr, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cm = cl + (cr - cl) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (cl != cr &amp;&amp; lazy[p] != <span class="number">0</span>) &#123;</span><br><span class="line">            lazy[p * <span class="number">2</span>] += lazy[p]; <span class="comment">// æ›´æ–°å·¦å­æ ‘çš„æ‡’æƒ°æ ‡è®°</span></span><br><span class="line">            lazy[p * <span class="number">2</span> + <span class="number">1</span>] += lazy[p]; <span class="comment">// æ›´æ–°å³å­æ ‘çš„æ‡’æƒ°æ ‡è®°</span></span><br><span class="line">            tree[p * <span class="number">2</span>] += lazy[p] * (cm - cl + <span class="number">1</span>); <span class="comment">// æ›´æ–°å·¦å­æ ‘çš„å€¼</span></span><br><span class="line">            tree[p * <span class="number">2</span> + <span class="number">1</span>] += lazy[p] * (cr - cm); <span class="comment">// æ›´æ–°å³å­æ ‘çš„å€¼</span></span><br><span class="line">            lazy[p] = <span class="number">0</span>; <span class="comment">// é‡ç½®å½“å‰èŠ‚ç‚¹çš„æ‡’æƒ°æ ‡è®°</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">rangeSum</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> cl, <span class="keyword">int</span> cr, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r) <span class="keyword">return</span> tree[p]; <span class="comment">// å½“å‰å­åŒºé—´è¢«æŸ¥è¯¢åŒºé—´å®Œå…¨è¦†ç›–</span></span><br><span class="line">        <span class="keyword">int</span> m = cl + (cr - cl) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">double</span> sum = <span class="number">0</span>; <span class="comment">// ä½¿ç”¨ double ç±»å‹è¿›è¡Œæ±‚å’Œ</span></span><br><span class="line">        maintain(cl, cr, p); <span class="comment">// ç»´æŠ¤å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (l &lt;= m) sum += rangeSum(l, r, cl, m, p * <span class="number">2</span>); <span class="comment">// å·¦å­æ ‘</span></span><br><span class="line">        <span class="keyword">if</span> (r &gt; m) sum += rangeSum(l, r, m + <span class="number">1</span>, cr, p * <span class="number">2</span> + <span class="number">1</span>); <span class="comment">// å³å­æ ‘</span></span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">rangeAdd</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">double</span> val, <span class="keyword">int</span> cl, <span class="keyword">int</span> cr, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r) &#123; <span class="comment">// å¦‚æœå½“å‰åŒºé—´æ˜¯è¦æ›´æ–°åŒºé—´çš„å­åŒºé—´</span></span><br><span class="line">            lazy[p] += val; <span class="comment">// æ‡’æƒ°æ ‡è®°å¢åŠ </span></span><br><span class="line">            tree[p] += (cr - cl + <span class="number">1</span>) * val; <span class="comment">// æ›´æ–°å½“å‰èŠ‚ç‚¹çš„å€¼</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> m = cl + (cr - cl) / <span class="number">2</span>;</span><br><span class="line">        maintain(cl, cr, p); <span class="comment">// ç»´æŠ¤å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (l &lt;= m) rangeAdd(l, r, val, cl, m, p * <span class="number">2</span>); <span class="comment">// å·¦å­æ ‘</span></span><br><span class="line">        <span class="keyword">if</span> (r &gt; m) rangeAdd(l, r, val, m + <span class="number">1</span>, cr, p * <span class="number">2</span> + <span class="number">1</span>); <span class="comment">// å³å­æ ‘</span></span><br><span class="line">        tree[p] = tree[p * <span class="number">2</span>] + tree[p * <span class="number">2</span> + <span class="number">1</span>]; <span class="comment">// æ›´æ–°å½“å‰èŠ‚ç‚¹çš„å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (s == t) &#123;</span><br><span class="line">            tree[p] = arr[s].doubleValue(); <span class="comment">// ä½¿ç”¨ double ç±»å‹</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> m = s + (t - s) / <span class="number">2</span>;</span><br><span class="line">        build(s, m, p * <span class="number">2</span>); <span class="comment">// æ„å»ºå·¦å­æ ‘</span></span><br><span class="line">        build(m + <span class="number">1</span>, t, p * <span class="number">2</span> + <span class="number">1</span>); <span class="comment">// æ„å»ºå³å­æ ‘</span></span><br><span class="line">        tree[p] = tree[p * <span class="number">2</span>] + tree[p * <span class="number">2</span> + <span class="number">1</span>]; <span class="comment">// æ›´æ–°å½“å‰èŠ‚ç‚¹çš„å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">rangeSum</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> rangeSum(l, r, <span class="number">0</span>, end, root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rangeAdd</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">double</span> val)</span> </span>&#123;</span><br><span class="line">        rangeAdd(l, r, val, <span class="number">0</span>, end, root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥åŒºé—´ä¿®æ”¹/æ±‚å’Œçš„çº¿æ®µæ ‘æ¨¡æ¿:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SegTreeLazyRangeSet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] tree; <span class="comment">// å­˜å‚¨æ ‘èŠ‚ç‚¹çš„æ•°ç»„</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] lazy; <span class="comment">// æ‡’æƒ°æ ‡è®°æ•°ç»„</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span>[] ifLazy; <span class="comment">// æ‡’æƒ°æ ‡è®°çš„çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] arr; <span class="comment">// åŸå§‹æ•°ç»„</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> n, root, n4, end;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SegTreeLazyRangeSet</span><span class="params">(<span class="keyword">double</span>[] v)</span> </span>&#123;</span><br><span class="line">        n = v.length;</span><br><span class="line">        n4 = n * <span class="number">4</span>;</span><br><span class="line">        tree = <span class="keyword">new</span> <span class="keyword">double</span>[n4];</span><br><span class="line">        lazy = <span class="keyword">new</span> <span class="keyword">double</span>[n4];</span><br><span class="line">        ifLazy = <span class="keyword">new</span> <span class="keyword">boolean</span>[n4];</span><br><span class="line">        arr = v;</span><br><span class="line">        Arrays.fill(tree, <span class="number">0</span>);</span><br><span class="line">        Arrays.fill(lazy, <span class="number">0</span>);</span><br><span class="line">        Arrays.fill(ifLazy, <span class="keyword">false</span>);</span><br><span class="line">        end = n - <span class="number">1</span>;</span><br><span class="line">        root = <span class="number">1</span>;</span><br><span class="line">        build(<span class="number">0</span>, end, <span class="number">1</span>);</span><br><span class="line">        arr = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">maintain</span><span class="params">(<span class="keyword">int</span> cl, <span class="keyword">int</span> cr, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cm = cl + (cr - cl) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (cl != cr &amp;&amp; ifLazy[p]) &#123;</span><br><span class="line">            lazy[p * <span class="number">2</span>] = lazy[p];</span><br><span class="line">            ifLazy[p * <span class="number">2</span>] = <span class="keyword">true</span>;</span><br><span class="line">            lazy[p * <span class="number">2</span> + <span class="number">1</span>] = lazy[p];</span><br><span class="line">            ifLazy[p * <span class="number">2</span> + <span class="number">1</span>] = <span class="keyword">true</span>;</span><br><span class="line">            tree[p * <span class="number">2</span>] = lazy[p] * (cm - cl + <span class="number">1</span>);</span><br><span class="line">            tree[p * <span class="number">2</span> + <span class="number">1</span>] = lazy[p] * (cr - cm);</span><br><span class="line">            lazy[p] = <span class="number">0</span>;</span><br><span class="line">            ifLazy[p] = <span class="keyword">false</span>; <span class="comment">// é‡ç½®å½“å‰èŠ‚ç‚¹çš„æ‡’æƒ°æ ‡è®°</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">rangeSum</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> cl, <span class="keyword">int</span> cr, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r) <span class="keyword">return</span> tree[p]; <span class="comment">// å®Œå…¨è¦†ç›–</span></span><br><span class="line">        <span class="keyword">int</span> m = cl + (cr - cl) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">double</span> sum = <span class="number">0</span>; <span class="comment">// ä½¿ç”¨ double ç±»å‹è¿›è¡Œæ±‚å’Œ</span></span><br><span class="line">        maintain(cl, cr, p); <span class="comment">// ç»´æŠ¤å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (l &lt;= m) sum += rangeSum(l, r, cl, m, p * <span class="number">2</span>); <span class="comment">// å·¦å­æ ‘</span></span><br><span class="line">        <span class="keyword">if</span> (r &gt; m) sum += rangeSum(l, r, m + <span class="number">1</span>, cr, p * <span class="number">2</span> + <span class="number">1</span>); <span class="comment">// å³å­æ ‘</span></span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">rangeSet</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">double</span> val, <span class="keyword">int</span> cl, <span class="keyword">int</span> cr, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r) &#123;</span><br><span class="line">            lazy[p] = val; <span class="comment">// æ‡’æƒ°æ ‡è®°å¢åŠ </span></span><br><span class="line">            ifLazy[p] = <span class="keyword">true</span>; <span class="comment">// æ ‡è®°ä¸ºæ‡’æƒ°</span></span><br><span class="line">            tree[p] = (cr - cl + <span class="number">1</span>) * val; <span class="comment">// æ›´æ–°å½“å‰èŠ‚ç‚¹çš„å€¼</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> m = cl + (cr - cl) / <span class="number">2</span>;</span><br><span class="line">        maintain(cl, cr, p); <span class="comment">// ç»´æŠ¤å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (l &lt;= m) rangeSet(l, r, val, cl, m, p * <span class="number">2</span>); <span class="comment">// å·¦å­æ ‘</span></span><br><span class="line">        <span class="keyword">if</span> (r &gt; m) rangeSet(l, r, val, m + <span class="number">1</span>, cr, p * <span class="number">2</span> + <span class="number">1</span>); <span class="comment">// å³å­æ ‘</span></span><br><span class="line">        tree[p] = tree[p * <span class="number">2</span>] + tree[p * <span class="number">2</span> + <span class="number">1</span>]; <span class="comment">// æ›´æ–°å½“å‰èŠ‚ç‚¹çš„å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (s == t) &#123;</span><br><span class="line">            tree[p] = arr[s]; <span class="comment">// ä½¿ç”¨ double ç±»å‹</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> m = s + (t - s) / <span class="number">2</span>;</span><br><span class="line">        build(s, m, p * <span class="number">2</span>); <span class="comment">// æ„å»ºå·¦å­æ ‘</span></span><br><span class="line">        build(m + <span class="number">1</span>, t, p * <span class="number">2</span> + <span class="number">1</span>); <span class="comment">// æ„å»ºå³å­æ ‘</span></span><br><span class="line">        tree[p] = tree[p * <span class="number">2</span>] + tree[p * <span class="number">2</span> + <span class="number">1</span>]; <span class="comment">// æ›´æ–°å½“å‰èŠ‚ç‚¹çš„å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">rangeSum</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> rangeSum(l, r, <span class="number">0</span>, end, root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rangeSet</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">double</span> val)</span> </span>&#123;</span><br><span class="line">        rangeSet(l, r, val, <span class="number">0</span>, end, root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="çº¿æ®µæ ‘ä¼˜åŒ–"><a href="#çº¿æ®µæ ‘ä¼˜åŒ–" class="headerlink" title="çº¿æ®µæ ‘ä¼˜åŒ–"></a>çº¿æ®µæ ‘ä¼˜åŒ–</h2><ol><li>åœ¨å¶å­èŠ‚ç‚¹å¤„æ— éœ€ä¸‹æ”¾æ‡’æƒ°æ ‡è®°ï¼Œæ‰€ä»¥æ‡’æƒ°æ ‡è®°å¯ä»¥ä¸ä¸‹ä¼ åˆ°å¶å­èŠ‚ç‚¹ã€‚</li><li>ä¸‹æ”¾æ‡’æƒ°æ ‡è®°å¯ä»¥å†™ä¸€ä¸ªä¸“é—¨çš„å‡½æ•°<code>maintain</code>ï¼Œé™ä½ä»£ç ç¼–å†™éš¾åº¦ã€‚</li><li>æ ‡è®°æ°¸ä¹…åŒ–ï¼šå¦‚æœç¡®å®šæ‡’æƒ°æ ‡è®°ä¸ä¼šåœ¨ä¸­é€”è¢«åŠ åˆ°æº¢å‡ºï¼ˆå³è¶…è¿‡äº†è¯¥ç±»å‹æ•°æ®æ‰€èƒ½è¡¨ç¤ºçš„æœ€å¤§èŒƒå›´ï¼‰ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†æ ‡è®°æ°¸ä¹…åŒ–ã€‚æ ‡è®°æ°¸ä¹…åŒ–å¯ä»¥é¿å…ä¸‹ä¼ æ‡’æƒ°æ ‡è®°ï¼Œåªéœ€åœ¨è¿›è¡Œè¯¢é—®æ—¶æŠŠæ ‡è®°çš„å½±å“åŠ åˆ°ç­”æ¡ˆå½“ä¸­ï¼Œä»è€Œé™ä½ç¨‹åºå¸¸æ•°ã€‚å…·ä½“å¦‚ä½•å¤„ç†ä¸é¢˜ç›®ç‰¹æ€§ç›¸å…³ï¼Œéœ€ç»“åˆé¢˜ç›®æ¥å†™ã€‚è¿™ä¹Ÿæ˜¯æ ‘å¥—æ ‘å’Œå¯æŒä¹…åŒ–æ•°æ®ç»“æ„ä¸­ä¼šç”¨åˆ°çš„ä¸€ç§æŠ€å·§ã€‚</li><li>åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼Œå³å¯ä»¥ä¸ä¸€æ¬¡æ€§å»ºå¥½æ ‘ï¼Œè€Œæ˜¯åœ¨æœ€åˆåªå»ºç«‹ä¸€ä¸ªæ ¹ç»“ç‚¹ä»£è¡¨æ•´ä¸ªåŒºé—´ã€‚å½“æˆ‘ä»¬éœ€è¦è®¿é—®æŸä¸ªå­åŒºé—´æ—¶ï¼Œæ‰å»ºç«‹ä»£è¡¨è¿™ä¸ªåŒºé—´çš„å­ç»“ç‚¹ã€‚è¿™ç§æ–¹å¼èŠ‚çœçš„ç©ºé—´æœ‰é™ï¼ˆçº¦$1/4$ï¼‰ã€‚</li></ol><h1 id="å…¶ä»–æ“ä½œ"><a href="#å…¶ä»–æ“ä½œ" class="headerlink" title="å…¶ä»–æ“ä½œ"></a>å…¶ä»–æ“ä½œ</h1><p>çº¿æ®µæ ‘çš„å…¶ä»–æ“ä½œåŒ…æ‹¬çº¿æ®µæ ‘åˆå¹¶ã€çº¿æ®µæ ‘åˆ†è£‚ã€çº¿æ®µæ ‘äºŒåˆ†ã€çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ç­‰ï¼Œé‡åˆ°ç›¸å…³é¢˜ç›®æ—¶å†åšè¡¥å……ã€‚</p><h1 id="ä¾‹é¢˜1-Booking-Concert-Tickets-in-Groups"><a href="#ä¾‹é¢˜1-Booking-Concert-Tickets-in-Groups" class="headerlink" title="ä¾‹é¢˜1: Booking Concert Tickets in Groups"></a>ä¾‹é¢˜1: <a href="https://leetcode.cn/problems/booking-concert-tickets-in-groups/description">Booking Concert Tickets in Groups</a></h1><p>å°†æ¯ä¸€æ’åº§ä½çœ‹æˆä¸€ä¸ªæ•´ä½“ï¼Œå¯å°†ä¸¤ç§æ“ä½œæ€»ç»“å¦‚ä¸‹ï¼š</p><ul><li>gatherï¼šåœ¨å‰ maxRow æ’ä¸­ï¼Œæ‰¾ç¬¬ä¸€ä¸ªè¿˜èƒ½è‡³å°‘æœ‰ k ä¸ªç©ºåº§ä½çš„æ’ï¼Œé¢„å®š k ä¸ªè¿ç»­çš„åº§ä½ã€‚å¦‚æœæœ‰è¿™æ ·çš„æ’ï¼Œè¿”å›ç¼–å·ï¼Œä»¥åŠåœ¨é¢„å®šå‰æœ‰å¤šå°‘éç©ºåº§ä½ï¼›å¦‚æœæ²¡æœ‰è¿™æ ·çš„æ’ï¼Œè¿”å›ç©ºåˆ—è¡¨ã€‚</li><li>scatterï¼šåœ¨å‰ maxRow ä¸ªæ’ä¸­é¢„å®šæ€»é‡ä¸º k çš„åº§ä½ã€‚ä»å·¦åˆ°å³é€‰æ‹©æœ‰ç©ºåº§ä½çš„æ’ä¾æ¬¡å åº§ã€‚å¦‚æœæ— æ³•é¢„å®šæ€»é‡ä¸º k çš„åº§ä½ï¼Œåˆ™ä¸æ‰§è¡Œæ“ä½œï¼Œå¹¶è¿”å› falseï¼›å¦åˆ™æ‰§è¡Œæ“ä½œï¼Œå¹¶è¿”å› trueã€‚</li></ul><p>æ­¤æ—¶å°†åŸé—®é¢˜å‹ç¼©ä¸ºä¸€ç»´æ•°ç»„ï¼Œèƒ½è¿™æ ·åšçš„åŸå› æ˜¯ä¸¤ç§æ“ä½œå‡ä¸ä¼šäº§ç”Ÿâ€œé—´éš”çš„ç©ºåº§ä½â€ã€‚å› æ­¤éœ€è¦çš„æ“ä½œå¦‚ä¸‹ï¼š</p><ul><li>æ±‚å‡ºå‰ maxRow æ’ä¸­ï¼Œç¬¬ä¸€ä¸ªå‰©ä½™å®¹é‡ â‰¥kï¼Œä¹Ÿå°±æ˜¯å·²é¢„å®šé‡ â‰¤ mâˆ’k çš„æ’ã€‚</li><li>ç»´æŠ¤æ¯æ’çš„å·²é¢„å®šé‡ã€‚</li><li>ç»´æŠ¤å‰ maxRow æ’çš„å·²é¢„å®šé‡ä¹‹å’Œï¼Œä»è€Œåˆ¤æ–­ scatter èƒ½å¦å®ç°ã€‚</li></ul><p>å¯ä»¥ç”¨çº¿æ®µæ ‘å¤„ç†ä¸Šè¿°æ“ä½œï¼Œçº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸ªåŒºé—´ï¼ˆåŒºé—´å³æŸå‡ æ’ï¼‰å·²é¢„å®šé‡çš„æœ€å°å€¼ $\min$ ï¼Œä»¥åŠæ¯ä¸ªåŒºé—´çš„å·²é¢„å®šé‡ä¹‹å’Œ $sum$ã€‚</p><p>å¯¹äº gatherï¼Œä»çº¿æ®µæ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹é€’å½’ï¼š</p><ul><li>å¦‚æœå½“å‰åŒºé—´ $\min &gt; m-k$, åˆ™æ— æ³•é¢„å®š $k$ ä¸ªè¿ç»­åº§ä½ï¼Œè¿”å› 0 ã€‚</li><li>å¦‚æœå½“å‰åŒºé—´é•¿åº¦ä¸º 1 ï¼Œè¿”å›åŒºé—´ç«¯ç‚¹ã€‚</li><li>å¦‚æœå·¦åŠåŒºé—´ $\min \leq m-k$, åˆ™ç­”æ¡ˆåœ¨å·¦åŠåŒºé—´ä¸­, é€’å½’å·¦åŠåŒºé—´ã€‚</li><li>å¦åˆ™å¦‚æœ maxRow åœ¨å³åŠåŒºé—´å†…, é€’å½’å³åŠåŒºé—´ã€‚</li><li>å¦åˆ™è¿”å› -1 ï¼Œè¡¨ç¤ºæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æ’ã€‚</li></ul><p>ä¸Šè¿°è¿‡ç¨‹å«åš<strong>çº¿æ®µæ ‘äºŒåˆ†</strong>ï¼Œ</p><p>å¯¹äº scatterï¼Œå¦‚æœåŒºé—´ $[0$, maxRow] çš„å·²é¢„å®šé‡ä¹‹å’Œå¤§äº $m \cdot(\operatorname{maxRow}+1)-k$ ï¼Œåˆ™æ— æ³•æ‰§è¡Œæ“ä½œã€‚å¦åˆ™å¯ä»¥æ‰§è¡Œæ“ä½œã€‚ä»ç¬¬ä¸€ä¸ªæ²¡æœ‰è£…æ»¡ï¼Œä¹Ÿå°±æ˜¯å·²é¢„å®šé‡ $\leq m-1$ çš„æ’å¼€å§‹é¢„å®šï¼Œè¿™ä¹Ÿå¯ä»¥ç”¨çº¿æ®µæ ‘äºŒåˆ†æ±‚å‡ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookMyShow</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> m;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] min;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span>[] sum;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BookMyShow</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.n = n;</span><br><span class="line">        <span class="keyword">this</span>.m = m;</span><br><span class="line">        <span class="keyword">int</span> size = <span class="number">2</span> &lt;&lt; (<span class="number">32</span> - Integer.numberOfLeadingZeros(n)); <span class="comment">// æ¯” 4n æ›´å°</span></span><br><span class="line">        min = <span class="keyword">new</span> <span class="keyword">int</span>[size];</span><br><span class="line">        sum = <span class="keyword">new</span> <span class="keyword">long</span>[size];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] gather(<span class="keyword">int</span> k, <span class="keyword">int</span> maxRow) &#123;</span><br><span class="line">        <span class="comment">// æ‰¾ç¬¬ä¸€ä¸ªèƒ½é¢„å®š k ä¸ªåº§ä½çš„row</span></span><br><span class="line">        <span class="keyword">int</span> r = findFirst(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, maxRow, m - k);</span><br><span class="line">        <span class="keyword">if</span> (r &lt; <span class="number">0</span>) &#123; <span class="comment">// æ²¡æœ‰è¿™æ ·çš„row</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> c = (<span class="keyword">int</span>) querySum(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, r, r);</span><br><span class="line">        update(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, r, k); <span class="comment">// é¢„å®š</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;r, c&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">scatter</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> maxRow)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// [0,maxRow] çš„å·²é¢„å®šé‡ä¹‹å’Œ</span></span><br><span class="line">        <span class="keyword">long</span> s = querySum(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, <span class="number">0</span>, maxRow);</span><br><span class="line">        <span class="keyword">if</span> (s &gt; (<span class="keyword">long</span>) m * (maxRow + <span class="number">1</span>) - k) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>; <span class="comment">// ç©ºåº§ä½ä¸è¶³</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä»ç¬¬ä¸€ä¸ªæ²¡æœ‰å®šæ»¡çš„rowå¼€å§‹</span></span><br><span class="line">        <span class="keyword">int</span> i = findFirst(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, maxRow, m - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span> (k &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> left = Math.min(m - (<span class="keyword">int</span>) querySum(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, i, i), k);</span><br><span class="line">            update(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, i, left); <span class="comment">// é¢„å®š</span></span><br><span class="line">            k -= left;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŠŠä¸‹æ ‡ i ä¸Šçš„å…ƒç´ å€¼å¢åŠ  val</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> o, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> i, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">            min[o] += val;</span><br><span class="line">            sum[o] += val;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> m = (l + r) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &lt;= m) &#123;</span><br><span class="line">            update(o * <span class="number">2</span>, l, m, i, val);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            update(o * <span class="number">2</span> + <span class="number">1</span>, m + <span class="number">1</span>, r, i, val);</span><br><span class="line">        &#125;</span><br><span class="line">        min[o] = Math.min(min[o * <span class="number">2</span>], min[o * <span class="number">2</span> + <span class="number">1</span>]);</span><br><span class="line">        sum[o] = sum[o * <span class="number">2</span>] + sum[o * <span class="number">2</span> + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å›åŒºé—´ [L,R] å†…çš„å…ƒç´ å’Œ</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">querySum</span><span class="params">(<span class="keyword">int</span> o, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class="line">            <span class="keyword">return</span> sum[o];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> m = (l + r) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (L &lt;= m) &#123;</span><br><span class="line">            res = querySum(o * <span class="number">2</span>, l, m, L, R);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (R &gt; m) &#123;</span><br><span class="line">            res += querySum(o * <span class="number">2</span> + <span class="number">1</span>, m + <span class="number">1</span>, r, L, R);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å›åŒºé—´ [0,R] ä¸­ &lt;= val çš„æœ€é å·¦çš„ä½ç½®ï¼Œä¸å­˜åœ¨æ—¶è¿”å› -1</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">findFirst</span><span class="params">(<span class="keyword">int</span> o, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> R, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (min[o] &gt; val) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>; <span class="comment">// æ•´ä¸ªåŒºé—´çš„å…ƒç´ å€¼éƒ½å¤§äº val</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">            <span class="keyword">return</span> l;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> m = (l + r) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (min[o * <span class="number">2</span>] &lt;= val) &#123;</span><br><span class="line">            <span class="keyword">return</span> findFirst(o * <span class="number">2</span>, l, m, R, val);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (R &gt; m) &#123;</span><br><span class="line">            <span class="keyword">return</span> findFirst(o * <span class="number">2</span> + <span class="number">1</span>, m + <span class="number">1</span>, r, R, val);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://oi-wiki.org/ds/seg/#%E5%AE%9E%E7%8E%B0">https://oi-wiki.org/ds/seg/#%E5%AE%9E%E7%8E%B0</a><br>[2] <a href="https://en.wikipedia.org/wiki/Segment_tree">https://en.wikipedia.org/wiki/Segment_tree</a><br>[3] <a href="https://leetcode.cn/problems/booking-concert-tickets-in-groups/solutions/1523876/by-endlesscheng-okcu/?envType=daily-question&amp;envId=2024-09-28">https://leetcode.cn/problems/booking-concert-tickets-in-groups/solutions/1523876/by-endlesscheng-okcu/?envType=daily-question&amp;envId=2024-09-28</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;çº¿æ®µæ ‘æ˜¯ç®—æ³•ç«èµ›ä¸­å¸¸ç”¨çš„ç”¨æ¥ç»´æŠ¤â€œåŒºé—´ä¿¡æ¯â€çš„æ•°æ®ç»“æ„ã€‚çº¿æ®µæ ‘å¯ä»¥åœ¨ $O(\log N)$ çš„æ—¶é—´å¤æ‚åº¦å†…å®ç°å•ç‚¹ä¿®æ”¹ã€åŒºé—´ä¿®æ”¹ã€åŒºé—´æŸ¥è¯¢ï¼ˆåŒºé—´æ±‚å’Œï¼Œæ±‚åŒºé—´æœ€å¤§å€¼ï¼Œæ±‚åŒºé—´æœ€å°å€¼ï¼‰ç­‰æ“ä½œã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="æ•°æ®ç»“æ„ä¸ç®—æ³•" scheme="http://silencezheng.top/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>é›ªèŠ±ç®—æ³•</title>
    <link href="http://silencezheng.top/2024/10/01/article142/"/>
    <id>http://silencezheng.top/2024/10/01/article142/</id>
    <published>2024-10-01T13:20:17.000Z</published>
    <updated>2024-10-01T13:24:40.093Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç”¨äºç”Ÿæˆå…¨å±€å”¯ä¸€IDï¼ˆåˆ†å¸ƒå¼IDï¼‰çš„ç®—æ³•æœ‰å¤šç§ï¼Œé›ªèŠ±ç®—æ³•ï¼ˆSnowFlakeï¼‰æ˜¯å…¶ä¸­ä¸€ä¸ªç»å…¸çš„å¸¸ç”¨ç®—æ³•ã€‚</p><span id="more"></span><h1 id="åˆ†å¸ƒå¼ID"><a href="#åˆ†å¸ƒå¼ID" class="headerlink" title="åˆ†å¸ƒå¼ID"></a>åˆ†å¸ƒå¼ID</h1><p>åˆ†å¸ƒå¼IDçš„ç‰¹ç‚¹ï¼š</p><ul><li><strong>å…¨å±€å”¯ä¸€æ€§</strong>ï¼šä¸èƒ½å‡ºç°æœ‰é‡å¤çš„IDæ ‡è¯†ï¼Œè¿™æ˜¯åŸºæœ¬è¦æ±‚ã€‚</li><li><strong>é€’å¢æ€§</strong>ï¼šç¡®ä¿ç”ŸæˆIDå¯¹äºç”¨æˆ·æˆ–ä¸šåŠ¡æ˜¯é€’å¢çš„ã€‚</li><li><strong>é«˜å¯ç”¨æ€§</strong>ï¼šç¡®ä¿ä»»ä½•æ—¶å€™éƒ½èƒ½ç”Ÿæˆæ­£ç¡®çš„IDã€‚</li><li><strong>é«˜æ€§èƒ½æ€§</strong>ï¼šåœ¨é«˜å¹¶å‘çš„ç¯å¢ƒä¸‹ä¾ç„¶è¡¨ç°è‰¯å¥½ã€‚</li></ul><p>åˆ†å¸ƒå¼IDçš„åº”ç”¨åœºæ™¯åŒ…æ‹¬ä½†ä¸é™äºï¼š</p><ul><li><strong>åˆ†å¸ƒå¼æ•°æ®åº“</strong>ï¼šç”Ÿæˆå”¯ä¸€ä¸»é”®ã€‚</li><li><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>ï¼šæ ‡è¯†æ¶ˆæ¯çš„å”¯ä¸€æ€§ã€‚</li><li><strong>ç”¨æˆ·æ³¨å†Œ</strong>ï¼šä¸ºæ–°ç”¨æˆ·ç”Ÿæˆå”¯ä¸€æ ‡è¯†ã€‚</li></ul><h1 id="é›ªèŠ±ç®—æ³•"><a href="#é›ªèŠ±ç®—æ³•" class="headerlink" title="é›ªèŠ±ç®—æ³•"></a>é›ªèŠ±ç®—æ³•</h1><p>SnowFlakeæœ€åˆæ˜¯Twitterå…¬å¸é‡‡ç”¨çš„ä¸€ç§ç®—æ³•ï¼Œç›®çš„æ˜¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­äº§ç”Ÿ<strong>å…¨å±€å”¯ä¸€ä¸”é€’å¢</strong>çš„IDã€‚æ¯ä¸€ä¸ªé›ªèŠ±ç®—æ³•äº§ç”Ÿçš„IDéƒ½æ˜¯ä¸€ä¸ªçš„64bitçš„longç±»å‹çš„å”¯ä¸€IDã€‚</p><h2 id="ç»“æ„ç»„æˆ"><a href="#ç»“æ„ç»„æˆ" class="headerlink" title="ç»“æ„ç»„æˆ"></a>ç»“æ„ç»„æˆ</h2><p><code>0 -- 41ä½æ—¶é—´æˆ³ -- 10ä½æœºå™¨ID -- 12ä½åºåˆ—å·</code></p><ol><li>æœ€é«˜1ä½æ˜¯ç¬¦å·ä½ï¼Œå›ºå®šä¸º0ï¼Œè¡¨ç¤ºidæ˜¯æ­£æ•´æ•°ï¼›</li><li>æ¥ä¸‹æ¥41ä½å­˜å‚¨æ¯«ç§’çº§æ—¶é—´æˆ³ï¼Œè¡¨ç¤ºä»ä¸€ä¸ªç‰¹å®šæ—¶é—´ç‚¹ï¼ˆé€šå¸¸æ˜¯ Unix çºªå…ƒæ—¶é—´ï¼‰å¼€å§‹çš„æ¯«ç§’æ•°ã€‚è¿™å…è®¸ç”Ÿæˆçš„ ID æŒç»­å¤§çº¦ 69 å¹´ï¼Œå³ $2^{41} / (1000 <em> 60 </em> 60 * 24 \times 365) = 69$ã€‚</li><li>å†æ¥ä¸‹10ä½å­˜å‚¨æœºå™¨ç ï¼ŒåŒ…æ‹¬é«˜5ä½çš„<code>datacenterId</code>å’Œä½5ä½çš„<code>workerId</code>ã€‚æœ€å¤šå¯ä»¥éƒ¨ç½²$2^{10}=1024$å°æœºå™¨ã€‚</li><li>æœ€å12ä½å­˜å‚¨åºåˆ—å·ï¼Œå³åœ¨åŒä¸€æ¯«ç§’å†…ç”Ÿæˆçš„åºåˆ—å·ï¼Œå…è®¸æ¯ä¸ªèŠ‚ç‚¹åœ¨åŒä¸€æ¯«ç§’å†…ç”Ÿæˆæœ€å¤š 4096 ä¸ª IDï¼ˆ$2^{12}$ï¼‰ã€‚</li></ol><p>åŸºäºç»„æˆå¯ä»¥è®¡ç®—é›ªèŠ±ç®—æ³•åœ¨åŒä¸€æ¯«ç§’å†…æœ€å¤šå¯ä»¥ç”Ÿæˆçš„å…¨å±€å”¯ä¸€IDæ•°é‡ä¸º$1024 \times 4096 = 4194304$ä¸ªã€‚</p><h2 id="ç”Ÿæˆè¿‡ç¨‹"><a href="#ç”Ÿæˆè¿‡ç¨‹" class="headerlink" title="ç”Ÿæˆè¿‡ç¨‹"></a>ç”Ÿæˆè¿‡ç¨‹</h2><p>ç”Ÿæˆä¸€ä¸ªé›ªèŠ± ID çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li><strong>è·å–å½“å‰æ—¶é—´æˆ³</strong>ï¼šè®¡ç®—å½“å‰çš„æ¯«ç§’æ—¶é—´æˆ³ã€‚</li><li><strong>æ£€æŸ¥æ—¶é—´æˆ³æ˜¯å¦å›æ‹¨</strong>ï¼šå¦‚æœå½“å‰æ—¶é—´å°äºä¸Šæ¬¡ç”Ÿæˆ ID çš„æ—¶é—´ï¼Œè¯´æ˜æ—¶é—´å›æ‹¨ï¼Œå¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸æˆ–ç­‰å¾…ã€‚</li><li><strong>ç”Ÿæˆåºåˆ—å·</strong>ï¼šå¦‚æœå½“å‰æ—¶é—´ä¸ä¸Šæ¬¡ç”Ÿæˆ ID çš„æ—¶é—´ç›¸åŒä¸”è¿˜æœ‰åºåˆ—å·å¯ç”¨ï¼Œåˆ™åºåˆ—å·åŠ 1ï¼›å¦åˆ™é˜»å¡è‡³ä¸‹ä¸€æ¯«ç§’ã€‚</li><li><strong>æ‹¼æ¥ ID</strong>ï¼šå°†æ—¶é—´æˆ³ã€æœºå™¨ ID å’Œåºåˆ—å·æ‹¼æ¥æˆä¸€ä¸ª 64 ä½çš„æ•´æ•°ã€‚</li></ol><p>Javaå®ç°ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SnowflakeIdWorker</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¼€å§‹æ—¶é—´æˆª (2015-01-01)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> twepoch = <span class="number">1420041600000L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœºå™¨idæ‰€å çš„ä½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> workerIdBits = <span class="number">5L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®æ ‡è¯†idæ‰€å çš„ä½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> datacenterIdBits = <span class="number">5L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¯æŒçš„æœ€å¤§æœºå™¨idï¼Œç»“æœæ˜¯31 (è¿™ä¸ªç§»ä½ç®—æ³•å¯ä»¥å¾ˆå¿«çš„è®¡ç®—å‡ºå‡ ä½äºŒè¿›åˆ¶æ•°æ‰€èƒ½è¡¨ç¤ºçš„æœ€å¤§åè¿›åˆ¶æ•°)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> maxWorkerId = -<span class="number">1L</span> ^ (-<span class="number">1L</span> &lt;&lt; workerIdBits);</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¯æŒçš„æœ€å¤§æ•°æ®æ ‡è¯†idï¼Œç»“æœæ˜¯31</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> maxDatacenterId = -<span class="number">1L</span> ^ (-<span class="number">1L</span> &lt;&lt; datacenterIdBits);</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åºåˆ—åœ¨idä¸­å çš„ä½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> sequenceBits = <span class="number">12L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœºå™¨IDå‘å·¦ç§»12ä½</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> workerIdShift = sequenceBits;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®æ ‡è¯†idå‘å·¦ç§»17ä½(12+5)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> datacenterIdShift = sequenceBits + workerIdBits;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ—¶é—´æˆªå‘å·¦ç§»22ä½(5+5+12)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> timestampLeftShift = sequenceBits + workerIdBits + datacenterIdBits;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæˆåºåˆ—çš„æ©ç ï¼Œè¿™é‡Œä¸º4095 (0b111111111111=0xfff=4095)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> sequenceMask = -<span class="number">1L</span> ^ (-<span class="number">1L</span> &lt;&lt; sequenceBits);</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å·¥ä½œæœºå™¨ID(0~31)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> workerId;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®ä¸­å¿ƒID(0~31)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> datacenterId;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¯«ç§’å†…åºåˆ—(0~4095)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> sequence = <span class="number">0L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šæ¬¡ç”ŸæˆIDçš„æ—¶é—´æˆª</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> lastTimestamp = -<span class="number">1L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> workerId     å·¥ä½œID (0~31)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> datacenterId æ•°æ®ä¸­å¿ƒID (0~31)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SnowflakeIdWorker</span><span class="params">(<span class="keyword">long</span> workerId, <span class="keyword">long</span> datacenterId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (workerId &gt; maxWorkerId || workerId &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(String.format(<span class="string">&quot;worker Id can&#x27;t be greater than %d or less than 0&quot;</span>, maxWorkerId));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (datacenterId &gt; maxDatacenterId || datacenterId &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(String.format(<span class="string">&quot;datacenter Id can&#x27;t be greater than %d or less than 0&quot;</span>, maxDatacenterId));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.workerId = workerId;</span><br><span class="line">        <span class="keyword">this</span>.datacenterId = datacenterId;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å¾—ä¸‹ä¸€ä¸ªID (è¯¥æ–¹æ³•æ˜¯çº¿ç¨‹å®‰å…¨çš„)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> SnowflakeId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">long</span> <span class="title">nextId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> timestamp = timeGen();</span><br><span class="line">        <span class="comment">// å¦‚æœå½“å‰æ—¶é—´å°äºä¸Šä¸€æ¬¡IDç”Ÿæˆçš„æ—¶é—´æˆ³ï¼Œè¯´æ˜ç³»ç»Ÿæ—¶é’Ÿå›é€€è¿‡è¿™ä¸ªæ—¶å€™åº”å½“æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">        <span class="keyword">if</span> (timestamp &lt; lastTimestamp) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(</span><br><span class="line">                    String.format(<span class="string">&quot;Clock moved backwards.  Refusing to generate id for %d milliseconds&quot;</span>, lastTimestamp - timestamp));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯åŒä¸€æ—¶é—´ç”Ÿæˆçš„ï¼Œåˆ™è¿›è¡Œæ¯«ç§’å†…åºåˆ—</span></span><br><span class="line">        <span class="keyword">if</span> (lastTimestamp == timestamp) &#123;</span><br><span class="line">            sequence = (sequence + <span class="number">1</span>) &amp; sequenceMask;</span><br><span class="line">            <span class="comment">// æ¯«ç§’å†…åºåˆ—æº¢å‡º</span></span><br><span class="line">            <span class="keyword">if</span> (sequence == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">//é˜»å¡åˆ°ä¸‹ä¸€ä¸ªæ¯«ç§’,è·å¾—æ–°çš„æ—¶é—´æˆ³</span></span><br><span class="line">                timestamp = tilNextMillis(lastTimestamp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ—¶é—´æˆ³æ”¹å˜ï¼Œæ¯«ç§’å†…åºåˆ—é‡ç½®</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            sequence = <span class="number">0L</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä¸Šæ¬¡ç”ŸæˆIDçš„æ—¶é—´æˆª</span></span><br><span class="line">        lastTimestamp = timestamp;</span><br><span class="line">        <span class="comment">// ç§»ä½å¹¶é€šè¿‡æˆ–è¿ç®—æ‹¼åˆ°ä¸€èµ·ç»„æˆ64ä½çš„ID</span></span><br><span class="line">        <span class="keyword">return</span> ((timestamp - twepoch) &lt;&lt; timestampLeftShift) <span class="comment">//</span></span><br><span class="line">                | (datacenterId &lt;&lt; datacenterIdShift) <span class="comment">//</span></span><br><span class="line">                | (workerId &lt;&lt; workerIdShift) <span class="comment">//</span></span><br><span class="line">                | sequence;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é˜»å¡åˆ°ä¸‹ä¸€ä¸ªæ¯«ç§’ï¼Œç›´åˆ°è·å¾—æ–°çš„æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> lastTimestamp ä¸Šæ¬¡ç”ŸæˆIDçš„æ—¶é—´æˆª</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½“å‰æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">long</span> <span class="title">tilNextMillis</span><span class="params">(<span class="keyword">long</span> lastTimestamp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> timestamp = timeGen();</span><br><span class="line">        <span class="keyword">while</span> (timestamp &lt;= lastTimestamp) &#123;</span><br><span class="line">            timestamp = timeGen();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> timestamp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›ä»¥æ¯«ç§’ä¸ºå•ä½çš„å½“å‰æ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½“å‰æ—¶é—´(æ¯«ç§’)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">long</span> <span class="title">timeGen</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> System.currentTimeMillis();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        SnowflakeIdWorker idWorker = <span class="keyword">new</span> SnowflakeIdWorker(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">long</span> id = idWorker.nextId();</span><br><span class="line">            Thread.sleep(<span class="number">1</span>);</span><br><span class="line">            System.out.println(id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="ä¼˜ç¼ºç‚¹åˆ†æ"><a href="#ä¼˜ç¼ºç‚¹åˆ†æ" class="headerlink" title="ä¼˜ç¼ºç‚¹åˆ†æ"></a>ä¼˜ç¼ºç‚¹åˆ†æ</h2><ul><li>ä¼˜ç‚¹ï¼š<ul><li><strong>é«˜å¹¶å‘</strong>ï¼šå¯ä»¥åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹é«˜æ•ˆç”Ÿæˆå”¯ä¸€IDï¼Œæ”¯æŒé«˜å¹¶å‘ã€‚</li><li><strong>æœ‰åºæ€§</strong>ï¼šç”Ÿæˆçš„IDåŸºäºæ—¶é—´æˆ³ï¼Œå…·æœ‰ä¸€å®šçš„æœ‰åºæ€§ï¼Œé€‚åˆç”¨äºæ•°æ®åº“çš„ä¸»é”®ã€‚</li><li><strong>ä½å»¶è¿Ÿ</strong>ï¼šç”ŸæˆIDçš„é€Ÿåº¦å¿«ï¼Œé€šå¸¸åœ¨æ¯«ç§’çº§åˆ«ã€‚</li></ul></li><li>ç¼ºç‚¹<ul><li><strong>æ—¶é—´å›æ‹¨é—®é¢˜</strong>ï¼šå¦‚æœæœåŠ¡å™¨æ—¶é—´å‘ç”Ÿå›æ‹¨ï¼Œå¯èƒ½å¯¼è‡´ç”Ÿæˆé‡å¤çš„IDï¼Œéœ€è¦å¤„ç†ã€‚</li><li><strong>æœºå™¨ ID ç®¡ç†</strong>ï¼šéœ€è¦ç¡®ä¿æœºå™¨ ID çš„å”¯ä¸€æ€§ï¼Œç®¡ç†è¾ƒä¸ºå¤æ‚ã€‚</li><li><strong>å­˜å‚¨é—®é¢˜</strong>ï¼šID çš„é•¿åº¦è¾ƒé•¿ï¼ˆ64 ä½ï¼‰ï¼Œå¯èƒ½åœ¨æŸäº›ç³»ç»Ÿä¸­é€ æˆå­˜å‚¨å¼€é”€ã€‚</li></ul></li></ul><h2 id="éƒ¨åˆ†å¼€æºçš„é›ªèŠ±ç®—æ³•å®ç°"><a href="#éƒ¨åˆ†å¼€æºçš„é›ªèŠ±ç®—æ³•å®ç°" class="headerlink" title="éƒ¨åˆ†å¼€æºçš„é›ªèŠ±ç®—æ³•å®ç°"></a>éƒ¨åˆ†å¼€æºçš„é›ªèŠ±ç®—æ³•å®ç°</h2><ol><li>HuTool</li><li>ç™¾åº¦UidGenerator</li><li><a href="https://tech.meituan.com/2017/04/21/mt-leaf.html">ç¾å›¢Leaf</a></li></ol><p>å„å®¶å¯¹äºæ—¶é’Ÿå›æ‹¨éƒ½æœ‰ä¸åŒçš„å¤„ç†ï¼Œä»¥HuToolä¸ºä¾‹ï¼š</p><ul><li>å¦‚æœæ—¶é’Ÿå›æ‹¨ä¸è¶…è¿‡2ç§’ï¼Œåˆ™ä¼šå°†ç°åœ¨çš„æ—¶é—´ç‚¹ç½®ä¸ºä¸Šä¸ªäº§ç”Ÿidçš„æ—¶é—´ç‚¹ï¼ˆè¶…è¿‡2så°±æŠ›å‡ºå¼‚å¸¸äº†ï¼‰ï¼›</li><li>å¦‚æœä¸Šä¸ªæ—¶é—´ç‚¹äº§ç”Ÿçš„idæ²¡æœ‰è¾¾åˆ°4095ï¼ˆè¶…è¿‡4095å°±æŠ›å‡ºå¼‚å¸¸äº†ï¼‰ï¼Œå³ä½¿äº§ç”Ÿäº†æ—¶é’Ÿå›æ‹¨ï¼Œä¹Ÿå¯ä»¥ç»§ç»­ç”Ÿæˆidã€‚</li><li>å¦‚æœå‡ºç°æ—¶é’Ÿå›æ‹¨ï¼Œå‡è®¾æ˜¯5sï¼Œé‚£ä¹ˆå¦‚æœè¿™5så†…æ²¡æœ‰idéœ€è¦ç”Ÿæˆï¼Œé‚£ä¹ˆæ—¶é’Ÿå›æ‹¨æ²¡æœ‰ä»»ä½•å½±å“ã€‚</li></ul><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://github.com/twitter-archive/snowflake/releases/tag/snowflake-2010">https://github.com/twitter-archive/snowflake/releases/tag/snowflake-2010</a><br>[2] <a href="https://zhuanlan.zhihu.com/p/85837641">https://zhuanlan.zhihu.com/p/85837641</a><br>[3] <a href="https://blog.csdn.net/weixin_43024834/article/details/135039159">https://blog.csdn.net/weixin_43024834/article/details/135039159</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;ç”¨äºç”Ÿæˆå…¨å±€å”¯ä¸€IDï¼ˆåˆ†å¸ƒå¼IDï¼‰çš„ç®—æ³•æœ‰å¤šç§ï¼Œé›ªèŠ±ç®—æ³•ï¼ˆSnowFlakeï¼‰æ˜¯å…¶ä¸­ä¸€ä¸ªç»å…¸çš„å¸¸ç”¨ç®—æ³•ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="æ•°æ®ç»“æ„ä¸ç®—æ³•" scheme="http://silencezheng.top/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"/>
    
    <category term="åˆ†å¸ƒå¼ç³»ç»Ÿ" scheme="http://silencezheng.top/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•</title>
    <link href="http://silencezheng.top/2024/10/01/article141/"/>
    <id>http://silencezheng.top/2024/10/01/article141/</id>
    <published>2024-10-01T11:48:10.000Z</published>
    <updated>2024-10-01T11:52:43.024Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>çœ‹åˆ†ç‰‡ç®—æ³•çš„æ—¶å€™äº†è§£åˆ°äº†ä¸€è‡´æ€§å“ˆå¸Œï¼Œæ¢³ç†ä¸€ä¸‹ç›¸å…³å†…å®¹ã€‚</p><p>å…¶ä¸»è¦çš„ä½¿ç”¨åœºæ™¯åŒ…æ‹¬ï¼šåˆ†å¸ƒå¼å­˜å‚¨ï¼ˆç¼“å­˜ã€DBã€æ–‡ä»¶ï¼‰ã€è´Ÿè½½å‡è¡¡ã€åˆ†å¸ƒå¼è®¡ç®—ç­‰ã€‚<br><span id="more"></span></p><h1 id="ç®€å•å“ˆå¸Œå‡½æ•°çš„â€œæ‰©å®¹å›°å¢ƒâ€"><a href="#ç®€å•å“ˆå¸Œå‡½æ•°çš„â€œæ‰©å®¹å›°å¢ƒâ€" class="headerlink" title="ç®€å•å“ˆå¸Œå‡½æ•°çš„â€œæ‰©å®¹å›°å¢ƒâ€"></a>ç®€å•å“ˆå¸Œå‡½æ•°çš„â€œæ‰©å®¹å›°å¢ƒâ€</h1><p>å¯¹äºç®€å•å“ˆå¸Œå‡½æ•°<code>m = hash(o) mod n</code>ï¼Œå…¶ä¸­ï¼Œ<code>o</code>ä¸ºå¯¹è±¡åç§°ï¼Œ<code>n</code>ä¸ºæœºå™¨çš„æ•°é‡ï¼Œ<code>m</code>ä¸ºæœºå™¨ç¼–å·ã€‚å½“<code>n</code>å¢å¤§æ—¶ï¼Œæ‰€æœ‰<code>o</code>å¯¹åº”çš„<code>m</code>éƒ½å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼Œè¿™äº›å˜åŒ–æ„å‘³ç€å°†å¯¹è±¡<code>o</code>çš„æ•°æ®è¿ç§»åˆ°æ–°çš„æœºå™¨<code>m</code>ã€‚</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹å¯¹è±¡å’Œæœºå™¨ï¼š</p><ul><li>å¯¹è±¡ï¼š<code>o1</code>, <code>o2</code>, <code>o3</code>, <code>o4</code></li><li>åˆå§‹æœºå™¨æ•°é‡ï¼š<code>n = 3</code></li></ul><p>å‡è®¾å¯¹æ¯ä¸ªå¯¹è±¡åº”ç”¨å“ˆå¸Œå‡½æ•°å¾—åˆ°çš„å“ˆå¸Œå€¼å¦‚ä¸‹ï¼š</p><ul><li><code>hash(o1) = 10</code></li><li><code>hash(o2) = 15</code></li><li><code>hash(o3) = 20</code></li><li><code>hash(o4) = 25</code></li></ul><p>å¯è®¡ç®—å‡ºåˆå§‹æ•°æ®åˆ†å¸ƒå¦‚ä¸‹ï¼š</p><ul><li>æœºå™¨ 0ï¼š<code>o2</code></li><li>æœºå™¨ 1ï¼š<code>o1</code>, <code>o4</code></li><li>æœºå™¨ 2ï¼š<code>o3</code></li></ul><p>ç°åœ¨ï¼Œæˆ‘ä»¬å°†æœºå™¨æ•°é‡å¢åŠ åˆ° <code>n = 5</code>ï¼Œä½¿ç”¨ç›¸åŒçš„å“ˆå¸Œå€¼ï¼Œé‡æ–°è®¡ç®—æ¯ä¸ªå¯¹è±¡çš„æ–°æœºå™¨ç¼–å·ï¼Œå¾—åˆ°çš„æ•°æ®åˆ†å¸ƒå¦‚ä¸‹ï¼š</p><ul><li>æœºå™¨ 0ï¼š<code>o1</code>, <code>o2</code>, <code>o3</code>, <code>o4</code></li><li>æœºå™¨ 1ï¼šæ— </li><li>æœºå™¨ 2ï¼šæ— </li><li>æœºå™¨ 3ï¼šæ— </li><li>æœºå™¨ 4ï¼šæ— </li></ul><p>å¯ä»¥å‘ç°ï¼Œè¦è¿ç§»çš„æ•°æ®å°†ååˆ†å¤šã€‚</p><h1 id="ä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent-Hashï¼‰"><a href="#ä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent-Hashï¼‰" class="headerlink" title="ä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent Hashï¼‰"></a>ä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent Hashï¼‰</h1><p>ä¸€è‡´æ€§å“ˆå¸Œ(Consistent Hash)ç®—æ³•æ˜¯1997å¹´æå‡ºï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„å“ˆå¸Œç®—æ³•ï¼Œç›®çš„æ˜¯è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ•°æ®åˆ†åŒºé—®é¢˜ï¼šå½“åˆ†å¸ƒå¼é›†ç¾¤ç§»é™¤æˆ–è€…æ·»åŠ ä¸€ä¸ªæœåŠ¡å™¨æ—¶ï¼Œå¿…é¡»å°½å¯èƒ½å°åœ°æ”¹å˜å·²å­˜åœ¨çš„æœåŠ¡è¯·æ±‚ä¸å¤„ç†è¯·æ±‚æœåŠ¡å™¨ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚</p><h2 id="åŸç†ç®€è¿°"><a href="#åŸç†ç®€è¿°" class="headerlink" title="åŸç†ç®€è¿°"></a>åŸç†ç®€è¿°</h2><p>ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§å–æ¨¡ç®—æ³•ã€‚åªä¸è¿‡æ˜¯å¯¹å›ºå®šå€¼<code>2^32</code>å–æ¨¡ï¼Œè¿™å°±ä½¿å¾—ä¸€è‡´æ€§ç®—æ³•å…·å¤‡è‰¯å¥½çš„å•è°ƒæ€§ï¼Œå³ä¸ç®¡é›†ç¾¤ä¸­æœ‰å¤šå°‘ä¸ªèŠ‚ç‚¹ï¼Œåªè¦keyå€¼å›ºå®šï¼Œé‚£æ‰€è¯·æ±‚çš„æœåŠ¡å™¨èŠ‚ç‚¹ä¹ŸåŒæ ·æ˜¯å›ºå®šçš„ã€‚</p><p>å…¶ç®—æ³•çš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š</p><ol><li>ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•å°†æ•´ä¸ªå“ˆå¸Œå€¼ç©ºé—´æ˜ å°„æˆä¸€ä¸ªè™šæ‹Ÿçš„åœ†ç¯ï¼Œæ•´ä¸ªå“ˆå¸Œç©ºé—´çš„å–å€¼èŒƒå›´ä¸º<code>[0, 2^32 - 1]</code>ï¼›</li><li>è®¡ç®—å„æœåŠ¡å™¨èŠ‚ç‚¹çš„å“ˆå¸Œå€¼ï¼Œå¹¶æ˜ å°„åˆ°å“ˆå¸Œç¯ä¸Šï¼›</li><li>å°†æœåŠ¡å‘æ¥çš„æ•°æ®è¯·æ±‚ä½¿ç”¨å“ˆå¸Œç®—æ³•ç®—å‡ºå¯¹åº”çš„å“ˆå¸Œå€¼ï¼›</li><li>å°†è®¡ç®—çš„å“ˆå¸Œå€¼æ˜ å°„åˆ°å“ˆå¸Œç¯ä¸Šï¼ŒåŒæ—¶æ²¿åœ†ç¯é¡ºæ—¶é’ˆæ–¹å‘æŸ¥æ‰¾ï¼Œé‡åˆ°çš„ç¬¬ä¸€å°æœåŠ¡å™¨å°±æ˜¯æ‰€å¯¹åº”çš„å¤„ç†è¯·æ±‚æœåŠ¡å™¨ã€‚</li><li>å½“å¢åŠ æˆ–è€…åˆ é™¤ä¸€å°æœåŠ¡å™¨æ—¶ï¼Œå—å½±å“çš„æ•°æ®ä»…ä»…æ˜¯æ–°æ·»åŠ æˆ–åˆ é™¤çš„æœåŠ¡å™¨åˆ°å…¶ç¯ç©ºé—´ä¸­å‰ä¸€å°çš„æœåŠ¡å™¨ï¼ˆä¹Ÿå°±æ˜¯é¡ºç€é€†æ—¶é’ˆæ–¹å‘é‡åˆ°çš„ç¬¬ä¸€å°æœåŠ¡å™¨ï¼‰ä¹‹é—´çš„æ•°æ®ï¼Œå…¶ä»–éƒ½ä¸ä¼šå—åˆ°å½±å“ã€‚</li></ol><h2 id="ç»†èŠ‚å‰–æ"><a href="#ç»†èŠ‚å‰–æ" class="headerlink" title="ç»†èŠ‚å‰–æ"></a>ç»†èŠ‚å‰–æ</h2><p>ç®—æ³•åŸç†å…¶å®å¾ˆå®¹æ˜“ç†è§£ï¼Œä½†æ˜¯è¿™é‡Œé¢æ¶‰åŠåˆ°ä¸€äº›ç»†èŠ‚é—®é¢˜ï¼š</p><ol><li>æ•°æ®è¯·æ±‚å¦‚ä½•å¯»æ‰¾ç›®æ ‡æœåŠ¡å™¨ï¼Ÿ<ul><li>è®¡ç®—è¯·æ±‚çš„å“ˆå¸Œå€¼åè¿›è¡Œé¡ºåºæŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾åˆ°å“ˆå¸Œç¯æœ«å°¾æ—¶è·³å›ç¬¬ä¸€ä¸ªå…ƒç´ ç»§ç»­é¡ºåºæŸ¥æ‰¾ã€‚</li></ul></li><li>åœ¨åˆ†å¸ƒå¼å­˜å‚¨çš„åœºæ™¯ä¸‹æ‰©å®¹æ—¶ï¼ŒåŸå®šå‘åˆ°BèŠ‚ç‚¹çš„éƒ¨åˆ†æ•°æ®éœ€è¦è¿ç§»åˆ°æ–°èŠ‚ç‚¹Cï¼Œå¦‚ä½•å¯¹è¿™éƒ¨åˆ†å­˜é‡æ•°æ®è¿›è¡Œè¿ç§»ï¼Ÿ<ol><li>ä»CèŠ‚ç‚¹é€†åºå®šä½åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹Bï¼›</li><li>å¯¹Bä¸­å…¨éƒ¨æ•°æ®è¿›è¡Œé‡å“ˆå¸Œï¼Œè¯†åˆ«å‡ºéœ€è¿ç§»æ•°æ®çš„èŒƒå›´ï¼›</li><li>å°†éœ€è¿ç§»æ•°æ®å¤åˆ¶åˆ°CèŠ‚ç‚¹ä¸­ï¼Œç¡®è®¤ä¸€è‡´ï¼›</li><li>åˆ é™¤BèŠ‚ç‚¹ä¸Šå·²è¿ç§»çš„æ•°æ®ã€‚</li></ol></li><li>åœ¨åˆ†å¸ƒå¼å­˜å‚¨çš„åœºæ™¯ä¸‹ç¼©å®¹æ—¶ï¼ŒåŸå®šå‘åˆ°BèŠ‚ç‚¹çš„æ‰€æœ‰æ•°æ®éœ€è¦è¿ç§»åˆ°æ–°èŠ‚ç‚¹Cï¼Œå¦‚ä½•å¯¹è¿™éƒ¨åˆ†å­˜é‡æ•°æ®è¿›è¡Œè¿ç§»ï¼Ÿ<ul><li>ä¸æ‰©å®¹ç›¸ä¼¼ï¼Œå…ˆå¤åˆ¶å†åˆ é™¤ï¼Œåªæ˜¯ä¸éœ€è¦ç¡®å®šæ•°æ®èŒƒå›´ï¼Œå› ä¸ºè¢«åˆ é™¤èŠ‚ç‚¹çš„æ‰€æœ‰æ•°æ®éƒ½éœ€è¦è¿ç§»ã€‚</li></ul></li><li>åœ¨è´Ÿè½½å‡è¡¡åœºæ™¯ä¸‹å‘ç”ŸèŠ‚ç‚¹å®•æœºæ—¶ï¼Œä¸€è‡´æ€§å“ˆå¸Œæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ<ul><li>ä»…å®•æœºèŠ‚ç‚¹çš„æµé‡ä¼šå»åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå…¶ä½™èŠ‚ç‚¹çš„æµé‡ä¸å—å½±å“ã€‚</li></ul></li><li>åœ¨åˆ†å¸ƒå¼å­˜å‚¨åœºæ™¯ä¸‹å‘ç”ŸèŠ‚ç‚¹æ•…éšœæ€ä¹ˆåŠï¼Ÿ<ol><li>é‡‡ç”¨æ•°æ®å‰¯æœ¬æœºåˆ¶ï¼Œåœ¨å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´å­˜å‚¨æ•°æ®çš„å‰¯æœ¬ï¼Œç¡®ä¿åœ¨èŠ‚ç‚¹å¤±æ•ˆæ—¶å¯ä»¥é€šè¿‡å…¶ä»–å‰¯æœ¬æ¢å¤æ•°æ®ã€‚</li><li>å®ç°å¥åº·æ£€æŸ¥æœºåˆ¶ï¼Œå®šæœŸæ£€æµ‹èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œå¹¶åœ¨å‘ç°æ•…éšœæ—¶å¿«é€Ÿé‡æ–°åˆ†é…æ•°æ®ã€‚</li></ol></li></ol><h2 id="æ•°æ®å€¾æ–œä¸è™šæ‹ŸèŠ‚ç‚¹"><a href="#æ•°æ®å€¾æ–œä¸è™šæ‹ŸèŠ‚ç‚¹" class="headerlink" title="æ•°æ®å€¾æ–œä¸è™šæ‹ŸèŠ‚ç‚¹"></a>æ•°æ®å€¾æ–œä¸è™šæ‹ŸèŠ‚ç‚¹</h2><p><strong>æ•°æ®å€¾æ–œ</strong>ï¼ˆData Skewï¼‰æ˜¯æŒ‡åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿæˆ–å¤§æ•°æ®å¤„ç†åœºæ™¯ä¸­ï¼Œæ•°æ®åœ¨æŸäº›èŠ‚ç‚¹æˆ–åˆ†ç‰‡ä¹‹é—´åˆ†å¸ƒä¸å‡åŒ€çš„ç°è±¡ã€‚è¿™ç§ä¸å‡åŒ€æ€§å¯¼è‡´æŸäº›èŠ‚ç‚¹æˆ–å¤„ç†å•å…ƒè´Ÿè½½è¿‡é‡ï¼Œè€Œå…¶ä»–èŠ‚ç‚¹åˆ™ç›¸å¯¹ç©ºé—²ï¼Œä»è€Œå½±å“ç³»ç»Ÿçš„æ€§èƒ½å’Œå“åº”æ—¶é—´ã€‚</p><p>æœ‰ä¸¤ç§æƒ…å†µå¯èƒ½å¯¼è‡´æ•°æ®å€¾æ–œï¼š</p><ol><li>å½“èŠ‚ç‚¹æ•°é‡è¾ƒå°‘æ—¶ï¼Œæ•°æ®å¯èƒ½ä¸å‡åŒ€åœ°åˆ†å¸ƒåœ¨å“ˆå¸Œç¯ä¸Šï¼Œå¯¼è‡´æŸäº›èŠ‚ç‚¹è´Ÿè½½è¿‡é‡ï¼Œè€Œå…¶ä»–èŠ‚ç‚¹ç›¸å¯¹ç©ºé—²ã€‚</li><li>å¦‚æœèŠ‚ç‚¹åœ¨å“ˆå¸Œç¯ä¸Šçš„ä½ç½®ä¸å¤Ÿåˆ†æ•£ï¼ˆç”¨çš„å“ˆå¸Œå‡½æ•°ä¸å¤Ÿæ•£åˆ—ï¼‰ï¼Œå¯èƒ½å¯¼è‡´æŸäº›èŠ‚ç‚¹çš„è´Ÿè½½è¿‡é«˜ã€‚</li></ol><p>å¯ä»¥é€šè¿‡<strong>è™šæ‹ŸèŠ‚ç‚¹</strong>çš„æœºåˆ¶æ¥è§£å†³æ•°æ®å€¾æ–œé—®é¢˜ã€‚è™šæ‹ŸèŠ‚ç‚¹æœºåˆ¶å¯¹æ¯ä¸€ä¸ªç‰©ç†æœåŠ¡èŠ‚ç‚¹æ˜ å°„å¤šä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼Œå°†è¿™äº›è™šæ‹ŸèŠ‚ç‚¹è®¡ç®—å“ˆå¸Œå€¼å¹¶æ˜ å°„åˆ°å“ˆå¸Œç¯ä¸Šï¼Œå½“è¯·æ±‚æ‰¾åˆ°æŸä¸ªè™šæ‹ŸèŠ‚ç‚¹åï¼Œå°†è¢«é‡æ–°æ˜ å°„åˆ°å…·ä½“çš„ç‰©ç†èŠ‚ç‚¹ã€‚è™šæ‹ŸèŠ‚ç‚¹è¶Šå¤šï¼Œå“ˆå¸Œç¯ä¸Šçš„èŠ‚ç‚¹å°±è¶Šå¤šï¼Œæ•°æ®åˆ†å¸ƒå°±è¶Šå‡åŒ€ï¼Œä»è€Œé¿å…äº†æ•°æ®å€¾æ–œçš„é—®é¢˜ã€‚</p><p>å‡è®¾ä¸€å°æœåŠ¡å™¨æœ‰ n ä¸ªè™šæ‹ŸèŠ‚ç‚¹ã€‚é‚£ä¹ˆå“ˆå¸Œè®¡ç®—æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>IP + ç«¯å£ + ç¼–å·</code>çš„å½¢å¼è¿›è¡Œå“ˆå¸Œå€¼è®¡ç®—ã€‚å…¶ä¸­çš„ç¼–å·å°±æ˜¯ 0 åˆ° n çš„æ•°å­—ã€‚ç”±äº<code>IP + ç«¯å£</code>æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥è¿™ n ä¸ªèŠ‚ç‚¹éƒ½æ˜¯æŒ‡å‘çš„åŒä¸€å°æœºå™¨ã€‚</p><h2 id="Demoå®ç°"><a href="#Demoå®ç°" class="headerlink" title="Demoå®ç°"></a>Demoå®ç°</h2><p>æ•°æ®èŠ‚ç‚¹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> VIRTUAL_NODE_NO_PER_NODE = <span class="number">200</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String ip;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> List&lt;Integer&gt; virtualNodeHashes = <span class="keyword">new</span> ArrayList&lt;&gt;(VIRTUAL_NODE_NO_PER_NODE);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;Object, Object&gt; cacheMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(String ip)</span> </span>&#123;</span><br><span class="line">        Objects.requireNonNull(ip);</span><br><span class="line">        <span class="keyword">this</span>.ip = ip;</span><br><span class="line">        initVirtualNodes();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initVirtualNodes</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String virtualNodeKey;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= VIRTUAL_NODE_NO_PER_NODE; i++) &#123;</span><br><span class="line">            virtualNodeKey = ip + <span class="string">&quot;#&quot;</span> + i;</span><br><span class="line">            virtualNodeHashes.add(HashUtils.hashcode(virtualNodeKey));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCacheItem</span><span class="params">(Object key, Object value)</span> </span>&#123;</span><br><span class="line">        cacheMap.put(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getCacheItem</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cacheMap.get(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeCacheItem</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">        cacheMap.remove(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getVirtualNodeHashes</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> virtualNodeHashes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getIp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ip;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸€è‡´æ€§å“ˆå¸Œï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsistentHash</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> TreeMap&lt;Integer, Node&gt; hashRing = <span class="keyword">new</span> TreeMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Node&gt; nodeList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¢åŠ èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     * æ¯å¢åŠ ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±ä¼šåœ¨é—­ç¯ä¸Šå¢åŠ ç»™å®šè™šæ‹ŸèŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     * ä¾‹å¦‚è™šæ‹ŸèŠ‚ç‚¹æ•°æ˜¯2ï¼Œåˆ™æ¯è°ƒç”¨æ­¤æ–¹æ³•ä¸€æ¬¡ï¼Œå¢åŠ ä¸¤ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼Œè¿™ä¸¤ä¸ªèŠ‚ç‚¹æŒ‡å‘åŒä¸€Node</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ip</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addNode</span><span class="params">(String ip)</span> </span>&#123;</span><br><span class="line">        Objects.requireNonNull(ip);</span><br><span class="line">        Node node = <span class="keyword">new</span> Node(ip);</span><br><span class="line">        nodeList.add(node);</span><br><span class="line">        <span class="keyword">for</span> (Integer virtualNodeHash : node.getVirtualNodeHashes()) &#123;</span><br><span class="line">            hashRing.put(virtualNodeHash, node);</span><br><span class="line">            System.out.println(<span class="string">&quot;è™šæ‹ŸèŠ‚ç‚¹[&quot;</span> + node + <span class="string">&quot;] hash:&quot;</span> + virtualNodeHash + <span class="string">&quot;ï¼Œè¢«æ·»åŠ &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»é™¤èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeNode</span><span class="params">(Node node)</span></span>&#123;</span><br><span class="line">        nodeList.remove(node);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ç¼“å­˜æ•°æ®</span></span><br><span class="line"><span class="comment">     * å…ˆæ‰¾åˆ°å¯¹åº”çš„è™šæ‹ŸèŠ‚ç‚¹ï¼Œç„¶åæ˜ å°„åˆ°ç‰©ç†èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">        Node node = findMatchNode(key);</span><br><span class="line">        System.out.println(<span class="string">&quot;è·å–åˆ°èŠ‚ç‚¹:&quot;</span> + node.getIp());</span><br><span class="line">        <span class="keyword">return</span> node.getCacheItem(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ ç¼“å­˜</span></span><br><span class="line"><span class="comment">     * å…ˆæ‰¾åˆ°hashç¯ä¸Šçš„èŠ‚ç‚¹ï¼Œç„¶ååœ¨å¯¹åº”çš„èŠ‚ç‚¹ä¸Šæ·»åŠ æ•°æ®ç¼“å­˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(Object key, Object value)</span> </span>&#123;</span><br><span class="line">        Node node = findMatchNode(key);</span><br><span class="line"></span><br><span class="line">        node.addCacheItem(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤ç¼“å­˜æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">evict</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">        findMatchNode(key).removeCacheItem(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  è·å¾—ä¸€ä¸ªæœ€è¿‘çš„é¡ºæ—¶é’ˆèŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key ä¸ºç»™å®šé”®å–Hashï¼Œå–å¾—é¡ºæ—¶é’ˆæ–¹å‘ä¸Šæœ€è¿‘çš„ä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹å¯¹åº”çš„å®é™…èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     *      * <span class="doctag">@return</span> èŠ‚ç‚¹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Node <span class="title">findMatchNode</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">        Map.Entry&lt;Integer, Node&gt; entry = hashRing.ceilingEntry(HashUtils.hashcode(key));</span><br><span class="line">        <span class="keyword">if</span> (entry == <span class="keyword">null</span>) &#123;</span><br><span class="line">            entry = hashRing.firstEntry();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> entry.getValue();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å“ˆå¸Œå‡½æ•°ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * FNV1_32_HASH</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> obj</span></span><br><span class="line"><span class="comment">     *         object</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> hashcode</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">hashcode</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> p = <span class="number">16777619</span>;</span><br><span class="line">        <span class="keyword">int</span> hash = (<span class="keyword">int</span>) <span class="number">2166136261L</span>;</span><br><span class="line">        String str = obj.toString();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.length(); i++)</span><br><span class="line">            hash = (hash ^ str.charAt(i)) * p;</span><br><span class="line">        hash += hash &lt;&lt; <span class="number">13</span>;</span><br><span class="line">        hash ^= hash &gt;&gt; <span class="number">7</span>;</span><br><span class="line">        hash += hash &lt;&lt; <span class="number">3</span>;</span><br><span class="line">        hash ^= hash &gt;&gt; <span class="number">17</span>;</span><br><span class="line">        hash += hash &lt;&lt; <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (hash &lt; <span class="number">0</span>)</span><br><span class="line">            hash = Math.abs(hash);</span><br><span class="line">        <span class="comment">//System.out.println(&quot;hash computer:&quot; + hash);</span></span><br><span class="line">        <span class="keyword">return</span> hash;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æµ‹è¯•ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsistentHashTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> NODE_SIZE = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> STRING_COUNT = <span class="number">100</span> * <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ConsistentHash consistentHash = <span class="keyword">new</span> ConsistentHash();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;String&gt; sList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å¢åŠ èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; NODE_SIZE; i++) &#123;</span><br><span class="line">            String ip = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;10.2.1.&quot;</span>).append(i)</span><br><span class="line">                    .toString();</span><br><span class="line">            consistentHash.addNode(ip);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”Ÿæˆéœ€è¦ç¼“å­˜çš„æ•°æ®;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; STRING_COUNT; i++) &#123;</span><br><span class="line">            sList.add(RandomStringUtils.randomAlphanumeric(<span class="number">10</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†æ•°æ®æ”¾å…¥åˆ°ç¼“å­˜ä¸­ã€‚</span></span><br><span class="line">        <span class="keyword">for</span> (String s : sList) &#123;</span><br><span class="line">            consistentHash.put(s, s);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">10</span> ; i ++) &#123;</span><br><span class="line">            <span class="keyword">int</span> index = RandomUtils.nextInt(<span class="number">0</span>, STRING_COUNT);</span><br><span class="line">            String key = sList.get(index);</span><br><span class="line">            String cache = (String) consistentHash.get(key);</span><br><span class="line">            System.out.println(<span class="string">&quot;Random:&quot;</span>+index+<span class="string">&quot;,key:&quot;</span> + key + <span class="string">&quot;,consistentHash get value:&quot;</span> + cache +<span class="string">&quot;,value is:&quot;</span> + key.equals(cache));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¾“å‡ºèŠ‚ç‚¹åŠæ•°æ®åˆ†å¸ƒæƒ…å†µ</span></span><br><span class="line">        <span class="keyword">for</span> (Node node : consistentHash.nodeList)&#123;</span><br><span class="line">            System.out.println(node);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ–°å¢ä¸€ä¸ªæ•°æ®èŠ‚ç‚¹</span></span><br><span class="line">        consistentHash.addNode(<span class="string">&quot;10.2.1.110&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">10</span> ; i ++) &#123;</span><br><span class="line">            <span class="keyword">int</span> index = RandomUtils.nextInt(<span class="number">0</span>, STRING_COUNT);</span><br><span class="line">            String key = sList.get(index);</span><br><span class="line">            String cache = (String) consistentHash.get(key);</span><br><span class="line">            System.out.println(<span class="string">&quot;Random:&quot;</span>+index+<span class="string">&quot;,key:&quot;</span> + key + <span class="string">&quot;,consistentHash get value:&quot;</span> + cache +<span class="string">&quot;,value is:&quot;</span> + key.equals(cache));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¾“å‡ºèŠ‚ç‚¹åŠæ•°æ®åˆ†å¸ƒæƒ…å†µ</span></span><br><span class="line">        <span class="keyword">for</span> (Node node : consistentHash.nodeList)&#123;</span><br><span class="line">            System.out.println(node);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://developer.aliyun.com/article/1082388">https://developer.aliyun.com/article/1082388</a><br>[2] <a href="https://zhuanlan.zhihu.com/p/129049724">https://zhuanlan.zhihu.com/p/129049724</a><br>[3] <a href="https://zhuanlan.zhihu.com/p/636719716">https://zhuanlan.zhihu.com/p/636719716</a><br>[4] <a href="https://zhuanlan.zhihu.com/p/53711866">https://zhuanlan.zhihu.com/p/53711866</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>ä¸‹ä¸€ç¯‡ï¼šChordåè®®ï¼Œç¬¬ä¸€ä»£åˆ†å¸ƒå¼å“ˆå¸Œè¡¨ï¼ˆDHTï¼‰ã€‚</p><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;çœ‹åˆ†ç‰‡ç®—æ³•çš„æ—¶å€™äº†è§£åˆ°äº†ä¸€è‡´æ€§å“ˆå¸Œï¼Œæ¢³ç†ä¸€ä¸‹ç›¸å…³å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸»è¦çš„ä½¿ç”¨åœºæ™¯åŒ…æ‹¬ï¼šåˆ†å¸ƒå¼å­˜å‚¨ï¼ˆç¼“å­˜ã€DBã€æ–‡ä»¶ï¼‰ã€è´Ÿè½½å‡è¡¡ã€åˆ†å¸ƒå¼è®¡ç®—ç­‰ã€‚&lt;br&gt;</summary>
    
    
    
    
    <category term="æ•°æ®ç»“æ„ä¸ç®—æ³•" scheme="http://silencezheng.top/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"/>
    
    <category term="åˆ†å¸ƒå¼ç³»ç»Ÿ" scheme="http://silencezheng.top/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeå‘¨è®° EP13</title>
    <link href="http://silencezheng.top/2024/09/23/article140/"/>
    <id>http://silencezheng.top/2024/09/23/article140/</id>
    <published>2024-09-22T17:00:46.000Z</published>
    <updated>2024-11-16T14:35:10.574Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™å‘¨çš„busé¢˜æŒºæœ‰æ„æ€ï¼Œå­¦ä¹ äº†ã€‚</p><p>æœ¬å‘¨ä¸»é¢˜ï¼šåŠ¨æ€è§„åˆ’ã€ç»„åˆæ•°å­¦ã€BFSã€ä¼˜åŒ–å»ºå›¾</p><p>é¢˜ç›®ï¼š</p><ul><li>240917æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/bus-routes/description">Bus Routes</a></li><li>240920æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/count-special-integers/description">Count Special Integers</a></li></ul><span id="more"></span><h1 id="Bus-Routes"><a href="#Bus-Routes" class="headerlink" title="Bus Routes"></a>Bus Routes</h1><blockquote><p>Bus Routes</p><p>You are given an array routes representing bus routes where routes[i] is a bus route that the ith bus repeats forever.</p><p>For example, if routes[0] = [1, 5, 7], this means that the 0th bus travels in the sequence 1 -&gt; 5 -&gt; 7 -&gt; 1 -&gt; 5 -&gt; 7 -&gt; 1 -&gt; â€¦ forever.<br>You will start at the bus stop source (You are not on any bus initially), and you want to go to the bus stop target. You can travel between bus stops by buses only.</p><p>Return the least number of buses you must take to travel from source to target. Return -1 if it is not possible.</p></blockquote><p>è¿™é“é¢˜å’Œåœ°å›¾åº”ç”¨ä¸­çš„å…¬äº¤è·¯çº¿è®¡ç®—éå¸¸è´´åˆï¼Œå®ç”¨ä»·å€¼å¾ˆé«˜ã€‚é¢˜æ„å°±æ˜¯ç»™äº†è‹¥å¹²å…¬äº¤çº¿è·¯å’Œèµ·ç‚¹ç»ˆç‚¹ï¼Œæ±‚æœ€å°æ¢ä¹˜ç­–ç•¥ã€‚</p><h2 id="ä¼˜åŒ–å»ºå›¾-BFS"><a href="#ä¼˜åŒ–å»ºå›¾-BFS" class="headerlink" title="ä¼˜åŒ–å»ºå›¾+BFS"></a>ä¼˜åŒ–å»ºå›¾+BFS</h2><p>ç”±äºæ±‚è§£çš„ç›®æ ‡æ˜¯æœ€å°‘ä¹˜åçš„å…¬äº¤è½¦æ•°é‡ï¼Œå¯¹äºåŒä¸€è¾†å…¬äº¤è½¦ï¼Œä¹˜å®¢å¯ä»¥åœ¨å…¶è·¯çº¿ä¸­çš„ä»»æ„è½¦ç«™é—´æ— ä»£ä»·åœ°ç§»åŠ¨ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥æŠŠå…¬äº¤è·¯çº¿å½“ä½œç‚¹ã€‚å¦‚æœä¸¤æ¡å…¬äº¤è·¯çº¿æœ‰ç›¸åŒè½¦ç«™ï¼Œåˆ™å¯ä»¥åœ¨è¿™ä¸¤æ¡è·¯çº¿é—´æ¢ä¹˜å…¬äº¤è½¦ï¼Œé‚£ä¹ˆè¿™ä¸¤æ¡å…¬äº¤è·¯çº¿ä¹‹é—´å¯è§†ä½œæœ‰ä¸€æ¡é•¿åº¦ä¸º$1$çš„è¾¹ã€‚è¿™æ ·å»ºå‡ºçš„å›¾åŒ…å«çš„ç‚¹æ•°å³ä¸ºå…¬äº¤è·¯çº¿çš„æ•°é‡ï¼Œè®°ä½œ$n$ã€‚</p><p>å®Œæˆäº†å»ºå›¾åï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ˜ç¡®æ–°çš„å›¾çš„èµ·ç‚¹å’Œç»ˆç‚¹ï¼Œç„¶åä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼Œè®¡ç®—å‡ºçš„èµ·ç‚¹å’Œç»ˆç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œä»è€Œå¾—åˆ°æœ€å°‘æ¢ä¹˜æ¬¡æ•°ã€‚</p><p>æ³¨æ„åˆ°åŸæœ¬çš„èµ·ç‚¹è½¦ç«™å’Œç»ˆç‚¹è½¦ç«™å¯èƒ½åŒæ—¶ä½äºå¤šæ¡å…¬äº¤è·¯çº¿ä¸Šï¼Œå› æ­¤åœ¨æ–°å›¾ä¸Šå¯èƒ½æœ‰å¤šä¸ªèµ·ç‚¹å’Œç»ˆç‚¹ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬åˆå§‹å¯ä»¥åŒæ—¶å…¥é˜Ÿå¤šä¸ªç‚¹ï¼Œå¹¶åœ¨å¹¿åº¦ä¼˜å…ˆæœç´¢ç»“æŸåæ£€æŸ¥åˆ°å„ä¸ªç»ˆç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œå–å…¶æœ€å°å€¼æ‰æ˜¯æœ€å°‘æ¢ä¹˜æ¬¡æ•°ã€‚</p><p>å®é™…å»ºå›¾æ—¶, æˆ‘ä»¬æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ¡ˆï¼š</p><ul><li>æ–¹æ¡ˆä¸€ï¼šæˆ‘ä»¬ç›´æ¥æšä¸¾å·¦å³ä¸¤ç«¯ç‚¹ï¼Œæ£€æŸ¥ä¸¤ç‚¹å¯¹åº”çš„ä¸¤å…¬äº¤è·¯çº¿æ˜¯å¦æœ‰å…¬å…±è½¦ç«™ã€‚åˆ©ç”¨å“ˆå¸Œè¡¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†å•æ¬¡æ¯”è¾ƒçš„æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–åˆ°å‡æ‘Š $O(n)$ ã€‚</li><li>æ–¹æ¡ˆäºŒï¼šæˆ‘ä»¬éå†æ‰€æœ‰å…¬äº¤è·¯çº¿ï¼Œè®°å½•æ¯ä¸€ä¸ªè½¦ç«™å±äºå“ªäº›å…¬äº¤è·¯çº¿ã€‚ç„¶åæˆ‘ä»¬éå†æ¯ä¸€ä¸ªè½¦ç«™ï¼Œå¦‚æœæœ‰å¤šæ¡å…¬äº¤è·¯çº¿ç»è¿‡è¯¥ç‚¹ï¼Œåˆ™åœ¨è¿™äº›å…¬äº¤è·¯çº¿ä¹‹é—´è¿è¾¹ã€‚</li></ul><p>æœ¬é¢˜ä¸­æˆ‘ä»¬é‡‡ç”¨æ–¹æ¡ˆäºŒï¼Œæ®æ­¤è¿˜å¯ä»¥ç›´æ¥å¾—åˆ°èµ·ç‚¹å’Œç»ˆç‚¹åœ¨æ–°å›¾ä¸­å¯¹åº”çš„ç‚¹ã€‚å®é™…ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å“ˆå¸Œæ˜ å°„æ¥å®æ—¶ç»´æŠ¤ã€Œè½¦ç«™æ‰€å±å…¬äº¤è·¯çº¿åˆ—è¡¨ã€ã€‚å‡è®¾å½“å‰æšä¸¾åˆ°å…¬äº¤è·¯çº¿ $i$ ä¸­çš„è½¦ç«™ $site$, æ­¤æ—¶å“ˆå¸Œæ˜ å°„ä¸­å·²è®°å½•è‹¥å¹²æ¡å…¬äº¤è·¯çº¿ç»è¿‡è½¦ç«™ $site$, æˆ‘ä»¬åªéœ€è¦è®©ç‚¹ $i$ ä¸è¿™äº›ç‚¹å…¬äº¤è·¯çº¿å¯¹åº”çš„ç‚¹ç›¸è¿å³å¯ã€‚å®Œæˆäº†è¿çº¿å, æˆ‘ä»¬å†å°†å…¬äº¤è·¯çº¿ $i$ åŠ å…¥åˆ°ã€Œè½¦ç«™ $site$ æ‰€å±å…¬äº¤è·¯çº¿åˆ—è¡¨ã€ä¸­ã€‚</p><p>ç‰¹åˆ«åœ°, èµ·ç‚¹å’Œç»ˆç‚¹ç›¸åŒæ—¶, æˆ‘ä»¬å¯ä»¥ç›´æ¥è¿”å› 0 ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">numBusesToDestination</span><span class="params">(<span class="keyword">int</span>[][] routes, <span class="keyword">int</span> source, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (source == target) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> n = routes.length;</span><br><span class="line">        <span class="keyword">boolean</span>[][] edge = <span class="keyword">new</span> <span class="keyword">boolean</span>[n][n];</span><br><span class="line">        <span class="comment">// key:è½¦ç«™, value:ç­æ¬¡åˆ—è¡¨</span></span><br><span class="line">        Map&lt;Integer, List&lt;Integer&gt;&gt; rec = <span class="keyword">new</span> HashMap&lt;Integer, List&lt;Integer&gt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> site : routes[i]) &#123;</span><br><span class="line">                List&lt;Integer&gt; list = rec.getOrDefault(site, <span class="keyword">new</span> ArrayList&lt;Integer&gt;());</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j : list) &#123;</span><br><span class="line">                    edge[i][j] = edge[j][i] = <span class="keyword">true</span>; <span class="comment">// ç­æ¬¡è¿çº¿</span></span><br><span class="line">                &#125;</span><br><span class="line">                list.add(i);</span><br><span class="line">                rec.put(site, list);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[] dis = <span class="keyword">new</span> <span class="keyword">int</span>[n]; <span class="comment">// è®°å½•ä»srcåˆ°tgtçš„æ‰€æœ‰ç­æ¬¡æ¢ä¹˜æ•°é‡</span></span><br><span class="line">        Arrays.fill(dis, -<span class="number">1</span>);</span><br><span class="line">        Queue&lt;Integer&gt; que = <span class="keyword">new</span> LinkedList&lt;Integer&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> bus : rec.getOrDefault(source, <span class="keyword">new</span> ArrayList&lt;Integer&gt;())) &#123;</span><br><span class="line">            dis[bus] = <span class="number">1</span>; <span class="comment">// èµ·ç‚¹ç­æ¬¡æ•°é‡ä¸º1</span></span><br><span class="line">            que.offer(bus); <span class="comment">// èµ·ç‚¹ç­æ¬¡å…¥é˜Ÿ</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼Œæ‰€æœ‰ç­æ¬¡æ¯æ¬¡ä»…å‘å‰æ¢æµ‹ä¸€æ¬¡ï¼Œä¿è¯ç»ˆç‚¹ç¬¬ä¸€æ¬¡è¢«æœç´¢åˆ°æ—¶è·¯å¾„æœ€çŸ­</span></span><br><span class="line">        <span class="keyword">while</span> (!que.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = que.poll(); <span class="comment">// é˜Ÿå¤´å‡ºé˜Ÿ</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; y &lt; n; y++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (edge[x][y] &amp;&amp; dis[y] == -<span class="number">1</span>) &#123;</span><br><span class="line">                    dis[y] = dis[x] + <span class="number">1</span>;</span><br><span class="line">                    que.offer(y); <span class="comment">// åŠ å…¥é˜Ÿå°¾</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä»èƒ½åˆ°ç»ˆç‚¹çš„ç­æ¬¡ä¸­ç­›é€‰å‡ºæœ€å°è·ç¦»</span></span><br><span class="line">        <span class="keyword">int</span> ret = Integer.MAX_VALUE;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> bus : rec.getOrDefault(target, <span class="keyword">new</span> ArrayList&lt;Integer&gt;())) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dis[bus] != -<span class="number">1</span>) &#123;</span><br><span class="line">                ret = Math.min(ret, dis[bus]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret == Integer.MAX_VALUE ? -<span class="number">1</span> : ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Count-Special-Integers"><a href="#Count-Special-Integers" class="headerlink" title="Count Special Integers"></a>Count Special Integers</h1><blockquote><p>Count Special Integers</p><p>We call a positive integer special if all of its digits are distinct.</p><p>Given a positive integer n, return the number of special integers that belong to the interval [1, n].</p></blockquote><p>åˆ°æ‰‹é¦–å…ˆè€ƒè™‘è®°å¿†åŒ–+æš´åŠ›ï¼Œç”¨ä¸¤ä¸ªæ•°ç»„åˆ†åˆ«è®°å½•å½“å‰æ•°å­—å’Œæ¯ä¸ªæ•°å­—çš„é¢‘æ¬¡æ¥é¿å…é‡å¤è®¡ç®—ï¼Œé€æ­¥ä»1å¢åŠ åˆ°nè®¡ç®—ï¼Œèƒ½è¿‡ç™¾åˆ†ä¹‹å…«åï¼Œå‰©ä¸‹è¶…æ—¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>]; <span class="comment">// å­˜æ”¾ä»1åˆ°10ä½çš„æ•°å­—</span></span><br><span class="line">    <span class="keyword">int</span>[] check = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>]; <span class="comment">// è®¡ç®—arræ˜¯å¦æœ‰é‡å¤å…ƒç´ </span></span><br><span class="line">    <span class="keyword">int</span> waterLevel = <span class="number">0</span>; <span class="comment">// è¡¨ç¤ºå½“å‰åˆ°è¾¾è¿‡çš„æœ€é«˜ä½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countSpecialNumbers</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">        arr[<span class="number">0</span>]++;</span><br><span class="line">        check[<span class="number">1</span>]++;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            recur(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">boolean</span> valid = <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> x:check)&#123;</span><br><span class="line">                <span class="keyword">if</span>(x&gt;<span class="number">1</span>)&#123;</span><br><span class="line">                    valid = <span class="keyword">false</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(valid) res++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">recur</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[p]&lt;<span class="number">9</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(waterLevel&gt;=p) check[arr[p]]--;</span><br><span class="line">            <span class="keyword">else</span> waterLevel++;</span><br><span class="line">            arr[p]++;</span><br><span class="line">            check[arr[p]]++;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            arr[p] = <span class="number">0</span>;</span><br><span class="line">            check[<span class="number">0</span>]++;</span><br><span class="line">            check[<span class="number">9</span>]--;</span><br><span class="line">            recur(p+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è§„åˆ’-ç»„åˆæ•°å­¦"><a href="#åŠ¨æ€è§„åˆ’-ç»„åˆæ•°å­¦" class="headerlink" title="åŠ¨æ€è§„åˆ’+ç»„åˆæ•°å­¦"></a>åŠ¨æ€è§„åˆ’+ç»„åˆæ•°å­¦</h2><p>å¦ä¸€ç§æ€è·¯æ˜¯é€šè¿‡ç»„åˆæ•°å­¦æ‹¼å‡ºæ‰€æœ‰çš„ç‰¹æ®Šæ•´æ•°ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…éå†æ‰€æœ‰å¯èƒ½çš„æ•´æ•°ã€‚å°†å°äºç­‰äº$n$çš„æ•´æ•°åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œè®°$n$åè¿›åˆ¶è¡¨ç¤ºä¸‹ä½æ•°ä¸º$k$ï¼š</p><ol><li>ä½æ•°å°äº$k$çš„ç‰¹æ®Šæ•´æ•°ã€‚</li><li>ä½æ•°ç­‰äº$k$çš„ç‰¹æ®Šæ•´æ•°ã€‚</li></ol><p>å¯¹äºä½æ•°å°äº $k$ çš„æƒ…å†µï¼Œåˆ†åˆ«è®¡ç®—ä½æ•°ä¸º 1 åˆ° $k-1$ çš„æƒ…å†µä¸‹ç‰¹æ®Šæ•´æ•°çš„æ•°é‡ã€‚è€ƒè™‘ä½æ•°ä¸º $k_0\left(k_0&lt;k\right)$çš„æƒ…å†µã€‚å› ä¸º $k_0&lt;k$ ï¼Œæ‰€ä»¥ä»»æ„æ”¾ç½®æ•°ä½ä¸Šçš„æ•°å­—ï¼Œéƒ½èƒ½æ»¡è¶³å°äºç­‰äº $n$ çš„æ¡ä»¶ã€‚åªéœ€ä¿è¯æ¯ä¸€æ•°ä½éƒ½äº’ä¸ç›¸åŒã€‚ç”¨ç»„åˆæ•°å­¦çš„æ€è·¯æ±‚è§£ç‰¹æ®Šæ•´æ•°çš„æ•°é‡ï¼Œä»æœ€é«˜ä½å¼€å§‹è€ƒè™‘ï¼Œå¯ä»¥æœ‰ 9 ç§é€‰æ‹©ï¼ˆé™¤ 0 å¤–çš„ä»»ä½•æ•´æ•°ï¼‰ï¼Œæ¬¡é«˜ä½ä¹Ÿæœ‰ 9 ç§é€‰æ‹©ï¼ˆé™¤æœ€é«˜ä½å¤–çš„ä»»ä½•æ•´æ•°ï¼‰ï¼Œæ¥ä¸‹æ¥çš„æ•°ä½çš„é€‰æ‹©åˆ™ä¾æ¬¡å‡å°‘ 1 ã€‚æŠŠè¿™äº›é€‰æ‹©çš„å¯èƒ½æ€§å…¨éƒ¨ç›¸ä¹˜åˆ™æ˜¯ä½æ•°ä¸º $k_0$ çš„ç‰¹æ®Šæ•´æ•°çš„æ•°é‡ã€‚</p><p>æ¥ä¸‹æ¥è€ƒè™‘ä½æ•°ç­‰äº $k$ çš„ç‰¹æ®Šæ•´æ•°ã€‚ç›¸åŒä½æ•°çš„æ•°å­—æ¯”è¾ƒå¤§å°ï¼Œæ˜¯ä»æœ€é«˜ä½å¼€å§‹æ¯”è¾ƒï¼Œè‹¥ä¸åŒï¼Œåˆ™æœ€é«˜ä½å¤§çš„æ•°å­—å¤§ï¼›è‹¥ç›¸åŒï¼Œåˆ™æ¯”è¾ƒæ¬¡é«˜ä½ã€‚æ¬¡é«˜ä½çš„æ¯”è¾ƒåŸåˆ™å’Œæœ€é«˜ä½ä¸€æ ·ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨è®¡ç®—å°äºç­‰äº $n$ çš„ç‰¹æ®Šæ•´æ•°æ—¶ï¼Œä¹Ÿéœ€è¦æŒ‰ç…§è¿™ä¸ªåŸåˆ™ã€‚å‡½æ•° $d p(mask, prefixSmaller)$ ç”¨æ¥è®¡ç®—ä»¥æŸäº›æ•°å­—ç»„åˆä¸ºå‰ç¼€çš„ç‰¹æ®Šæ•´æ•°çš„æ•°é‡ã€‚æ•´æ•° mask å³è¡¨ç¤ºäº†å‰å•ä¸­ä½¿ç”¨è¿‡çš„æ•°å­—ï¼ŒäºŒè¿›åˆ¶è¡¨ç¤ºä¸‹ï¼Œä»æœ€ä½ä½å¼€å§‹ï¼Œç¬¬ $i$ ä½å¦‚æœä¸º 1 åˆ™è¡¨ç¤ºæ•°å­— $i$ å·²ç»è¢«ä½¿ç”¨è¿‡ï¼Œåœ¨æ¥ä¸‹æ¥çš„åç¼€ä¸­ä¸èƒ½ä½¿ç”¨ã€‚å¸ƒå°”å€¼ prefixSmaller è¡¨ç¤ºå½“å‰çš„å‰ç¼€æ˜¯å¦å°äº $n$ çš„å‰ç¼€ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æ¥ä¸‹æ¥çš„æ•°å­—å¯ä»¥ä»»æ„é€‰æ‹©ã€‚å¦‚æœä¸æ˜¯ï¼Œå³å½“å‰çš„å‰ç¼€ç­‰äº $n$ çš„å‰ç¼€ï¼Œåˆ™æ¥ä¸‹æ¥çš„æ•°å­—åªèƒ½å°äºæˆ–è€…ç­‰äº $n$ åŒæ•°ä½çš„æ•°å­—ã€‚æœ€åè°ƒç”¨ $d p(0, f a l s e)$ åˆ™ä¸ºä½æ•°ç­‰äº $k$ çš„ç‰¹æ®Šæ•´æ•°çš„æ•°é‡ã€‚</p><p>æœ€åæŠŠè¿™ä¸¤éƒ¨åˆ†ç›¸åŠ å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    Map&lt;Integer, Integer&gt; memo = <span class="keyword">new</span> HashMap&lt;Integer, Integer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countSpecialNumbers</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        String nStr = String.valueOf(n);</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> prod = <span class="number">9</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nStr.length() - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            res += prod;</span><br><span class="line">            prod *= <span class="number">9</span> - i;</span><br><span class="line">        &#125;</span><br><span class="line">        res += dp(<span class="number">0</span>, <span class="keyword">false</span>, nStr);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> mask, <span class="keyword">boolean</span> prefixSmaller, String nStr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (Integer.bitCount(mask) == nStr.length()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> key = mask * <span class="number">2</span> + (prefixSmaller ? <span class="number">1</span> : <span class="number">0</span>); <span class="comment">// ç”¨å‚æ•°ç»„åˆç”Ÿæˆkeyç”¨äºè®°å¿†åŒ–</span></span><br><span class="line">        <span class="keyword">if</span> (!memo.containsKey(key)) &#123; <span class="comment">// å¦‚æœè¿˜æ²¡è®¡ç®—è¿‡ï¼Œåˆ™è®¡ç®—å½“å‰å‚æ•°ä¸‹çš„ç»„åˆæ•°é‡</span></span><br><span class="line">            <span class="keyword">int</span> res = <span class="number">0</span>; </span><br><span class="line">            <span class="keyword">int</span> lowerBound = mask == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>; <span class="comment">// åˆå§‹æœ€é«˜ä½æ—¶ä¸‹ç•Œä¸º1</span></span><br><span class="line">            <span class="keyword">int</span> upperBound = prefixSmaller ? <span class="number">9</span> : nStr.charAt(Integer.bitCount(mask)) - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = lowerBound; i &lt;= upperBound; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (((mask &gt;&gt; i) &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123; <span class="comment">// æ•°å­—iæœªè¢«ä½¿ç”¨è¿‡</span></span><br><span class="line">                    <span class="comment">// æŠŠiåŠ å…¥maskåˆ—è¡¨è¡¨ç¤ºä½¿ç”¨è¿‡</span></span><br><span class="line">                    res += dp(mask | (<span class="number">1</span> &lt;&lt; i), prefixSmaller || i &lt; upperBound, nStr); </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            memo.put(key, res); <span class="comment">// åœ¨maskå…ˆè¿›aåè¿›bçš„æƒ…å†µä¸‹ï¼Œåç»­maskå…ˆè¿›båè¿›açš„è¿ç®—å¯ä»¥çœç•¥ã€‚</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> memo.get(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="é¢˜è§£è®°å½•"><a href="#é¢˜è§£è®°å½•" class="headerlink" title="é¢˜è§£è®°å½•"></a>é¢˜è§£è®°å½•</h1><p>è¿˜æœ‰ä¸€é¢˜æœ‰äº›æ„æ€ä¸è¿‡å†™å‡ºæ¥äº†ï¼Œè´´ä¸€ä¸‹<a href="https://leetcode.cn/problems/the-latest-time-to-catch-a-bus/solutions/2921670/kuai-man-zhi-zhen-yi-ci-bian-li-ji-bai-9-bps8/">æˆ‘çš„é¢˜è§£</a>ã€‚</p><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://leetcode.cn/problems/count-special-integers/solutions/2916434/tong-ji-te-shu-zheng-shu-by-leetcode-sol-7qai/?envType=daily-question&amp;envId=2024-09-20">https://leetcode.cn/problems/count-special-integers/solutions/2916434/tong-ji-te-shu-zheng-shu-by-leetcode-sol-7qai/?envType=daily-question&amp;envId=2024-09-20</a><br>[2] <a href="https://leetcode.cn/problems/bus-routes/solutions/847860/gong-jiao-lu-xian-by-leetcode-solution-yifz/?envType=daily-question&amp;envId=2024-09-17">https://leetcode.cn/problems/bus-routes/solutions/847860/gong-jiao-lu-xian-by-leetcode-solution-yifz/?envType=daily-question&amp;envId=2024-09-17</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è¿™å‘¨çš„busé¢˜æŒºæœ‰æ„æ€ï¼Œå­¦ä¹ äº†ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨ä¸»é¢˜ï¼šåŠ¨æ€è§„åˆ’ã€ç»„åˆæ•°å­¦ã€BFSã€ä¼˜åŒ–å»ºå›¾&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;240917æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/bus-routes/description&quot;&gt;Bus Routes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240920æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/count-special-integers/description&quot;&gt;Count Special Integers&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    
    <category term="LeetCode" scheme="http://silencezheng.top/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeå‘¨è®° EP12</title>
    <link href="http://silencezheng.top/2024/09/15/article139/"/>
    <id>http://silencezheng.top/2024/09/15/article139/</id>
    <published>2024-09-15T15:32:15.000Z</published>
    <updated>2024-10-27T15:28:49.016Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™å‘¨å¿™åºŸäº†â€¦æŒ‘æˆ˜ä¸€å¤©å†™å®Œä¸€å‘¨çš„é¢˜ã€‚</p><p>æœ¬å‘¨ä¸»é¢˜ï¼šåŒæŒ‡é’ˆã€æšä¸¾ã€å•è°ƒé˜Ÿåˆ—</p><p>é¢˜ç›®ï¼š</p><ul><li>240910æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/count-increasing-quadruplets/description">Count Increasing Quadruplets</a></li><li>240912æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/find-the-maximum-number-of-marked-indices/description">Find the Maximum Number of Marked Indices</a></li><li>240913æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/maximum-number-of-robots-within-budget/description">Maximum Number of Robots Within Budget</a></li></ul><span id="more"></span><h1 id="Maximum-Number-of-Robots-Within-Budget"><a href="#Maximum-Number-of-Robots-Within-Budget" class="headerlink" title="Maximum Number of Robots Within Budget"></a>Maximum Number of Robots Within Budget</h1><blockquote><p>Maximum Number of Robots Within Budget</p><p>You have n robots. You are given two 0-indexed integer arrays, chargeTimes and runningCosts, both of length n. The ith robot costs chargeTimes[i] units to charge and costs runningCosts[i] units to run. You are also given an integer budget.</p><p>The total cost of running k chosen robots is equal to max(chargeTimes) + k * sum(runningCosts), where max(chargeTimes) is the largest charge cost among the k robots and sum(runningCosts) is the sum of running costs among the k robots.</p><p>Return the maximum number of consecutive robots you can run such that the total cost does not exceed budget.</p></blockquote><p>é¦–å…ˆæ³¨æ„é¢˜ç›®è¦æ±‚å¯åŠ¨çš„æœºå™¨äººåºåˆ—è¿ç»­ï¼Œåˆ™æ„æˆä¸€ä¸ªçª—å£ï¼Œçª—å£å†…è®¡ç®—costè¦å°äºbudgetä¸”çª—å£å°½é‡å¤§ã€‚æ¯æ¬¡çª—å£ç§»åŠ¨å¯èƒ½ä¼šå½±å“ä¸¤ä¸ªç‚¹è¿›è€Œå½±å“çª—å£costï¼Œä¸€ä¸ªæ˜¯æœ€å¤§å……ç”µæ—¶é—´ï¼Œä¸€ä¸ªæ˜¯æ€»ä½“å¯åŠ¨æ—¶é—´æ¶ˆè€—ã€‚åˆ™è¿™é“é¢˜å¯ä»¥çœ‹ä¸º<a href="https://leetcode.cn/problems/sliding-window-maximum/description/">Sliding Window Maximum</a>çš„å˜ä½“é¢˜ç›®ã€‚</p><p>å› æ­¤å…ˆæ¥æŠŠ<a href="https://leetcode.cn/problems/sliding-window-maximum/description/">Sliding Window Maximum</a>çš„<strong>å•è°ƒé˜Ÿåˆ—</strong>åšæ³•ææ‡‚ã€‚</p><p>PSï¼šè¿™é“é¢˜æˆ‘ä¹‹å‰ä¹Ÿå†™äº†ä¸€ä¸ª<a href="https://leetcode.cn/problems/sliding-window-maximum/solutions/2795111/treemap-by-silencezheng66-kb1i/">TreeMapçš„é¢˜è§£</a>ï¼Œæ¯”è¾ƒå¤æ‚ï¼Œæ­£å¥½è¿™æ¬¡å­¦ä¸€ä¸‹å•è°ƒé˜Ÿåˆ—çš„è§£æ³•ã€‚</p><p><strong>ã€Œå•è°ƒé˜Ÿåˆ—ã€å³æ»¡è¶³å•è°ƒæ€§çš„åŒç«¯é˜Ÿåˆ—</strong>ï¼ŒåŒç«¯é˜Ÿåˆ—å·¦ä¾§ä¸ºé˜Ÿé¦–ï¼Œå³ä¾§ä¸ºé˜Ÿå°¾ã€‚</p><h2 id="å‰ç½®é¢˜ç›®ï¼šSliding-Window-Maximum"><a href="#å‰ç½®é¢˜ç›®ï¼šSliding-Window-Maximum" class="headerlink" title="å‰ç½®é¢˜ç›®ï¼šSliding Window Maximum"></a>å‰ç½®é¢˜ç›®ï¼šSliding Window Maximum</h2><blockquote><p>Sliding Window Maximum</p><p>You are given an array of integers nums, there is a sliding window of size k which is moving from the very left of the array to the very right. You can only see the k numbers in the window. Each time the sliding window moves right by one position.</p><p>Return the max sliding window.</p></blockquote><p>é¢˜ç›®æ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œå°±æ˜¯å–ä¸€ä¸ªå®šé•¿çš„æ»‘çª—åœ¨æ•°ç»„ä¸Šæ»‘å‡ºè‹¥å¹²ä¸ªæœ€å€¼ï¼Œéš¾ç‚¹å°±æ˜¯ç”¨å°½é‡å°‘çš„æ—¶é—´è®¡ç®—æ¯ä¸ªçª—å£ä¸­çš„æœ€å€¼ã€‚</p><p>ç”±äºæˆ‘ä»¬éœ€è¦æ±‚å‡ºçš„æ˜¯æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼ï¼Œå¦‚æœå½“å‰çš„æ»‘åŠ¨çª—å£ä¸­æœ‰ä¸¤ä¸ªä¸‹æ ‡ $i$ å’Œ $j$, å…¶ä¸­ $i$ åœ¨ $j$çš„å·¦ä¾§ $(i&lt;j)$ ï¼Œå¹¶ä¸” $i$ å¯¹åº”çš„å…ƒç´ ä¸å¤§äº $j$ å¯¹åº”çš„å…ƒç´ ï¼ˆnums $[i] \leq n u m s[j]$ï¼‰ ï¼Œåˆ™å½“æ»‘åŠ¨çª—å£å‘å³ç§»åŠ¨æ—¶ï¼Œåªè¦ $i$ è¿˜åœ¨çª—å£ä¸­ï¼Œé‚£ä¹ˆ $j$ ä¸€å®šä¹Ÿè¿˜åœ¨çª—å£ä¸­ï¼Œè¿™æ˜¯ $i$ åœ¨ $j$ çš„å·¦ä¾§æ‰€ä¿è¯çš„ã€‚å› æ­¤, ç”±äº nums [j] çš„å­˜åœ¨, nums [i] ä¸€å®šä¸ä¼šæ˜¯æ»‘åŠ¨çª—å£ä¸­çš„æœ€å¤§å€¼äº†, æˆ‘ä»¬å¯ä»¥å°† nums [i]æ°¸ä¹…åœ°ç§»é™¤ã€‚</p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥<strong>ä½¿ç”¨ä¸€ä¸ªé˜Ÿåˆ—å­˜å‚¨æ‰€æœ‰è¿˜æ²¡æœ‰è¢«ç§»é™¤çš„ä¸‹æ ‡</strong>ã€‚åœ¨é˜Ÿåˆ—ä¸­, è¿™äº›<strong>ä¸‹æ ‡æŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºè¢«å­˜å‚¨, å¹¶ä¸”å®ƒä»¬åœ¨æ•°ç»„ nums ä¸­å¯¹åº”çš„å€¼æ˜¯ä¸¥æ ¼å•è°ƒé€’å‡çš„</strong>ã€‚å› ä¸ºå¦‚æœé˜Ÿåˆ—ä¸­æœ‰ä¸¤ä¸ªç›¸é‚»çš„ä¸‹æ ‡, å®ƒä»¬å¯¹åº”çš„å€¼ç›¸ç­‰æˆ–è€…é€’å¢, é‚£ä¹ˆä»¤å‰è€…ä¸º $i$, åè€…ä¸º $j$, å°±å¯¹åº”äº†ä¸Šé¢æ‰€è¯´çš„æƒ…å†µ, å³ $n u m s[i]$ ä¼šè¢«ç§»é™¤ï¼Œè¿™å°±äº§ç”Ÿäº†çŸ›ç›¾ã€‚</p><p>å½“æ»‘åŠ¨çª—å£å‘å³ç§»åŠ¨æ—¶, æˆ‘ä»¬éœ€è¦æŠŠä¸€ä¸ªæ–°çš„å…ƒç´ æ”¾å…¥é˜Ÿåˆ—ä¸­ã€‚ä¸ºäº†ä¿æŒé˜Ÿåˆ—çš„æ€§è´¨, æˆ‘ä»¬ä¼šä¸æ–­åœ°å°†æ–°çš„å…ƒç´ ä¸é˜Ÿå°¾çš„å…ƒç´ ç›¸æ¯”è¾ƒ, å¦‚æœå‰è€…å¤§äºç­‰äºåè€…, é‚£ä¹ˆé˜Ÿå°¾çš„å…ƒç´ å°±å¯ä»¥è¢«æ°¸ä¹…åœ°ç§»é™¤, æˆ‘ä»¬å°†å…¶å¼¹å‡ºé˜Ÿåˆ—ã€‚æˆ‘ä»¬éœ€è¦ä¸æ–­åœ°è¿›è¡Œæ­¤é¡¹æ“ä½œ, ç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºæˆ–è€…æ–°çš„å…ƒç´ å°äºé˜Ÿå°¾çš„å…ƒç´ ã€‚</p><p>ç”±äºé˜Ÿåˆ—ä¸­ä¸‹æ ‡å¯¹åº”çš„å…ƒç´ æ˜¯ä¸¥æ ¼å•è°ƒé€’å‡çš„, å› æ­¤æ­¤æ—¶é˜Ÿé¦–ä¸‹æ ‡å¯¹åº”çš„å…ƒç´ å°±æ˜¯æ»‘åŠ¨çª—å£ä¸­çš„æœ€å¤§å€¼ã€‚åŒæ—¶ï¼Œéš¨ç€çª—å£å‘å³ç§»åŠ¨ï¼Œé˜Ÿé¦–å…ƒç´ å¯èƒ½ä¼šä¸åœ¨çª—å£ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸æ–­ä»é˜Ÿé¦–å¼¹å‡ºå…ƒç´ , ç›´åˆ°é˜Ÿé¦–å…ƒç´ åœ¨çª—å£ä¸­ä¸ºæ­¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] maxSlidingWindow(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k) &#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.length;</span><br><span class="line">        Deque&lt;Integer&gt; deque = <span class="keyword">new</span> LinkedList&lt;Integer&gt;();</span><br><span class="line">        <span class="comment">// å…ˆå¡«å……ç¬¬ä¸€ä¸ªçª—å£</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">            <span class="keyword">while</span> (!deque.isEmpty() &amp;&amp; nums[i] &gt;= nums[deque.peekLast()]) &#123;</span><br><span class="line">                deque.pollLast();</span><br><span class="line">            &#125;</span><br><span class="line">            deque.offerLast(i);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[] ans = <span class="keyword">new</span> <span class="keyword">int</span>[n - k + <span class="number">1</span>];</span><br><span class="line">        ans[<span class="number">0</span>] = nums[deque.peekFirst()]; <span class="comment">// é˜Ÿé¦–ä¸ºçª—å£æœ€å¤§å€¼</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = k; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="comment">// é€å…ƒç´ ç§»åŠ¨çª—å£</span></span><br><span class="line">            <span class="keyword">while</span> (!deque.isEmpty() &amp;&amp; nums[i] &gt;= nums[deque.peekLast()]) &#123;</span><br><span class="line">                deque.pollLast();</span><br><span class="line">            &#125;</span><br><span class="line">            deque.offerLast(i);</span><br><span class="line">            <span class="comment">// æŠ›å¼ƒä¸åœ¨çª—å£ä¸­çš„æœ€å€¼</span></span><br><span class="line">            <span class="keyword">while</span> (deque.peekFirst() &lt;= i - k) &#123;</span><br><span class="line">                deque.pollFirst();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å–å‡ºç­”æ¡ˆï¼Œæ³¨æ„peekåªæ£€æŸ¥å¹¶ä¸ä¸¢å¼ƒ</span></span><br><span class="line">            ans[i - k + <span class="number">1</span>] = nums[deque.peekFirst()];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é¢˜è§£ï¼ˆå•è°ƒé˜Ÿåˆ—ï¼‰ï¼šMaximum-Number-of-Robots-Within-Budget"><a href="#é¢˜è§£ï¼ˆå•è°ƒé˜Ÿåˆ—ï¼‰ï¼šMaximum-Number-of-Robots-Within-Budget" class="headerlink" title="é¢˜è§£ï¼ˆå•è°ƒé˜Ÿåˆ—ï¼‰ï¼šMaximum Number of Robots Within Budget"></a>é¢˜è§£ï¼ˆå•è°ƒé˜Ÿåˆ—ï¼‰ï¼šMaximum Number of Robots Within Budget</h2><p>æœ¬é¢˜ç›¸è¾ƒäº<code>Sliding Window Maximum</code>æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š</p><ol><li>çª—å£å¤§å°ä¸å›ºå®šï¼Œé˜Ÿé¦–å¼¹å‡ºä¸budgetç›¸å…³è€Œä¸çª—å£å¤§å°æ— å…³ï¼›</li><li><code>chargeTimes</code>çš„æœ€å€¼å¤„ç†é€»è¾‘ç›¸åŒï¼›</li><li>æ±‚è§£éœ€è¦çŸ¥é“çª—å£å·¦ä¾§çš„ä½ç½®ï¼Œéœ€è¦ç»´æŠ¤çª—å£å·¦ä¾§ä¸‹æ ‡ã€‚</li></ol><p>é˜Ÿåˆ—ä¸­å­˜å‚¨çš„è¿˜æ˜¯<code>chargeTimes</code>çš„ä¸‹æ ‡ï¼Œå› ä¸ºä¸‹æ ‡ä¸<code>runningCosts</code>ä¸€ä¸€å¯¹åº”ï¼Œåˆ™è®¡ç®—æ€»æ¶ˆè€—æ—¶å…±ç”¨è®¡ç®—å³å¯ï¼Œæœ¬è´¨ä¸Šå¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ—è¿˜æ˜¯å› ä¸ºä¸¤ç‚¹ï¼Œä¸€æ˜¯è¿ç»­çª—å£ï¼ŒäºŒæ˜¯æœ€å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maximumRobots</span><span class="params">(<span class="keyword">int</span>[] chargeTimes, <span class="keyword">int</span>[] runningCosts, <span class="keyword">long</span> budget)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>; <span class="comment">// ç»´æŠ¤å·¦ä¾§ä¸‹æ ‡</span></span><br><span class="line">        <span class="keyword">long</span> sum = <span class="number">0</span>; <span class="comment">// ç”¨äºä¸é¢„ç®—æ¯”è¾ƒ</span></span><br><span class="line">        Deque&lt;Integer&gt; q = <span class="keyword">new</span> ArrayDeque&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> right = <span class="number">0</span>; right &lt; chargeTimes.length; right++) &#123;</span><br><span class="line">            <span class="comment">// 1. å…¥é˜Ÿï¼Œä¸å‰ç½®é¢˜ç›®é€»è¾‘ç›¸åŒ</span></span><br><span class="line">            <span class="keyword">while</span> (!q.isEmpty() &amp;&amp; chargeTimes[right] &gt;= chargeTimes[q.peekLast()]) &#123;</span><br><span class="line">                q.pollLast();</span><br><span class="line">            &#125;</span><br><span class="line">            q.addLast(right);</span><br><span class="line">            sum += runningCosts[right]; <span class="comment">// ç´¯è®¡cost</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 2. çª—å£å·¦ç«¯å³ç§»ï¼Œé€šè¿‡é¢„ç®—ä¸æ¶ˆè€—æ¯”è¾ƒåˆ¤æ–­</span></span><br><span class="line">            <span class="keyword">while</span> (!q.isEmpty() &amp;&amp; chargeTimes[q.peekFirst()] + (right - left + <span class="number">1</span>) * sum &gt; budget) &#123;</span><br><span class="line">                <span class="comment">// å‡ºé˜Ÿé€»è¾‘ï¼Œåœ¨å·¦ç§»è¿‡ç¨‹ä¸­é‡åˆ°æœ€å€¼è¦åŒæ­¥å‡ºé˜Ÿ</span></span><br><span class="line">                <span class="keyword">if</span> (q.peekFirst() == left) &#123;</span><br><span class="line">                    q.pollFirst();</span><br><span class="line">                &#125;</span><br><span class="line">                sum -= runningCosts[left++]; <span class="comment">// å‡å»ç§»å‡ºå…ƒç´ cost</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 3. æ›´æ–°ç­”æ¡ˆ</span></span><br><span class="line">            ans = Math.max(ans, right - left + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Find-the-Maximum-Number-of-Marked-Indices"><a href="#Find-the-Maximum-Number-of-Marked-Indices" class="headerlink" title="Find the Maximum Number of Marked Indices"></a>Find the Maximum Number of Marked Indices</h1><blockquote><p>Find the Maximum Number of Marked Indices</p><p>You are given a 0-indexed integer array nums.</p><p>Initially, all of the indices are unmarked. You are allowed to make this operation any number of times:</p><p>Pick two different unmarked indices i and j such that 2 * nums[i] &lt;= nums[j], then mark i and j.<br>Return the maximum possible number of marked indices in nums using the above operation any number of times.</p></blockquote><p>è¿™é¢˜æˆ‘ä¸€å¼€å§‹çš„æ€è·¯æ˜¯æŒ‰å€¼æ’åºåä»å¤§åˆ°å°åŒ¹é…ï¼Œä½†è¿™æ ·è´ªå¿ƒè¿˜æ˜¯ä¸èƒ½è·å¾—æœ€ä½³ç­”æ¡ˆï¼Œéœ€è¦ä»å¦‚ä½•è·å¾—æœ€ä¼˜è§£çš„è§’åº¦è€ƒè™‘ã€‚å½“å¯è·å¾—æœ€ä¼˜è§£æ—¶ï¼Œé•¿åº¦ä¸º $n$ çš„æ•°ç»„æœ€å¤šåªä¼šäº§ç”Ÿ $\left\lfloor\frac{n}{2}\right\rfloor$ å¯¹åŒ¹é…, å› æ­¤å¯¹æ•°ç»„ä»å°åˆ°å¤§æ’åºä»¥å, æˆ‘ä»¬å°†æ•°ç»„ä¸€åˆ†ä¸ºäºŒ, å·¦ä¾§å…ƒç´ åªä¼šä¸å³ä¾§å…ƒç´ åŒ¹é…ã€‚</p><p>è¿™æ ·æ“ä½œå°±å¯ä»¥è§£å†³ç›´æ¥æ’åºåŒ¹é…ä¸­æ‰¾ä¸åˆ°æœ€ä¼˜é…å¯¹çš„é—®é¢˜ï¼Œå¯¹äºå³ä¾§çš„ä¸€ä¸ªå…ƒç´ ï¼Œå…¶æœ€ä¼˜é…å¯¹çš„ç¬¦åˆæ¡ä»¶çš„å…ƒç´ æ—¢ä¸æ˜¯æ¯”ä»–æ¬¡å¤§çš„å…ƒç´ ï¼Œä¹Ÿä¸æ˜¯å…¨å±€æœ€å°çš„å…ƒç´ ï¼Œè€Œæ˜¯åˆ’åˆ†æˆä¸¤åŠåå·¦ä¾§çš„ç¬¦åˆæ¡ä»¶çš„æœ€å¤§å…ƒç´ ã€‚</p><h2 id="åŒæŒ‡é’ˆ"><a href="#åŒæŒ‡é’ˆ" class="headerlink" title="åŒæŒ‡é’ˆ"></a>åŒæŒ‡é’ˆ</h2><p>å…·ä½“çš„, æˆ‘ä»¬ä»¤ $m=\left\lfloor\frac{n}{2}\right\rfloor$, å°è¯•å°†ä¸‹æ ‡åœ¨ $[0, m-1]$ èŒƒå›´å†…çš„å…ƒç´  $n u m s[i]$ ä¸ä¸‹æ ‡åœ¨ $[m, n-1]$ èŒƒå›´å†…çš„å…ƒç´  $n u m s[j]$ è¿›è¡ŒåŒ¹é…ã€‚æˆ‘ä»¬ä»å°åˆ°å¤§æšä¸¾ $i$ ï¼Œç„¶åæ‰¾åˆ°æœ€å°çš„ $j$ ä½¿å…¶æ»¡è¶³ $2 \times$ $n u m s[i] \leq n u m s[j]$ ã€‚é‚£äº›æœ«æ»¡è¶³æ¡ä»¶è€Œè¢«è·³è¿‡çš„ nums $[j]$ å°†è¢«å¿½ç•¥ã€‚æŒç»­è¿™ä¸€è¿‡ç¨‹,ç›´åˆ° $i=m$ æˆ– $j=n$ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxNumOfMarkedIndices</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line">        <span class="keyword">int</span> n = nums.length;</span><br><span class="line">        <span class="keyword">int</span> m = n / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = m; i &lt; m &amp;&amp; j &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (j &lt; n &amp;&amp; <span class="number">2</span> * nums[i] &gt; nums[j]) &#123;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (j &lt; n) &#123;</span><br><span class="line">                res += <span class="number">2</span>;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Count-Increasing-Quadruplets-HARD"><a href="#Count-Increasing-Quadruplets-HARD" class="headerlink" title="Count Increasing Quadruplets HARD"></a>Count Increasing Quadruplets <font color=#FF4500 size=4 face='é»‘ä½“'>HARD</font></h1><blockquote><p>Count Increasing Quadruplets</p><p>Given a 0-indexed integer array nums of size n containing all numbers from 1 to n, return the number of increasing quadruplets.</p><p>A quadruplet (i, j, k, l) is increasing if:</p><ul><li>0 &lt;= i &lt; j &lt; k &lt; l &lt; n, and</li><li>nums[i] &lt; nums[k] &lt; nums[j] &lt; nums[l].</li></ul></blockquote><p>è¿™é“é¢˜ç›´æ¥æš´åŠ›èƒ½è§£å†³ä¸€åŠï¼Œå‰©ä¸‹ä¸€åŠå­¦ä¹ æˆæœ¬æœ‰ç‚¹é«˜äº†ï¼Œç›´æ¥çœ‹çµç¥é¢˜è§£å³å¯ï¼Œç°åœ¨æ²¡æ—¶é—´å­¦äº†ï¼Œæ„Ÿè§‰æ„ä¹‰ä¸å¤§ã€‚</p><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://leetcode.cn/problems/find-the-maximum-number-of-marked-indices/solutions/2905207/qiu-chu-zui-duo-biao-ji-xia-biao-by-leet-0j2m/?envType=daily-question&amp;envId=2024-09-12">https://leetcode.cn/problems/find-the-maximum-number-of-marked-indices/solutions/2905207/qiu-chu-zui-duo-biao-ji-xia-biao-by-leet-0j2m/?envType=daily-question&amp;envId=2024-09-12</a><br>[2] <a href="https://leetcode.cn/problems/count-increasing-quadruplets/solutions/2080632/you-ji-qiao-de-mei-ju-yu-chu-li-pythonja-exja/?envType=daily-question&amp;envId=2024-09-10">https://leetcode.cn/problems/count-increasing-quadruplets/solutions/2080632/you-ji-qiao-de-mei-ju-yu-chu-li-pythonja-exja/?envType=daily-question&amp;envId=2024-09-10</a><br>[3] <a href="https://leetcode.cn/problems/maximum-number-of-robots-within-budget/solutions/1798725/by-endlesscheng-7ukp/?envType=daily-question&amp;envId=2024-09-13">https://leetcode.cn/problems/maximum-number-of-robots-within-budget/solutions/1798725/by-endlesscheng-7ukp/?envType=daily-question&amp;envId=2024-09-13</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è¿™å‘¨å¿™åºŸäº†â€¦æŒ‘æˆ˜ä¸€å¤©å†™å®Œä¸€å‘¨çš„é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨ä¸»é¢˜ï¼šåŒæŒ‡é’ˆã€æšä¸¾ã€å•è°ƒé˜Ÿåˆ—&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;240910æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/count-increasing-quadruplets/description&quot;&gt;Count Increasing Quadruplets&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240912æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/find-the-maximum-number-of-marked-indices/description&quot;&gt;Find the Maximum Number of Marked Indices&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240913æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/maximum-number-of-robots-within-budget/description&quot;&gt;Maximum Number of Robots Within Budget&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    
    <category term="LeetCode" scheme="http://silencezheng.top/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeå‘¨è®° EP11</title>
    <link href="http://silencezheng.top/2024/09/08/article138/"/>
    <id>http://silencezheng.top/2024/09/08/article138/</id>
    <published>2024-09-08T14:31:23.000Z</published>
    <updated>2024-10-27T15:28:52.166Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™å‘¨æ„Ÿè§‰è¿˜å¯ä»¥å§ï¼Œæœ‰ä¸¤é“å‘¨èµ›åšè¿‡çš„é¢˜ã€‚</p><p>ä¸€ä¸ªæ„Ÿæ‚Ÿæ˜¯ï¼Œåšé¢˜è¦éµå®ˆåŸºæœ¬æ³•ï¼Œç©ºé—´å’Œæ—¶é—´æ˜¯æ­¤æ¶ˆå½¼é•¿çš„ï¼ŒåŠ¨æ€è§„åˆ’çš„çŠ¶æ€å®šä¹‰ä¹Ÿæ˜¯æœ‰ç« å¯å¾ªçš„ã€‚</p><p>æœ¬å‘¨ä¸»é¢˜ï¼šæ»‘åŠ¨çª—å£ã€æšä¸¾ã€åŠ¨æ€è§„åˆ’</p><p>é¢˜ç›®ï¼š</p><ul><li>240902æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/maximize-the-confusion-of-an-exam/description">Maximize the Confusion of an Exam</a></li><li>240905æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/happy-students/description">Happy Students</a></li><li>240907æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/find-the-maximum-length-of-a-good-subsequence-ii/description">Find the Maximum Length of a Good Subsequence II</a><span id="more"></span><h1 id="Maximize-the-Confusion-of-an-Exam"><a href="#Maximize-the-Confusion-of-an-Exam" class="headerlink" title="Maximize the Confusion of an Exam"></a>Maximize the Confusion of an Exam</h1><blockquote><p>Maximize the Confusion of an Exam</p><p>A teacher is writing a test with n true/false questions, with â€˜Tâ€™ denoting true and â€˜Fâ€™ denoting false. He wants to confuse the students by maximizing the number of consecutive questions with the same answer (multiple trues or multiple falses in a row).</p><p>You are given a string answerKey, where answerKey[i] is the original answer to the ith question. In addition, you are given an integer k, the maximum number of times you may perform the following operation:<br>Change the answer key for any question to â€˜Tâ€™ or â€˜Fâ€™ (i.e., set answerKey[i] to â€˜Tâ€™ or â€˜Fâ€™).</p><p>Return the maximum number of consecutive â€˜Tâ€™s or â€˜Fâ€™s in the answer key after performing the operation at most k times.</p></blockquote></li></ul><p>è¿™é“é¢˜æœ¬æ¥æƒ³è€ƒè™‘DPï¼ŒçŠ¶æ€ä¸ºâ€œæœ€åä¸€ä¸ªå…ƒç´ ä¸ºiï¼Œæ›¿æ¢æ¬¡æ•°ä¸ºjæ—¶çš„æœ€å¤§è¿ç»­å­ä¸²é•¿åº¦â€ï¼Œä½†æœ‰é—®é¢˜ï¼Œæœ€åä¸€ä¸ªå…ƒç´ å¯èƒ½ä¼šè¢«æ›¿æ¢ï¼Œä¸”æœ€å¤§å­ä¸²åªåœ¨å…¨æ›¿æ¢ä¸ºTæˆ–Fæ—¶æ‰å‡ºç°ï¼Œæ€ä¹ˆå¼„æ€ä¹ˆåˆ«æ‰­ï¼Œè¿˜æ˜¯ç”¨æ»‘çª—å§ã€‚</p><h2 id="æ»‘åŠ¨çª—å£"><a href="#æ»‘åŠ¨çª—å£" class="headerlink" title="æ»‘åŠ¨çª—å£"></a>æ»‘åŠ¨çª—å£</h2><p>åœ¨æŒ‡å®šå­—ç¬¦çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è®¡ç®—å…¶æœ€å¤§è¿ç»­æ•°ç›®ã€‚ä½¿ç”¨æ»‘åŠ¨çª—å£çš„æ–¹æ³•ï¼Œä»å·¦åˆ°å³æšä¸¾å³ç«¯ç‚¹ï¼Œç»´æŠ¤åŒºé—´ä¸­å¦ä¸€ç§å­—ç¬¦çš„æ•°é‡ä¸º sumï¼Œå½“ sum è¶…è¿‡ kï¼Œæˆ‘ä»¬éœ€è¦è®©å·¦ç«¯ç‚¹å³ç§»ï¼Œç›´åˆ° sumâ‰¤kã€‚ç§»åŠ¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è®°å½•æ»‘åŠ¨çª—å£çš„æœ€å¤§é•¿åº¦ï¼Œå³ä¸ºæŒ‡å®šå­—ç¬¦çš„æœ€å¤§è¿ç»­æ•°ç›®ã€‚ç­”æ¡ˆä¸ºåˆ†åˆ«æŒ‡å®šå­—ç¬¦ä¸º T å’Œ F æ—¶çš„æœ€å¤§è¿ç»­æ•°ç›®çš„è¾ƒå¤§å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxConsecutiveAnswers</span><span class="params">(String answerKey, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Math.max(maxConsecutiveChar(answerKey, k, <span class="string">&#x27;T&#x27;</span>), maxConsecutiveChar(answerKey, k, <span class="string">&#x27;F&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxConsecutiveChar</span><span class="params">(String answerKey, <span class="keyword">int</span> k, <span class="keyword">char</span> ch)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = answerKey.length();</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>, sum = <span class="number">0</span>; right &lt; n; right++) &#123;</span><br><span class="line">            sum += answerKey.charAt(right) != ch ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (sum &gt; k) &#123;</span><br><span class="line">                sum -= answerKey.charAt(left++) != ch ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = Math.max(ans, right - left + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Happy-Students"><a href="#Happy-Students" class="headerlink" title="Happy Students"></a>Happy Students</h1><blockquote><p>Happy Students</p><p>You are given a 0-indexed integer array nums of length n where n is the total number of students in the class. The class teacher tries to select a group of students so that all the students remain happy.</p><p>The ith student will become happy if one of these two conditions is met:</p><ul><li>The student is selected and the total number of selected students is strictly greater than nums[i].</li><li>The student is not selected and the total number of selected students is strictly less than nums[i].</li></ul><p>Return the number of ways to select a group of students so that everyone remains happy.</p></blockquote><p>ä¸€å¼€å§‹æ‹¿åˆ°æ²¡æƒ³å‡ºå¥½åŠæ³•ï¼Œå›æº¯æš´åŠ›äº†ä¸€ä¸‹ï¼Œè¶…æ—¶äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> res;</span><br><span class="line">    <span class="keyword">public</span> Set&lt;Set&lt;Integer&gt;&gt; mem;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countWays</span><span class="params">(List&lt;Integer&gt; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.size();</span><br><span class="line">        res = <span class="number">0</span>;</span><br><span class="line">        mem = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">        Set&lt;Integer&gt; set = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">        bt(nums, set, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bt</span><span class="params">(List&lt;Integer&gt; nums, Set&lt;Integer&gt; selected, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> success = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.size();i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(selected.contains(i))&#123;</span><br><span class="line">                <span class="keyword">if</span>(selected.size()&lt;=nums.get(i))&#123;</span><br><span class="line">                    success = <span class="keyword">false</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(selected.size()&gt;=nums.get(i))&#123;</span><br><span class="line">                    success = <span class="keyword">false</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(success&amp;&amp;!mem.contains(selected))&#123;</span><br><span class="line">            mem.add(selected);</span><br><span class="line">            res++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// System.out.println(selected.toString());</span></span><br><span class="line">        <span class="keyword">if</span>(p==nums.size()) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=p;i&lt;nums.size();i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(selected.contains(i)) <span class="keyword">continue</span>;</span><br><span class="line">            selected.add(i);</span><br><span class="line">            bt(nums, selected, p+<span class="number">1</span>);</span><br><span class="line">            selected.remove(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šéœ€è¦æƒ³æ˜ç™½é€‰ä¸­äººæ•°ä¸ºkæ—¶æ–¹æ¡ˆå”¯ä¸€ï¼Œå†æŒ‰ç…§è¿™ä¸ªæ€è·¯å»æšä¸¾å°±å¯ä»¥äº†ã€‚</p><h2 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h2><p>æ ¹æ®é¢˜æ„å¯çŸ¥ï¼Œå‡è®¾æ•°ç»„ nums çš„é•¿åº¦ä¸º nï¼Œæ­¤æ—¶è®¾é€‰ä¸­å­¦ç”Ÿäººæ•°ä¸º kï¼Œæ­¤æ—¶ kâˆˆ[0,n]ï¼Œk åº”æ»¡è¶³å¦‚ä¸‹ï¼š</p><ul><li>æ‰€æœ‰æ»¡è¶³ nums[i]&lt;k çš„å­¦ç”Ÿåº”è¢«é€‰ä¸­ï¼›</li><li>æ‰€æœ‰æ»¡è¶³ nums[i]&gt;k çš„å­¦ç”Ÿä¸åº”è¢«é€‰ä¸­ï¼›</li><li>ä¸èƒ½å­˜åœ¨ nums[i]=k çš„å­¦ç”Ÿï¼›</li></ul><p>è¿™æ„å‘³ç€åœ¨ç¡®å®šå½“å‰å·²æ‹©ä¸­å­¦ç”Ÿäººæ•°çš„å‰æä¸‹ï¼Œåˆ™æ­¤æ—¶é€‰æ‹©æ–¹æ¡ˆæ˜¯å”¯ä¸€çš„ï¼Œä¸ºæ–¹ä¾¿åˆ¤æ–­ï¼Œæˆ‘ä»¬æŠŠ nums ä»å°åˆ°å¤§æ’åºã€‚æˆ‘ä»¬æšä¸¾é€‰ä¸­çš„äººæ•° kï¼Œç”±äº nums å·²æœ‰åºï¼Œæ­¤æ—¶æœ€ä¼˜åˆ†ç»„ä¸€å®šæ˜¯å‰ k ä¸ªå­¦ç”Ÿè¢«é€‰ä¸­ï¼Œå‰©ä½™çš„ nâˆ’k ä¸ªå­¦ç”Ÿä¸è¢«é€‰ä¸­ï¼Œæ­¤æ—¶åªéœ€è¦æ£€æµ‹é€‰ä¸­çš„ k ä¸ªå­¦ç”Ÿä¸­çš„æœ€å¤§å€¼æ˜¯å¦æ»¡è¶³å°äº kï¼Œæœªè¢«é€‰ä¸­çš„å­¦ç”Ÿä¸­çš„æœ€å°å€¼æ˜¯å¦æ»¡è¶³å¤§äº k å³å¯ï¼Œå¦‚æœåŒæ—¶æ»¡è¶³ä¸Šè¿°ä¸¤ä¸ªæ¡ä»¶ï¼Œåˆ™è¯¥åˆ†é…æ–¹æ¡ˆå¯è¡Œï¼Œæœ€ç»ˆè¿”å›å¯è¡Œçš„æ–¹æ¡ˆè®¡æ•°å³å¯ï¼Œéœ€è¦æ³¨æ„å¤„ç†å¥½è¾¹ç•Œ 0 ä¸ nã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countWays</span><span class="params">(List&lt;Integer&gt; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.size();</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        Collections.sort(nums);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= n; k++) &#123;</span><br><span class="line">            <span class="comment">// å‰ k ä¸ªå…ƒç´ çš„æœ€å¤§å€¼æ˜¯å¦å°äº k</span></span><br><span class="line">            <span class="keyword">if</span> (k &gt; <span class="number">0</span> &amp;&amp; nums.get(k - <span class="number">1</span>) &gt;= k) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å n - k ä¸ªå…ƒç´ çš„æœ€å°å€¼æ˜¯å¦å¤§äº k</span></span><br><span class="line">            <span class="keyword">if</span> (k &lt; n &amp;&amp; nums.get(k) &lt;= k) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            res++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Find-the-Maximum-Length-of-a-Good-Subsequence-II"><a href="#Find-the-Maximum-Length-of-a-Good-Subsequence-II" class="headerlink" title="Find the Maximum Length of a Good Subsequence II"></a>Find the Maximum Length of a Good Subsequence II</h1><blockquote><p>Find the Maximum Length of a Good Subsequence II</p><p>You are given an integer array nums and a non-negative integer k. A sequence of integers seq is called good if there are at most k indices i in the range [0, seq.length - 2] such that seq[i] != seq[i + 1].</p><p>Return the maximum possible length of a good subsequence of nums.</p></blockquote><p>å‘¨èµ›åŸé¢˜ï¼Œå½“æ—¶DPéƒ½æ²¡æƒ³å‡ºæ¥ï¼Œè¿™å‘¨æŠŠåŸºç¡€DPæƒ³é€šäº†ï¼Œå…ˆå†™ä¸€ä¸‹ã€‚</p><ol><li>æ‹†åˆ†å­é—®é¢˜ï¼šä»seqä¸­å–å‡ºæœ€åä¸€ä¸ªï¼Œåˆ™æœ‰ä¸¤ç§æƒ…å†µ<ul><li>æƒ…å†µä¸€ï¼šseqä¸­çš„å‰åä¸ç­‰å¯¹æ•°é‡ä¸å˜ï¼Œåˆ™åŸé—®é¢˜å˜æˆäº†[0,i]ä¸Šä¸è¶…è¿‡kçš„</li><li>æƒ…å†µäºŒï¼šä¸ç­‰å¯¹æ•°é‡å‡1ï¼ŒåŸé—®é¢˜å˜æˆäº†[0,i]ä¸Šä¸è¶…è¿‡k-1çš„</li></ul></li><li>å®šä¹‰çŠ¶æ€<code>dp[i][j]</code>è¡¨ç¤ºæœ€åä¸€ä¸ªæ•°ä¸ºiæ—¶ä¸è¶…è¿‡jçš„æœ€å¤§é•¿åº¦</li><li>çŠ¶æ€è½¬ç§»ï¼š<code>dp[i][j]</code> = Max(éå†0åˆ°i-1ä¸­å’Œiä½ç½®å…ƒç´ ç›¸åŒçš„jå–æœ€å¤§, éå†[0,i-1][j-1]å–æœ€å¤§)</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maximumLength</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.length;</span><br><span class="line">        <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[n][k+<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k+<span class="number">1</span>;i++)&#123;</span><br><span class="line">            dp[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è®¡ç®—</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;k+<span class="number">1</span>;j++)&#123;</span><br><span class="line">                <span class="keyword">int</span> max = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">int</span> maxInd = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> o=<span class="number">0</span>;o&lt;i;o++)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(nums[o]==nums[i]&amp;&amp;max&lt;=dp[o][j])&#123;</span><br><span class="line">                        max = dp[o][j];</span><br><span class="line">                        maxInd = o;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(j&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">int</span> max2 = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">int</span> maxInd2 = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> o=<span class="number">0</span>;o&lt;i;o++)&#123;</span><br><span class="line">                        <span class="keyword">if</span>(max2&lt;=dp[o][j-<span class="number">1</span>])&#123;</span><br><span class="line">                            max2 = dp[o][j-<span class="number">1</span>];</span><br><span class="line">                            maxInd2 = o;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(max2&gt;max)&#123;</span><br><span class="line">                        max = max2;</span><br><span class="line">                        maxInd = maxInd2;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                dp[i][j] = max+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) res=Math.max(res, dp[i][k]);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆä¸ºä»€ä¹ˆè¿™é“é¢˜ä¸èƒ½ç”¨01èƒŒåŒ…çš„çŠ¶æ€æ¥åšå‘¢ï¼Ÿçœ‹èµ·æ¥ä¸å°±æ˜¯ä¸€ä¸ªä»ä¸€å †å…ƒç´ ä¸­é€‰è‹¥å¹²ä¸ªçš„é—®é¢˜å—ï¼Ÿè¿™æ˜¯å› ä¸º01èƒŒåŒ…ä¸­ï¼ŒèƒŒåŒ…å®¹é‡å®é™…ä¸ŠåŒ…å«äº†å‰åºé€‰æ‹©ä¿¡æ¯çš„æœ€ä¼˜è§£ï¼Œå³åœ¨å½“å‰èƒŒåŒ…å®¹é‡æ”¯æŒæ”¾å…¥å½“å‰ç‰©å“æ—¶ä¸€å®šä¼šé€‰æ‹©æ”¾å…¥ã€‚è€Œå¯¹äºæœ¬é¢˜æ¥è¯´ï¼Œå½“å‰çŠ¶æ€çš„å‰ä¸€ä¸ªæˆ–ä¸Šä¸€ä¸ªï¼ˆæŒ‡j-1å’Œi-1ï¼‰çŠ¶æ€å¹¶ä¸ä¸€å®šæ˜¯å¯¹äºæœ¬çŠ¶æ€è½¬ç§»æ¥è¯´æœ€ä¼˜çš„ï¼Œå› ä¸ºå½“å‰å…ƒç´ å’Œå‰åºå…ƒç´ ä¸­çš„æŸä¸ªå€¼åŒ¹é…æ—¶äº§ç”Ÿäº†æ›´ä¼˜è§£ï¼Œè€Œè¿™ä¸ªæ›´ä¼˜è§£æ˜¯éšéå†å…ƒç´ ä¸æ–­å˜åŠ¨çš„ã€‚</p><p>æƒ³é€šäº†è¿™ä¸€ç‚¹ï¼Œèˆ’æœå¤šäº†ã€‚ã€‚ã€‚å½“æ—¶å›°æ‰°æˆ‘å¥½å‡ å¤©ã€‚</p><p>ç„¶è€Œä¸Šé¢çš„æ–¹æ³•åœ¨å¤§æ•°æ®èŒƒå›´ä¸‹è¿˜æ˜¯ä¸è¡Œï¼Œå­˜åœ¨å¤ªå¤šå¾ªç¯è®¡ç®—ï¼Œä¸‹é¢ä»‹ç»ä¼˜åŒ–æ–¹æ¡ˆã€‚</p><h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><p>PSï¼šè¿™é¢˜è§£å†™çš„ä¾æ‰˜ï¼Œè¿˜æ˜¯çœ‹æˆ‘ä¹‹å‰å‘¨èµ›æ—¶å€™çš„é¢˜è§£å§ã€‚</p><p>æˆ‘ä»¬åœ¨ä¸Šé¢çš„æ–¹æ¡ˆåŸºç¡€ä¸Šä¼˜åŒ–ï¼Œä¸Šé¢çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(n^2k)$ã€‚å‡è®¾å½“å‰å…ƒç´ <code>i</code>çš„å‰åºå…ƒç´ ä¸º<code>x</code>ï¼Œå¯ä»¥æšä¸¾ä¸¤ç§æƒ…å†µï¼š</p><ul><li><p>nums $[i] \neq n u m s[x]$, å¯¹äºæ­¤æƒ…å†µ, å¯ä»¥ç»´æŠ¤ä¸€ä¸ªé•¿åº¦ä¸º $k$ çš„è¾…åŠ©æ•°ç»„ $z d$ ã€‚å…¶ä¸­ $z d[j]$ è¡¨ç¤ºæšä¸¾åˆ°ä½ç½® $i$ ä¹‹å‰ï¼Œæœ‰ $j$ ä¸ªæ•°å­—ä¸å…¶åœ¨åºåˆ—ä¸­çš„åä¸€ä¸ªä¸ç›¸ç­‰çš„æœ€é•¿åˆæ³•åºåˆ—çš„é•¿åº¦ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥å†™å‡ºè½¬ç§» $d p[i][j]=z d[j-1]+1$ ã€‚</p></li><li><p>nums $[i]=n u m s[x]$, å‡è®¾æœ‰ä¸‹æ ‡ $a&lt;b&lt;c$, å¹¶ä¸” nums $[a]=$ $n u m s[b]=\operatorname{nums}[c]$, å¯¹äº $c$ æ¥è¯´å¦‚æœé€‰å–ç”± $a$ è½¬ç§»è¿‡æ¥è®¡ç®—ç­”æ¡ˆ, é‚£ä¹ˆä¸€å®šä¸å¦‚ $a \rightarrow b \rightarrow c$ æ›´ä¼˜, æ‰€ä»¥ä¼šé€‰å–ä¸‹æ ‡æœ€è¿‘çš„ç›¸åŒçš„æ•°è¿›è¡Œè½¬ç§»ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œ $d p$ ä½¿ç”¨å“ˆå¸Œè¡¨ç»´æŠ¤èƒ½èŠ‚çœä¸€äº›ç©ºé—´ï¼Œå¹¶ä¸”åœ¨å“ˆå¸Œè¡¨ä¸­ç”¨ $n u m s[i]$ æ›¿æ¢ $i$ ã€‚</p></li></ul><p>åœ¨æ¯ä¸€æ¬¡éå† $i$ è®¡ç®—å®Œåæ›´æ–° $z d$ ï¼Œæœ€åçš„ $z d[k]$ å°±æ˜¯ç­”æ¡ˆã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maximumLength</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = nums.length;</span><br><span class="line">        Map&lt;Integer, <span class="keyword">int</span>[]&gt; dp = <span class="keyword">new</span> HashMap&lt;Integer, <span class="keyword">int</span>[]&gt;();</span><br><span class="line">        <span class="keyword">int</span>[] zd = <span class="keyword">new</span> <span class="keyword">int</span>[k + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> v = nums[i];</span><br><span class="line">            dp.putIfAbsent(v, <span class="keyword">new</span> <span class="keyword">int</span>[k + <span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span>[] tmp = dp.get(v);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= k; j++) &#123;</span><br><span class="line">                tmp[j] = tmp[j] + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (j &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    tmp[j] = Math.max(tmp[j], zd[j - <span class="number">1</span>] + <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= k; j++) &#123;</span><br><span class="line">                zd[j] = Math.max(zd[j], tmp[j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> zd[k];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://leetcode.cn/problems/happy-students/solutions/2895368/rang-suo-you-xue-sheng-bao-chi-kai-xin-d-45br/?envType=daily-question&amp;envId=2024-09-04">https://leetcode.cn/problems/happy-students/solutions/2895368/rang-suo-you-xue-sheng-bao-chi-kai-xin-d-45br/?envType=daily-question&amp;envId=2024-09-04</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è¿™å‘¨æ„Ÿè§‰è¿˜å¯ä»¥å§ï¼Œæœ‰ä¸¤é“å‘¨èµ›åšè¿‡çš„é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªæ„Ÿæ‚Ÿæ˜¯ï¼Œåšé¢˜è¦éµå®ˆåŸºæœ¬æ³•ï¼Œç©ºé—´å’Œæ—¶é—´æ˜¯æ­¤æ¶ˆå½¼é•¿çš„ï¼ŒåŠ¨æ€è§„åˆ’çš„çŠ¶æ€å®šä¹‰ä¹Ÿæ˜¯æœ‰ç« å¯å¾ªçš„ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨ä¸»é¢˜ï¼šæ»‘åŠ¨çª—å£ã€æšä¸¾ã€åŠ¨æ€è§„åˆ’&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;240902æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/maximize-the-confusion-of-an-exam/description&quot;&gt;Maximize the Confusion of an Exam&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240905æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/happy-students/description&quot;&gt;Happy Students&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240907æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/find-the-maximum-length-of-a-good-subsequence-ii/description&quot;&gt;Find the Maximum Length of a Good Subsequence II&lt;/a&gt;</summary>
    
    
    
    
    <category term="LeetCode" scheme="http://silencezheng.top/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeå‘¨è®° EP10</title>
    <link href="http://silencezheng.top/2024/09/01/article137/"/>
    <id>http://silencezheng.top/2024/09/01/article137/</id>
    <published>2024-08-31T17:12:14.000Z</published>
    <updated>2024-10-27T15:28:55.225Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>DPDPDP</p><p>æœ¬å‘¨ä¸»é¢˜ï¼šäºŒåˆ†æŸ¥æ‰¾ã€åŠ¨æ€è§„åˆ’ã€è®°å¿†åŒ–æœç´¢</p><p>é¢˜ç›®ï¼š</p><ul><li>240827æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/find-the-median-of-the-uniqueness-array/description">Find the Median of the Uniqueness Array</a></li><li>240828æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/minimum-substring-partition-of-equal-character-frequency/description">Minimum Substring Partition of Equal Character Frequency</a><span id="more"></span><h1 id="Find-the-Median-of-the-Uniqueness-Array"><a href="#Find-the-Median-of-the-Uniqueness-Array" class="headerlink" title="Find the Median of the Uniqueness Array"></a>Find the Median of the Uniqueness Array</h1><blockquote><p>Find the Median of the Uniqueness Array</p><p>You are given an integer array nums. The uniqueness array of nums is the sorted array that contains the number of distinct elements of all the subarrays of nums. In other words, it is a sorted array consisting of distinct(nums[i..j]), for all 0 &lt;= i &lt;= j &lt; nums.length.</p><p>Here, distinct(nums[i..j]) denotes the number of distinct elements in the subarray that starts at index i and ends at index j.</p><p>Return the median of the uniqueness array of nums.</p><p>Note that the median of an array is defined as the middle element of the array when it is sorted in non-decreasing order. If there are two choices for a median, the smaller of the two values is taken.</p></blockquote></li></ul><p>å®¹æ˜“åˆ†æå‡ºä»¥ä¸‹è§£é¢˜æ­¥éª¤ï¼š</p><ol><li>find out a way to express all the subarrays<ol><li>which means 0,0\1,1...\n-1,n-1; 0,1\1,2...\n-2,n-1; â€¦ 0,n-2\1,n-1; 0,n-1</li><li>we can find out there were n+n-1+â€¦+2+1 subarrays in total.</li><li>which means there were (n*(n+1))/2 elements in uniqueness array.</li></ol></li><li>find out how many â€œdistinctorsâ€ in there<ol><li>the max value of them should be 1,2,â€¦,n</li><li>we can find a way to calculate them from the base subarrs, like from 1 number</li></ol></li></ol><p>æ€»ç»“ä¸€ä¸‹ï¼š</p><ol><li>uniqueness arrayä¸­ä¸€å…±æœ‰(n<em>(n+1))/2ä¸ªå…ƒç´ ï¼Œä¸­ä½æ•°ä½ç½®åœ¨(n</em>(n+1))/4å‘ä¸‹å–æ•´ã€‚</li><li>è¿™äº›å…ƒç´ å¯ä»¥è¢«åˆ†ç±»ï¼Œå…¶ä¸­nä¸ªçš„èŒƒå›´ä¸º[1, 1]ï¼Œn-1ä¸ªçš„èŒƒå›´ä¸º[1, 2]ï¼Œâ€¦ï¼Œ1ä¸ªçš„èŒƒå›´ä¸º[1, n]ã€‚</li></ol><p>åŸºäºä»¥ä¸Šåˆ†æï¼Œå¯ä»¥å†™å‡ºæš´åŠ›æ³•ï¼Œæ˜¾ç„¶è¶…æ—¶ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">medianOfUniquenessArray</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.length;</span><br><span class="line">        Set&lt;Integer&gt;[] sets = <span class="keyword">new</span> HashSet[n];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            sets[i] = <span class="keyword">new</span> HashSet&lt;Integer&gt;();</span><br><span class="line">            sets[i].add(nums[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) list.add(sets[i].size());</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n-i;j++)&#123;</span><br><span class="line">                sets[j].add(nums[i+j]);</span><br><span class="line">                list.add(sets[j].size());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Collections.sort(list);</span><br><span class="line">        <span class="keyword">return</span> list.size()%<span class="number">2</span>==<span class="number">0</span>?list.get(list.size()/<span class="number">2</span>-<span class="number">1</span>):list.get(list.size()/<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å‘ç°ä¸Šè¿°æ€»ç»“2ä¸­å­˜åœ¨å•è°ƒæ€§ï¼Œè€ƒè™‘ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ã€‚</p><h2 id="äºŒåˆ†æŸ¥æ‰¾"><a href="#äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾"></a>äºŒåˆ†æŸ¥æ‰¾</h2><p>è®¾æ•°ç»„ nums çš„é•¿åº¦ä¸º $n$, æˆ‘ä»¬ä»¤ $c_t$ è¡¨ç¤ºæ•°ç»„ nums ä¸­è‡³å¤šå«æœ‰ $t$ ä¸ªä¸åŒå…ƒç´ çš„å­æ•°ç»„æ•°ç›®ï¼Œå®é™… $t$ çš„å–å€¼èŒƒå›´ä¸ºï¼š $t \in[1, \operatorname{distinct}[0 \cdots n-1]]$ ã€‚æ­¤æ—¶å¯ä»¥å‘ç° $t$ è¶Šå¤§ï¼Œåˆ™ $c_t$ ä¹Ÿè¶Šå¤§, ä¸”æ»¡è¶³ $c_n=\frac{n \times(n+1)}{2}$ ã€‚æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ° $c_t$ å‘ˆç°å•è°ƒæ€§, å› æ­¤å¯ä»¥è€ƒè™‘ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾, å¦‚æœ $c_t&lt;$ median åˆ™ $t$ ä¸€å®šä¸æ˜¯ä¸­ä½æ•°, å› æ­¤åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾æ‰¾åˆ° $t$ çš„ä¸Šé™, æ­¤æ—¶æ‰¾åˆ°æ»¡è¶³ $c_t \geq$ median æ—¶æœ€å°çš„ $t$, å³ä¸ºå”¯ä¸€æ€§æ•°ç»„çš„ä¸­ä½æ•°ã€‚</p><p>å› æ­¤éœ€è¦å¯»æ‰¾ä¸€ç§æ–¹æ³•è®¡ç®—$c_t$ï¼Œæ³¨æ„åˆ°è‹¥æ•°ç»„$nums[i, j]$ä¸­è‡³å¤šå«æœ‰ $t$ ä¸ªä¸åŒå…ƒç´ ï¼Œåˆ™è¯¥æ•°ç»„çš„æ‰€æœ‰å­æ•°ç»„ä¹Ÿè‡³å¤šå«æœ‰ $t$ ä¸ªä¸åŒå…ƒç´ ã€‚è¿™é‡Œ$nums[i, j]$å¯ä»¥ç”¨ä¸€ä¸ªçª—å£è¡¨ç¤ºï¼Œå³åŒæŒ‡é’ˆã€‚$c_t$éš$t$å•è°ƒä¸å‡ï¼Œå¯ä»¥ç”¨äºŒåˆ†æŸ¥æ‰¾æ‰¾åˆ°åˆé€‚çš„tï¼Œåˆ¤å®šæ˜¯å¦åˆé€‚çš„æ¡ä»¶æ˜¯æ˜¯å¦$c_t \geq$ medianï¼Œå¦‚æœæ˜¯çš„è¯åˆ™ç¼©å°$t$ï¼Œå¦åˆ™å¢åŠ $t$ã€‚</p><p>å­æ•°ç»„è¶Šé•¿, åˆ™ä¸åŒå…ƒç´ ä¸ªæ•°åªä¼šå˜å¤§æˆ–ä¸å˜ï¼Œæ»¡è¶³å•è°ƒæ€§ã€‚æˆ‘ä»¬ç”¨å“ˆå¸Œè¡¨ cnt ç»Ÿè®¡çª—å£å­æ•°ç»„ $n u m s[i \cdots j]$ ä¸­ä¸åŒå…ƒç´ å‡ºç°çš„æ¬¡æ•°ã€‚æšä¸¾çª—å£å³ç«¯ç‚¹ $i$ ï¼ŒæŠŠ $n u m s[i]$ åŠ å…¥åˆ°å“ˆå¸Œè¡¨ cnt ä¸­, å³æ­¤æ—¶ $n u m s[i]$ å‡ºç°æ¬¡æ•°åŠ  1 ã€‚å¦‚æœå“ˆå¸Œè¡¨ cnt ä¸­å…ƒç´ çš„æ•°ç›®è¶…è¿‡ $t$ ï¼Œå°±ä¸æ–­ç§»å‡ºçª—å£å·¦ç«¯ç‚¹å…ƒç´  $n u m s[j]$ ï¼Œå³æ­¤æ—¶ $n u m s[j]$ å‡ºç°çš„æ¬¡æ•°å‡å» 1 ï¼Œå¦‚æœ nums $[j]$ å‡ºç°æ¬¡æ•°ç­‰äº 0 , åˆ™å°†å…¶ä»å“ˆå¸Œè¡¨ cnt ä¸­ç§»é™¤, ç›´åˆ° cnt ä¸­å…ƒç´ çš„æ•°ç›®ç­‰äº $t$ ä¸ºæ­¢ã€‚æ­¤æ—¶çª—å£çš„å³ç«¯ç‚¹ä¸º $i$, åˆ™æ­¤æ—¶å­æ•°ç»„ nums $[j \cdots i]$, nums $[j+1 \cdots i]$, nums $[j+$ $2 \cdots i], \cdots$, nums $[i \cdots i]$ éƒ½æ»¡è¶³ä¸åŒå…ƒç´ æ•°ç›®å°äºç­‰äº $t$, ä¸€å…±æœ‰ $i-j+1$ ä¸ª, åŠ åˆ°æ€»æ•° tot ä¸­, æœ€ç»ˆçš„æ€»æ•° $c_t=t o t$ ã€‚æˆ‘ä»¬æ¯æ¬¡æ£€æµ‹æ˜¯å¦æ»¡è¶³ $c_t \geq$ median, å¦‚æœæ»¡è¶³åˆ™ç¼©å° $t$, ç›´åˆ°æ‰¾åˆ°æœ€å°çš„ $t$ è¿”å›å³å¯ã€‚</p><p>å®é™…äºŒåˆ†æŸ¥æ‰¾æ—¶, $t$ çš„ä¸‹é™å– 1 , æ­¤æ—¶ä¸€å®šä¸å­˜åœ¨ 0 ä¸ªå…ƒç´ çš„å­æ•°ç»„, $t$ çš„ä¸Šé™ä¸º $n$, æ‰€æœ‰å­æ•°ç»„çš„ä¸åŒå…ƒç´ æ•°ç›®ä¸è¶…è¿‡ $n$ ã€‚è®¾ $m=\operatorname{distinct}[0 \cdots n-1]$ ï¼Œå®é™… $t$ çš„å–å€¼èŒƒå›´ä¸º $[1, m]$ ï¼Œä¸”åœ¨è¯¥åŒºé—´ $[1, m]$ ä¸Šçš„å–å€¼è¿ç»­ï¼Œå› æ­¤ä¸€å®šå¯ä»¥æ‰¾åˆ°å±äºæŸä¸ªå­æ•°ç»„çš„ distinct å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">medianOfUniquenessArray</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.length;</span><br><span class="line">        <span class="keyword">long</span> median = ((<span class="keyword">long</span>) n * (n + <span class="number">1</span>) / <span class="number">2</span> + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> lo = <span class="number">1</span>, hi = n;</span><br><span class="line">        <span class="keyword">while</span> (lo &lt;= hi) &#123;</span><br><span class="line">            <span class="keyword">int</span> mid = (lo + hi) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (check(nums, mid, median)) &#123;</span><br><span class="line">                res = mid;</span><br><span class="line">                hi = mid - <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                lo = mid + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æµ‹æ•°ç»„ä¸­ä¸åŒå…ƒç´ æ•°ç›®å°äºç­‰äº t çš„è¿ç»­å­æ•°ç»„æ•°ç›®æ˜¯å¦å¤§äºç­‰äº median</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> t, <span class="keyword">long</span> median)</span> </span>&#123;</span><br><span class="line">        HashMap&lt;Integer, Integer&gt; cnt = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">long</span> tot = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// jï¼Œiä¸ºå·¦å³æŒ‡é’ˆï¼Œéå†æ•°ç»„è®¡ç®—c_t</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            cnt.put(nums[i], cnt.getOrDefault(nums[i], <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span> (cnt.size() &gt; t) &#123;</span><br><span class="line">                cnt.put(nums[j], cnt.get(nums[j]) - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (cnt.get(nums[j]) == <span class="number">0</span>) &#123;</span><br><span class="line">                    cnt.remove(nums[j]);</span><br><span class="line">                &#125;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">            tot += i - j + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> tot &gt;= median;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Minimum-Substring-Partition-of-Equal-Character-Frequency"><a href="#Minimum-Substring-Partition-of-Equal-Character-Frequency" class="headerlink" title="Minimum Substring Partition of Equal Character Frequency"></a>Minimum Substring Partition of Equal Character Frequency</h1><blockquote><p>Minimum Substring Partition of Equal Character Frequency</p><p>Given a string s, you need to partition it into one or more balanced<br>substrings. For example, if s == â€œababccâ€ then (â€œababâ€, â€œcâ€, â€œcâ€), (â€œabâ€, â€œabcâ€, â€œcâ€), and (â€œababccâ€) are all valid partitions, but (â€œaâ€, â€œbabâ€, â€œccâ€), (â€œabaâ€, â€œbcâ€, â€œcâ€), and (â€œabâ€, â€œabccâ€) are not. The unbalanced substrings are bolded.Return the minimum number of substrings that you can partition s into.</p><p>Note: A balanced string is a string where each character in the string occurs the same number of times.</p></blockquote><p>ä»¥åçœ‹åˆ°è¿™ç§æœ€å€¼é€‰å…ƒç´ çš„â€¦ç›´æ¥å¼€DPå°±å®Œäº†ï¼Œæœ€å·®ä¹Ÿæ˜¯ç­‰åŒæš´åŠ›å§ã€‚</p><h2 id="è®°å¿†åŒ–æœç´¢"><a href="#è®°å¿†åŒ–æœç´¢" class="headerlink" title="è®°å¿†åŒ–æœç´¢"></a>è®°å¿†åŒ–æœç´¢</h2><p>é¦–å…ˆå¯ä»¥ç¡®å®šä¸€å®šå­˜åœ¨åˆ†å‰²æ–¹æ¡ˆï¼ˆéƒ½åˆ†æˆå•å­—æ¯ï¼‰ã€‚</p><p>å¯¹äºä¸€ä¸ªå­—ç¬¦ä¸²<code>s</code>ï¼Œä»æœ«å°¾åˆ†å‰²å‡ºé•¿åº¦ä¸º<code>x</code>çš„å¹³è¡¡å­ä¸²ï¼Œåˆ™é—®é¢˜å˜æˆå‰©ä½™å­—ç¬¦ä¸²æœ€å°‘èƒ½åˆ†å‰²å‡ºå¤šå°‘ä¸ªå¹³è¡¡å­ä¸²ã€‚è¿™å°†åŸé—®é¢˜åˆ†è§£ä¸º<strong>ç›¸ä¼¼ä¸”è§„æ¨¡æ›´å°çš„å­é—®é¢˜</strong>ï¼Œå¯ä»¥é€’å½’æ±‚è§£ã€‚</p><blockquote><p>æ³¨ 1ï¼šä»å³å¾€å·¦æ€è€ƒï¼Œä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿æŠŠé€’å½’ç¿»è¯‘æˆé€’æ¨ã€‚ä»å·¦å¾€å³æ€è€ƒä¹Ÿæ˜¯å¯ä»¥çš„ã€‚<br>æ³¨ 2ï¼šåŠ¨æ€è§„åˆ’æœ‰ã€Œé€‰æˆ–ä¸é€‰ã€å’Œã€Œæšä¸¾é€‰å“ªä¸ªã€ä¸¤ç§åŸºæœ¬æ€è€ƒæ–¹å¼ã€‚åœ¨åšé¢˜æ—¶ï¼Œå¯æ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œé€‰æ‹©é€‚åˆé¢˜ç›®çš„ä¸€ç§æ¥æ€è€ƒã€‚æœ¬é¢˜ç”¨åˆ°çš„æ˜¯ã€Œæšä¸¾é€‰å“ªä¸ªã€ã€‚<br>æ³¨ 3ï¼šè¿™é‡Œçš„æ€è€ƒå¯ä»¥ç†è§£æˆä»â€œæœ€åä¸€æ­¥â€å‡ºå‘ï¼Œåˆ’åˆ†å­é—®é¢˜ï¼Œå³æœ€åä¸€æ­¥ä¸€å®šæ˜¯åˆ’åˆ†å‡ºä¸€ä¸ªå¹³è¡¡å­ä¸²ï¼Œåˆ™è€ƒè™‘å‰©ä½™éƒ¨åˆ†çš„å­é—®é¢˜å³å¯ï¼Œæ­¤æ—¶åˆ’åˆ†å‡ºæœ€åä¸€æ­¥ä¸å½±å“å‰©ä½™éƒ¨åˆ†çš„æ­£ç¡®æ±‚è§£ã€‚åè§‚è´ªå¿ƒï¼Œå¦‚æœå°è¯•ä¸€æ¬¡æ‰¾åˆ°ä¸€ä¸ªæœ€é•¿çš„å¹³è¡¡å­ä¸²ï¼Œåˆ™å¯èƒ½å½±å“æ•´ä½“æœ€ä¼˜ï¼Œå› æ­¤è¿™ç±»é—®é¢˜æœ€å¥½é€šè¿‡DP+æšä¸¾è§£å†³ã€‚</p></blockquote><p>ä¸‹é¢è€ƒè™‘<strong>çŠ¶æ€å®šä¹‰ä¸è½¬ç§»</strong>ï¼Œå‡è®¾å‰©ä½™å‰ç¼€å­—ç¬¦ä¸²ä¸º<code>s[0...i]</code>ï¼Œå®šä¹‰çŠ¶æ€<code>f(i)</code>ä¸ºå‰©ä½™<code>s[0...i]</code>æ—¶æœ€å°‘èƒ½åˆ†å‰²å‡ºå¤šå°‘å¹³è¡¡å­ä¸²ï¼Œåˆ™å¯ä»¥é€šè¿‡æšä¸¾<code>j=0,1,..,i</code>ï¼Œæ‰¾åˆ°å¹³è¡¡å­ä¸²<code>s[j...i]</code>ï¼Œåˆ™é—®é¢˜è½¬åŒ–ä¸ºæ±‚è§£çŠ¶æ€ <code>f(j-1)</code>ï¼Œå®ç°é€’å½’æ±‚è§£<code>f(i)</code>ã€‚å¯ä»¥æšä¸¾æ‰€æœ‰<code>j</code>ï¼Œæ‰¾åˆ°æœ€å°çš„<code>f(j-1)</code>ã€‚</p><p>æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥<strong>å¿«é€Ÿåˆ¤æ–­å­ä¸²å¹³è¡¡</strong>ï¼Œå³åœ¨å€’åºæšä¸¾<code>j</code>çš„åŒæ—¶ï¼Œç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼ˆæˆ–è€…æ•°ç»„ï¼‰ç»Ÿè®¡å­ä¸²<code>s[j...i]</code>æ¯ä¸ªå­—ç¬¦çš„å‡ºç°æ¬¡æ•°ã€‚å¦‚æœå­ä¸²ä¸­æ¯ä¸ªå­—æ¯çš„å‡ºç°æ¬¡æ•°éƒ½ç›¸ç­‰ï¼Œé‚£ä¹ˆå­ä¸²æ˜¯å¹³è¡¡çš„ã€‚è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œè®¾å­ä¸²<code>s[j...i]</code>ä¸­æœ‰<code>k</code>ç§å­—æ¯ï¼Œå­—æ¯å‡ºç°æ¬¡æ•°çš„æœ€å¤§å€¼ä¸º<code>maxCnt</code>ã€‚å­ä¸²æ˜¯å¹³è¡¡çš„ï¼Œå½“ä¸”ä»…å½“å­ä¸²é•¿åº¦<code>iâˆ’j+1</code>ç­‰äº<code>kâ‹…maxCnt</code>ã€‚</p><p>åŸé—®é¢˜è¡¨ç¤ºä¸º<code>f(n-1)</code>ï¼Œåˆ™å¯é€’å½’è®¡ç®—ï¼š<code>f(n-1) = 1+f(x) = ... = m + f(-1) = m</code>ã€‚å…¶ä¸­<code>x</code>è¡¨ç¤ºç¬¬ä¸€æ¬¡æ±‚å¾—çš„æœ€å°<code>f(j-1)</code>å¯¹åº”çš„<code>j</code>ï¼Œ<code>m</code>è¡¨ç¤ºæœ€ç»ˆåˆ’åˆ†å‡ºçš„å¹³è¡¡å­ä¸²æ•°é‡ã€‚åˆ†æè‡³æ­¤å¯ä»¥å†™å‡ºæš´åŠ›é€’å½’è§£æ³•ä¸€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minimumSubstringsInPartition</span><span class="params">(String S)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span>[] s = S.toCharArray();</span><br><span class="line">        <span class="keyword">int</span> n = s.length;</span><br><span class="line">        <span class="keyword">return</span> dfs(n - <span class="number">1</span>, s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">char</span>[] s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = Integer.MAX_VALUE;</span><br><span class="line">        <span class="keyword">int</span>[] cnt = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">int</span> k = <span class="number">0</span>, maxCnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">            k += cnt[s[j] - <span class="string">&#x27;a&#x27;</span>]++ == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">            maxCnt = Math.max(maxCnt, cnt[s[j] - <span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">            <span class="keyword">if</span> (i - j + <span class="number">1</span> == k * maxCnt) &#123;</span><br><span class="line">                res = Math.min(res, dfs(j - <span class="number">1</span>, s) + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æš´åŠ›é€’å½’åœ¨æ•°æ®èŒƒå›´å¤§çš„æƒ…å†µä¸‹ä¾ç„¶ä¼šTTLï¼Œæ³¨æ„åˆ°æšä¸¾<code>j</code>çš„è¿‡ç¨‹ä¸­å­˜åœ¨å¤§é‡é‡å¤è®¡ç®—ï¼Œè€ƒè™‘ä½¿ç”¨è®°å¿†åŒ–å‡å°‘è®¡ç®—ã€‚ç”±äºé€’å½’å‡½æ•°å¹‚ç­‰ï¼Œå¯ä»¥å¯¹<code>å…¥å‚+è¿”å›</code>çš„ç»„åˆè¿›è¡Œè®°å¿†åŒ–ã€‚ä½¿ç”¨ä¸€ä¸ªæ•°ç»„<code>memo</code>æ¥è®°å½•ï¼š</p><ul><li>å¦‚æœä¸€ä¸ªçŠ¶æ€ï¼ˆé€’å½’å…¥å‚ï¼‰æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨è¿”å›å‰ï¼ŒæŠŠçŠ¶æ€åŠå…¶ç»“æœè®°åˆ°ä¸€ä¸ª memo æ•°ç»„ä¸­ã€‚</li><li>å¦‚æœä¸€ä¸ªçŠ¶æ€ä¸æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°ï¼ˆmemo ä¸­ä¿å­˜çš„ç»“æœä¸ç­‰äº memo çš„åˆå§‹å€¼ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥è¿”å› memo ä¸­ä¿å­˜çš„ç»“æœã€‚</li></ul><p>æ³¨æ„<code>memo</code>æ•°ç»„çš„åˆå§‹å€¼ä¸€å®šä¸èƒ½ç­‰äºè¦è®°å¿†åŒ–çš„å€¼ï¼Œå¦åˆ™ä¼šè·³è¿‡é¦–æ¬¡è®¡ç®—ã€‚å› ä¸ºé€’å½’æ±‚è§£ç­‰åŒäºé€’å½’æœç´¢ï¼Œæ­¤ç±»ç®—æ³•äº¦å¯ç§°ä¸º<strong>è®°å¿†åŒ–æœç´¢</strong>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minimumSubstringsInPartition</span><span class="params">(String S)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span>[] s = S.toCharArray();</span><br><span class="line">        <span class="keyword">int</span> n = s.length;</span><br><span class="line">        <span class="keyword">int</span>[] memo = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        <span class="keyword">return</span> dfs(n - <span class="number">1</span>, s, memo);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">char</span>[] s, <span class="keyword">int</span>[] memo)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (memo[i] &gt; <span class="number">0</span>) &#123; <span class="comment">// ä¹‹å‰è®¡ç®—è¿‡</span></span><br><span class="line">            <span class="keyword">return</span> memo[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = Integer.MAX_VALUE;</span><br><span class="line">        <span class="keyword">int</span>[] cnt = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">int</span> k = <span class="number">0</span>, maxCnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">            k += cnt[s[j] - <span class="string">&#x27;a&#x27;</span>]++ == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">            maxCnt = Math.max(maxCnt, cnt[s[j] - <span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">            <span class="keyword">if</span> (i - j + <span class="number">1</span> == k * maxCnt) &#123;</span><br><span class="line">                res = Math.min(res, dfs(j - <span class="number">1</span>, s, memo) + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        memo[i] = res; <span class="comment">// è®°å¿†åŒ–</span></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><p>è®°å¿†åŒ–æœç´¢ä¸ºè‡ªé¡¶å‘ä¸‹è®¡ç®—ï¼Œå³ä»<code>f(n-1)</code>å¼€å§‹é€’å½’æœç´¢ã€‚åŠ¨æ€è§„åˆ’åˆ™æ˜¯è€ƒè™‘è‡ªåº•å‘ä¸Šçš„è®¡ç®—ï¼Œå³ä»<code>f(0)</code>å¼€å§‹è®¡ç®—ã€‚</p><p>å®šä¹‰çŠ¶æ€<code>dp[i]</code>è¡¨ç¤ºå‰©ä½™å­—ç¬¦ä¸²ä¸º<code>s[0...i]</code>æ—¶æœ€å°‘èƒ½åˆ†å‰²å‡ºå¤šå°‘å¹³è¡¡å­ä¸²ï¼Œåˆ™æœ‰çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">dp[i] = \min _{j=0}^i dp[j]+1ï¼Œå…¶ä¸­s[j...i]å¹³è¡¡</script><p>å¦å¤–ç”±äºé€’å½’è¾¹ç•Œä¸º<code>f(-1)</code>ï¼Œåˆ™ç”¨<code>dp[0]</code>å­˜æ”¾åˆå§‹çŠ¶æ€<code>dp[0] = 0</code>ï¼Œå‰©ä½™çŠ¶æ€å³ç§»ä¸€ä½ï¼ˆé€’å½’è¾¹ç•Œå¯¹åº”DPåˆçŠ¶æ€ï¼‰ã€‚æœ€ç»ˆè¿”å›ç»“æœä¸º<code>dp[n]</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minimumSubstringsInPartition</span><span class="params">(String S)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span>[] s = S.toCharArray();</span><br><span class="line">        <span class="keyword">int</span> n = s.length;</span><br><span class="line">        <span class="keyword">int</span>[] dp = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">1</span>];</span><br><span class="line">        Arrays.fill(dp, Integer.MAX_VALUE);</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span>[] cnt = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            Arrays.fill(cnt, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> maxCnt = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">                k += cnt[s[j] - <span class="string">&#x27;a&#x27;</span>]++ == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">                maxCnt = Math.max(maxCnt, cnt[s[j] - <span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">                <span class="keyword">if</span> (i - j + <span class="number">1</span> == k * maxCnt) &#123;</span><br><span class="line">                    dp[i + <span class="number">1</span>] = Math.min(dp[i + <span class="number">1</span>], dp[j] + <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://leetcode.cn/problems/minimum-substring-partition-of-equal-character-frequency/solutions/2775377/hua-fen-xing-dpji-yi-hua-sou-suo-di-tui-s1nq0/?envType=daily-question&amp;envId=2024-08-28">https://leetcode.cn/problems/minimum-substring-partition-of-equal-character-frequency/solutions/2775377/hua-fen-xing-dpji-yi-hua-sou-suo-di-tui-s1nq0/?envType=daily-question&amp;envId=2024-08-28</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;DPDPDP&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨ä¸»é¢˜ï¼šäºŒåˆ†æŸ¥æ‰¾ã€åŠ¨æ€è§„åˆ’ã€è®°å¿†åŒ–æœç´¢&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;240827æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/find-the-median-of-the-uniqueness-array/description&quot;&gt;Find the Median of the Uniqueness Array&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240828æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/minimum-substring-partition-of-equal-character-frequency/description&quot;&gt;Minimum Substring Partition of Equal Character Frequency&lt;/a&gt;</summary>
    
    
    
    
    <category term="LeetCode" scheme="http://silencezheng.top/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeå‘¨è®° EP9</title>
    <link href="http://silencezheng.top/2024/08/25/article136/"/>
    <id>http://silencezheng.top/2024/08/25/article136/</id>
    <published>2024-08-24T17:08:04.000Z</published>
    <updated>2024-10-27T15:28:59.325Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‘¨èµ›ä¾ç„¶æ²¡ç©ºæ‰“ï¼Œé¢ç¬”å¤ªå¤šè¾½ï¼Œæ„Ÿè§‰è¿™å‘¨æ•°ä½é¢˜æ¯”è¾ƒå¤šï¼Œå†™å‘¨å…­çš„hardé¢˜ç”¨äº†ä¸¤ä¸ªå°æ—¶è¿˜æ˜¯æ²¡èƒ½å…¨Aï¼Œä¸è¿‡æ€è·¯æ²¡é—®é¢˜ï¼Œè¡¨æ‰¬ä¸€ä¸‹è‡ªå·±ã€‚</p><p>æœ¬å‘¨ä¸»é¢˜ï¼šä¸‰ç»´åŠ¨æ€è§„åˆ’ï¼ˆä¸‰ä¸ªé™åˆ¶ï¼‰ã€ç»„åˆæ•°å­¦ã€ä½è¿ã€çŠ¶æ€å‹ç¼©DP</p><p>é¢˜ç›®ï¼š</p><ul><li>240819æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/student-attendance-record-ii/description">Student Attendance Record II</a></li><li>240820æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/find-number-of-ways-to-reach-the-k-th-stair/description">Find Number of Ways to Reach the K-th Stair</a></li><li>240822æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/minimum-array-end/description">Minimum Array End</a></li><li>240823æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/find-products-of-elements-of-big-array/description">Find Products of Elements of Big Array</a></li><li>240824æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/partition-to-k-equal-sum-subsets/description">Partition to K Equal Sum Subsets</a></li></ul><p>PSï¼šè…¾å­éŸ³ä¹çš„ç¬”ä¹Ÿå¿’éš¾äº†<br><span id="more"></span></p><h1 id="Student-Attendance-Record-II-ï¼ˆHARDï¼‰"><a href="#Student-Attendance-Record-II-ï¼ˆHARDï¼‰" class="headerlink" title="Student Attendance Record II ï¼ˆHARDï¼‰"></a>Student Attendance Record II <font color=#FF4500 size=4 face='é»‘ä½“'>ï¼ˆHARDï¼‰</font></h1><blockquote><p>Student Attendance Record II</p><p>An attendance record for a student can be represented as a string where each character signifies whether the student was absent, late, or present on that day. The record only contains the following three characters:</p><ul><li>â€˜Aâ€™: Absent.</li><li>â€˜Lâ€™: Late.</li><li>â€˜Pâ€™: Present.</li></ul><p>Any student is eligible for an attendance award if they meet both of the following criteria:</p><ul><li>The student was absent (â€˜Aâ€™) for strictly fewer than 2 days total.</li><li>The student was never late (â€˜Lâ€™) for 3 or more consecutive days.</li></ul><p>Given an integer n, return the number of possible attendance records of length n that make a student eligible for an attendance award. The answer may be very large, so return it modulo 109 + 7.</p></blockquote><p>åˆæ¬¡åˆ†ææ—¶ï¼Œå¯å¾—åˆ°å¦‚ä¸‹é™åˆ¶ï¼š</p><ol><li>æœ€å¤šåªèƒ½æœ‰ä¸¤ä¸ª<code>A</code></li><li><code>L</code>å¯èƒ½è¢«<code>A</code>æˆ–<code>P</code>éš”å¼€</li><li><code>L</code>åªèƒ½å‡ºç°å•ç‹¬çš„ä¸€ä¸ªæˆ–è¿ç»­çš„ä¸¤ä¸ª</li><li><code>L</code>çš„æœ€å¤§æ•°é‡ä¸º<code>n/3*2 + n-(n/3*2)</code>ï¼Œå³æŠŠå‡ºå‹¤åˆ†ä¸ºè‹¥å¹²ä¸ªä¸‰å…ƒç»„ä¸ä¸€ä¸ªæœ«å°¾ï¼Œä¸‰å…ƒç»„ä¸­å‡å­˜åœ¨ä¸¤ä¸ª<code>L</code>ï¼Œæœ«å°¾å‡ä¸º<code>L</code></li></ol><h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><p>å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’è®¡ç®—å¯å¥–åŠ±çš„å‡ºå‹¤è®°å½•çš„æ•°é‡ã€‚</p><p>ç”±äºå¯å¥–åŠ±çš„å‡ºå‹¤è®°å½•è¦æ±‚ç¼ºå‹¤æ¬¡æ•°å°‘äº 2 å’Œè¿ç»­è¿Ÿåˆ°æ¬¡æ•°å°‘äº 3ï¼Œå› æ­¤åŠ¨æ€è§„åˆ’çš„çŠ¶æ€ç”±æ€»å¤©æ•°ã€ç¼ºå‹¤æ¬¡æ•°å’Œç»“å°¾è¿ç»­è¿Ÿåˆ°æ¬¡æ•°å†³å®šï¼ˆç”±äºä¸ä¼šè®°å½•è¿ç»­è¿Ÿåˆ°æ¬¡æ•°ç­‰äºæˆ–å¤šäº 3 çš„æƒ…å†µï¼Œå› æ­¤éç»“å°¾çš„è¿ç»­è¿Ÿåˆ°æ¬¡æ•°ä¸€å®šå°‘äº 3ï¼Œåªéœ€è¦è®°å½•ç»“å°¾è¿ç»­è¿Ÿåˆ°æ¬¡æ•°å³å¯ï¼‰ã€‚</p><p>å®šä¹‰ $d p[i][j][k]$ è¡¨ç¤ºå‰ $i$ å¤©æœ‰ $j$ ä¸ª â€˜$\mathrm{A}$â€™ ä¸”ç»“å°¾æœ‰è¿ç»­ $k$ ä¸ª â€˜ L â€˜ çš„å¯å¥–åŠ±çš„å‡ºå‹¤è®°å½•çš„æ•°é‡, å…¶ä¸­ $0 \leq i \leq$ $n, 0 \leq j \leq 1,0 \leq k \leq 2$ ã€‚</p><p>å½“ $i=0$ æ—¶ï¼Œæ²¡æœ‰ä»»ä½•å‡ºå‹¤è®°å½•ï¼Œæ­¤æ—¶ â€˜ $A$ â€˜çš„æ•°é‡å’Œç»“å°¾è¿ç»­ â€˜ $L$ â€˜ çš„æ•°é‡ä¸€å®šæ˜¯ 0 ï¼Œå› æ­¤åŠ¨æ€è§„åˆ’çš„è¾¹ç•Œæƒ…å†µæ˜¯ $d p[0][0][0]=1$ ã€‚</p><p>å½“ $1 \leq i \leq n$ æ—¶ï¼Œ $d p[i][][]$ çš„å€¼ä» $d p[i-1][][]$ çš„å€¼è½¬ç§»å¾—åˆ°ï¼Œè®¡ç®—æ¯ä¸ªçŠ¶æ€çš„å€¼éœ€è¦è€ƒè™‘ç¬¬ $i$ å¤©çš„å‡ºå‹¤è®°å½•:</p><ul><li>å¦‚æœç¬¬ $i$ å¤©çš„å‡ºå‹¤è®°å½•æ˜¯ â€˜ P â€˜ï¼Œåˆ™å‰ $i$ å¤©å’Œå‰ $i-1$ å¤©çš„å‡ºå‹¤è®°å½•ç›¸æ¯”ï¼Œ â€˜ $A$ â€˜çš„æ•°é‡ä¸å˜ï¼Œç»“å°¾è¿ç»­ ${ }^{\prime} \mathrm{L}$ â€˜ çš„æ•°é‡æ¸…é›¶ï¼Œå› æ­¤å¯¹ $0 \leq j \leq 1$ ï¼Œæœ‰</li></ul><script type="math/tex; mode=display">d p[i][j][0]:=d p[i][j][0]+\sum_{k=0}^2 d p[i-1][j][k]</script><ul><li>å¦‚æœç¬¬ $i$ å¤©çš„å‡ºå‹¤è®°å½•æ˜¯ â€˜ $A$ â€˜ï¼Œåˆ™å‰ $i$ å¤©å’Œå‰ $i-1$ å¤©çš„å‡ºå‹¤è®°å½•ç›¸æ¯”ï¼Œ â€˜ $A$ â€˜çš„æ•°é‡åŠ  1 ï¼Œç»“å°¾è¿ç»­ â€˜ $L$ â€˜ çš„æ•°é‡æ¸…é›¶ï¼Œæ­¤æ—¶è¦æ±‚å‰ $i-1$ å¤©çš„å‡ºå‹¤è®°å½•è®°å½•ä¸­çš„ â€˜ $A$ â€˜çš„æ•°é‡å¿…é¡»ä¸º 0 ï¼Œå¦åˆ™å‰ $i$ å¤©çš„å‡ºå‹¤è®°å½•è‡³å°‘æœ‰ 2 ä¸ª â€˜ $A$ â€˜ï¼Œä¸æ»¡è¶³å¯å¥–åŠ±çš„æ¡ä»¶ï¼Œå› æ­¤æœ‰</li></ul><script type="math/tex; mode=display">d p[i][1][0]:=d p[i][1][0]+\sum_{k=0}^2 d p[i-1][0][k]</script><ul><li>å¦‚æœç¬¬ $i$ å¤©çš„å‡ºå‹¤è®°å½•æ˜¯ â€˜ L â€˜ï¼Œåˆ™å‰ $i$ å¤©å’Œå‰ $i-1$ å¤©çš„å‡ºå‹¤è®°å½•ç›¸æ¯”ï¼Œ â€˜Aâ€™ çš„æ•°é‡ä¸å˜ï¼Œç»“å°¾è¿ç»­ ${ }^{\prime} L$ â€˜ çš„æ•°é‡åŠ  1 , æ­¤æ—¶è¦æ±‚å‰ $i-1$ å¤©çš„å‡ºå‹¤è®°å½•è®°å½•ä¸­çš„ç»“å°¾è¿ç»­ â€˜ $L$ â€˜ çš„æ•°é‡ä¸è¶…è¿‡ 1 ï¼Œå¦åˆ™å‰ $i$å¤©çš„å‡ºå‹¤è®°å½•çš„ç»“å°¾è‡³å°‘æœ‰ 3 ä¸ª â€˜ $L$ â€˜ï¼Œä¸æ»¡è¶³å¯å¥–åŠ±çš„æ¡ä»¶ï¼Œå› æ­¤å¯¹ $0 \leq j \leq 1$ å’Œ $1 \leq k \leq 2$ ï¼Œæœ‰</li></ul><script type="math/tex; mode=display">d p[i][j][k]:=d p[i][j][k]+d p[i-1][j][k-1]</script><p>ä¸Šè¿°çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¯¹äº<code>i=1</code>ä¹Ÿé€‚ç”¨ã€‚è®¡ç®—é•¿åº¦ä¸º n çš„æ‰€æœ‰å¯å¥–åŠ±çš„å‡ºå‹¤è®°å½•çš„æ•°é‡ï¼Œå³ä¸ºè®¡ç®— <code>dp[n][][]</code> çš„æ‰€æœ‰å…ƒç´ ä¹‹å’Œã€‚è®¡ç®—è¿‡ç¨‹ä¸­éœ€è¦å°†ç»“æœå¯¹<code>10^9+7</code>å–æ¨¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">checkRecord</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> MOD = <span class="number">1000000007</span>;</span><br><span class="line">        <span class="keyword">int</span>[][][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">1</span>][<span class="number">2</span>][<span class="number">3</span>]; <span class="comment">// é•¿åº¦ï¼ŒA çš„æ•°é‡ï¼Œç»“å°¾è¿ç»­ L çš„æ•°é‡</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="comment">// ä»¥ P ç»“å°¾çš„æ•°é‡</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">1</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= <span class="number">2</span>; k++) &#123;</span><br><span class="line">                    dp[i][j][<span class="number">0</span>] = (dp[i][j][<span class="number">0</span>] + dp[i - <span class="number">1</span>][j][k]) % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ä»¥ A ç»“å°¾çš„æ•°é‡</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= <span class="number">2</span>; k++) &#123;</span><br><span class="line">                dp[i][<span class="number">1</span>][<span class="number">0</span>] = (dp[i][<span class="number">1</span>][<span class="number">0</span>] + dp[i - <span class="number">1</span>][<span class="number">0</span>][k]) % MOD;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ä»¥ L ç»“å°¾çš„æ•°é‡</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">1</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= <span class="number">2</span>; k++) &#123;</span><br><span class="line">                    dp[i][j][k] = (dp[i][j][k] + dp[i - <span class="number">1</span>][j][k - <span class="number">1</span>]) % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">1</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= <span class="number">2</span>; k++) &#123;</span><br><span class="line">                sum = (sum + dp[n][j][k]) % MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®çŠ¶æ€è½¬ç§»ï¼Œå‘ç°å¯ä»¥åˆ©ç”¨æ»šåŠ¨æ•°ç»„ä¼˜åŒ–ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">checkRecord</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> MOD = <span class="number">1000000007</span>;</span><br><span class="line">        <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>][<span class="number">3</span>]; <span class="comment">// A çš„æ•°é‡ï¼Œç»“å°¾è¿ç»­ L çš„æ•°é‡</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span>[][] dpNew = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>][<span class="number">3</span>];</span><br><span class="line">            <span class="comment">// ä»¥ P ç»“å°¾çš„æ•°é‡</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">1</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= <span class="number">2</span>; k++) &#123;</span><br><span class="line">                    dpNew[j][<span class="number">0</span>] = (dpNew[j][<span class="number">0</span>] + dp[j][k]) % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ä»¥ A ç»“å°¾çš„æ•°é‡</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= <span class="number">2</span>; k++) &#123;</span><br><span class="line">                dpNew[<span class="number">1</span>][<span class="number">0</span>] = (dpNew[<span class="number">1</span>][<span class="number">0</span>] + dp[<span class="number">0</span>][k]) % MOD;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ä»¥ L ç»“å°¾çš„æ•°é‡</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">1</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= <span class="number">2</span>; k++) &#123;</span><br><span class="line">                    dpNew[j][k] = (dpNew[j][k] + dp[j][k - <span class="number">1</span>]) % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            dp = dpNew;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">1</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= <span class="number">2</span>; k++) &#123;</span><br><span class="line">                sum = (sum + dp[j][k]) % MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>PSï¼šé€æ¸ç†è§£DPä¼¼ä¹å°±æ˜¯ä¸€ç§é™åˆ¶æ¡ä»¶æšä¸¾çš„è§£æ³•ï¼Œåˆ—å‡ºé™åˆ¶ï¼Œé€æ¡ä»¶æšä¸¾ï¼Œä¾‹å¦‚01èƒŒåŒ…å°±æ˜¯åœ¨æšä¸¾èƒŒåŒ…å®¹é‡ã€‚</p><h1 id="Find-Number-of-Ways-to-Reach-the-K-th-Stair-ï¼ˆHARDï¼‰"><a href="#Find-Number-of-Ways-to-Reach-the-K-th-Stair-ï¼ˆHARDï¼‰" class="headerlink" title="Find Number of Ways to Reach the K-th Stair ï¼ˆHARDï¼‰"></a>Find Number of Ways to Reach the K-th Stair <font color=#FF4500 size=4 face='é»‘ä½“'>ï¼ˆHARDï¼‰</font></h1><blockquote><p>Find Number of Ways to Reach the K-th Stair</p><p>You are given a non-negative integer k. There exists a staircase with an infinite number of stairs, with the lowest stair numbered 0.</p><p>Alice has an integer jump, with an initial value of 0. She starts on stair 1 and wants to reach stair k using any number of operations. If she is on stair i, in one operation she can:</p><ul><li>Go down to stair i - 1. This operation cannot be used consecutively or on stair 0.</li><li>Go up to stair i + 2jump. And then, jump becomes jump + 1.<br>Return the total number of ways Alice can reach stair k.<br>Note that it is possible that Alice reaches the stair k, and performs some operations to reach the stair k again.</li></ul></blockquote><p>å®¹æ˜“æƒ³åˆ°é€’å½’æ–¹å¼ç©·ä¸¾æ‰€æœ‰å¯èƒ½æ€§ï¼Œä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> ks;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moveMachine</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> jump, <span class="keyword">boolean</span> canDown, <span class="keyword">int</span> ops)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(i&lt;<span class="number">0</span>||i&gt;ks+<span class="number">1</span>||ops&gt;<span class="number">61</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span>(i==ks)&#123;</span><br><span class="line">            res++;</span><br><span class="line">        &#125;</span><br><span class="line">        moveMachine(i+(<span class="keyword">int</span>)Math.pow(<span class="number">2</span>, jump), jump+<span class="number">1</span>, <span class="keyword">true</span>, ops+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(canDown) moveMachine(i-<span class="number">1</span>, jump, <span class="keyword">false</span>, ops+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">waysToReachStair</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        ks = k;</span><br><span class="line">        moveMachine(<span class="number">1</span>, <span class="number">0</span>, <span class="keyword">true</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> k==<span class="number">1</span>?<span class="number">4</span>:res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æš´åŠ›ç©·ä¸¾ç”¨ä¾‹åªèƒ½é€šè¿‡50%ï¼Œç»„åˆæ•°å­¦æ³•è§å®˜è§£ã€‚</p><h1 id="ä½è¿ç®—"><a href="#ä½è¿ç®—" class="headerlink" title="ä½è¿ç®—"></a>ä½è¿ç®—</h1><p>ä¸¤é“é¢˜éƒ½æ˜¯ç»„åˆ+ä½è¿ç®—çš„ç±»å‹ï¼Œä¾‹é¢˜ä¸€å¿…é¡»å®Œå…¨æŒæ¡ï¼Œç¬¬äºŒé¢˜ä»¥ç›®å‰æ°´å¹³èƒ½å†™ä¸ªä¸ƒå…«åå°±å¯ä»¥äº†ã€‚</p><h2 id="ä¾‹é¢˜ä¸€ï¼šMinimum-Array-End"><a href="#ä¾‹é¢˜ä¸€ï¼šMinimum-Array-End" class="headerlink" title="ä¾‹é¢˜ä¸€ï¼šMinimum Array End"></a>ä¾‹é¢˜ä¸€ï¼šMinimum Array End</h2><blockquote><p>Minimum Array End</p><p>You are given two integers n and x. You have to construct an array of positive integers nums of size n where for every 0 &lt;= i &lt; n - 1, nums[i + 1] is greater than nums[i], and the result of the bitwise AND operation between all elements of nums is x.</p><p>Return the minimum possible value of nums[n - 1].</p></blockquote><p>é¢˜ç›®è¿˜æ˜¯å¾ˆå¥½ç†è§£çš„ï¼Œä»”ç»†åˆ†æä¸€ä¸‹å°±çŸ¥é“æ˜¯è¦ä»<code>x</code>å¼€å§‹é€æ­¥å¾€<code>0</code>ä½ä¸Šå¡«1ï¼Œç›´åˆ°å¡«å‡ºç¬¬n-1ä¸ªæ•°ï¼Œå¡«å……è¿‡ç¨‹ä¿æŒæ•°ç»„é€’å¢ã€‚æˆ‘çš„ç¬¬ä¸€æ¬¡è§£æ³•å¦‚ä¸‹ï¼Œä¼šOOMï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">minEnd</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> last = <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// å­˜å‚¨ä½ä½åˆ°é«˜ä½çš„0ä½ç½®ï¼Œåç»­æŒ‰é¡ºåºæ‹¼maskå°±è¡Œäº†</span></span><br><span class="line">        List&lt;Long&gt; masks = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span>(last&lt;=Long.MAX_VALUE&amp;&amp;masks.size()&lt;n-<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>((last&amp;x)==<span class="number">0</span>)&#123;</span><br><span class="line">                masks.add(last);</span><br><span class="line">                <span class="keyword">int</span> len = masks.size();</span><br><span class="line">                <span class="comment">// å­˜å‚¨ç»„åˆ</span></span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len-<span class="number">1</span>;i++)&#123;</span><br><span class="line">                    masks.add(last^masks.get(i));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            last&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> n==<span class="number">1</span>?x:(x^masks.get(n-<span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡åˆ°çš„å¡ç‚¹æ˜¯è®¡ç®—ç›®æ ‡å€¼éœ€è¦å­˜å‚¨å‰åºå€¼ï¼Œéœ€è¦å‹ç¼©ç©ºé—´ã€‚å¯ä»¥ç”¨å¦ä¸€ç§è§†è§’æ¥çœ‹å¡«<code>0</code>ä½çš„è¿‡ç¨‹ï¼Œå³æŠŠ<code>x</code>ä¸Šçš„<code>1</code>ä½éƒ½æå‡ºæ¥ï¼Œå‰©ä¸‹çš„ä½ç½®ä¸ŠæŒ‰<code>1ã€2ã€...ã€n-1</code>çš„å€¼å»å¡«å³å¯ï¼Œä¾‹å¦‚å¯¹äº<code>x = 100010, n = 4</code>ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å‘<code>0000</code>ä¸Šä¾æ¬¡å¡«<code>0001, 0010, 0011</code>ï¼Œåˆ™å¯å¾—å‡ºç­”æ¡ˆ<code>100111</code>ã€‚å› æ­¤ï¼Œå¯ä»¥ç¡®å®šç›®æ ‡å€¼ä¸ºæŠŠ<code>n-1</code>çš„äºŒè¿›åˆ¶æ’å…¥åˆ°<code>x</code>çš„<code>0</code>ä½ä¸­ï¼Œè§£æ³•å¦‚ä¸‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">minEnd</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// è¿”å›å€¼å¯èƒ½çš„æœ€å¤§ä½æ•°ï¼Œå³ä¸¤ä¸ªlongçš„é•¿åº¦å‡å»å„è‡ªçš„å‰å¯¼0ï¼Œå½“xå…¨æ˜¯1æ—¶å‡ºç°ã€‚</span></span><br><span class="line">        <span class="keyword">int</span> bitCount = <span class="number">128</span> - Long.numberOfLeadingZeros(n) - Long.numberOfLeadingZeros(x);</span><br><span class="line">        <span class="keyword">long</span> res = x;</span><br><span class="line">        <span class="keyword">long</span> m = n - <span class="number">1</span>; <span class="comment">// è¦å¡«åˆ°0ä½çš„æ‰€æœ‰bit</span></span><br><span class="line">        <span class="keyword">int</span> j = <span class="number">0</span>; <span class="comment">// è®°å½•xä¸­å·²ç»å¡«è¿‡çš„bit</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bitCount; ++i) &#123;</span><br><span class="line">            <span class="comment">// é€ä½æŸ¥çœ‹æ˜¯å¦æ˜¯0</span></span><br><span class="line">            <span class="keyword">if</span> (((res &gt;&gt; i) &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// å¯¹äºæ˜¯0çš„ä½ç½®ï¼Œå¦‚æœn-1ä¹Ÿä¸º0åˆ™ä¸å¤„ç†ï¼Œå¦‚æœä¸º1åˆ™ç”¨å¼‚æˆ–å¡«å…¥</span></span><br><span class="line">                <span class="keyword">if</span> (((m &gt;&gt; j) &amp; <span class="number">1</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">                    res |= (<span class="number">1L</span> &lt;&lt; i);</span><br><span class="line">                &#125;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¾‹é¢˜äºŒï¼šFind-Products-of-Elements-of-Big-Array-ï¼ˆHARDï¼‰"><a href="#ä¾‹é¢˜äºŒï¼šFind-Products-of-Elements-of-Big-Array-ï¼ˆHARDï¼‰" class="headerlink" title="ä¾‹é¢˜äºŒï¼šFind Products of Elements of Big Array ï¼ˆHARDï¼‰"></a>ä¾‹é¢˜äºŒï¼šFind Products of Elements of Big Array <font color=#FF4500 size=4 face='é»‘ä½“'>ï¼ˆHARDï¼‰</font></h2><blockquote><p>Find Products of Elements of Big Array</p><p>The powerful array of a non-negative integer x is defined as the shortest sorted array of powers of two that sum up to x. The table below illustrates examples of how the powerful array is determined. It can be proven that the powerful array of x is unique.</p><p>The array big_nums is created by concatenating the powerful arrays for every positive integer i in ascending order: 1, 2, 3, and so on. Thus, big_nums begins as [1, 2, 1, 2, 4, 1, 4, 2, 4, 1, 2, 4, 8, â€¦].</p><p>You are given a 2D integer matrix queries, where for queries[i] = [fromi, toi, modi] you should calculate (big_nums[fromi] <em> big_nums[fromi + 1] </em> â€¦ * big_nums[toi]) % modi.</p><p>Return an integer array answer such that answer[i] is the answer to the ith query.</p></blockquote><p>æ€è·¯ï¼šé¦–å…ˆçœ‹å¦‚ä½•å®šä½<code>bignums[i]</code>çš„å€¼ï¼Œä»æ•°ä½çš„è§’åº¦è€ƒè™‘ï¼Œå¯¹äº<code>01000</code>æ¥è¯´ï¼Œå…¶ä¹‹å‰çš„å…ƒç´ ä¸ªæ•°å…¶å®å°±æ˜¯1ã€2ã€3ä¸ª1åœ¨3ä¸ªæ ¼å­ä¸­æœ‰å¤šå°‘ç§æ’åˆ—ï¼Œç„¶åå†ä¹˜å…ƒç´ æ•°<code>C31*1+C32*2+C33*3 = 12</code>ï¼Œå¯ä»¥åº”ç”¨<strong>ç»„åˆæ•°çš„åŠ æƒæ±‚å’Œå…¬å¼</strong>ã€‚ç”¨<code>b(x)</code>è¡¨ç¤º<code>b(x)</code>ä½ä¸º1ï¼Œå…¶ä½™ä¸º0çš„äºŒè¿›åˆ¶æ•°ï¼Œ<code>x</code>ä»0å¼€å§‹ï¼Œåˆ™<code>b(x)</code>çš„ä¸‹æ ‡ä¸º<code>n*2^(n-1)</code>ã€‚å¯¹äºä»»æ„ä¸€ä¸ªä¸‹æ ‡<code>y</code>ï¼Œè€ƒè™‘éå†<code>i</code>ï¼Œæ‰¾åˆ°é¦–ä¸ªå°äº<code>y</code>çš„<code>i*2^(i-1)</code>ï¼Œç„¶åæ¨¡æ‹Ÿéå†æ•°ä½æ‰¾åˆ°<code>bignums[from]</code>çš„å€¼ï¼Œç»§ç»­æ¨¡æ‹Ÿéå†ï¼Œæ‰¾åˆ°<code>bignums[to]</code>ä¹‹é—´çš„è‹¥å¹²å€¼ï¼Œæ±‚è§£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] findProductsOfElements(<span class="keyword">long</span>[][] queries) &#123;</span><br><span class="line">        <span class="keyword">int</span> n = queries.length;</span><br><span class="line">        <span class="keyword">int</span>[] ans = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;n;k++)&#123;</span><br><span class="line">            <span class="keyword">long</span> from = queries[k][<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">long</span> to = queries[k][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">long</span> mod = queries[k][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> lastSmallInd = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> lastPower = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">32</span>;i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>((<span class="keyword">int</span>)Math.pow(<span class="number">2</span>, i-<span class="number">1</span>) * i&lt;=from)&#123;</span><br><span class="line">                    lastSmallInd = (<span class="keyword">int</span>)Math.pow(<span class="number">2</span>, i-<span class="number">1</span>) * i;</span><br><span class="line">                    lastPower = i;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> startOuterVal = (<span class="keyword">int</span>)Math.pow(<span class="number">2</span>, lastPower);</span><br><span class="line">            <span class="keyword">int</span> startVal = startOuterVal;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(lastSmallInd&lt;from)&#123;</span><br><span class="line">                <span class="comment">// æ¨¡æ‹Ÿ</span></span><br><span class="line">                <span class="keyword">int</span> startInd = lastSmallInd;</span><br><span class="line">                <span class="keyword">while</span>(startInd&lt;from)&#123;</span><br><span class="line">                    startOuterVal++;</span><br><span class="line">                    <span class="keyword">int</span> tmp = Integer.bitCount(startOuterVal); <span class="comment">// å‡å»æœ€å¤§çš„1</span></span><br><span class="line">                    <span class="keyword">if</span>(startInd+tmp&lt;from) startInd+=tmp;</span><br><span class="line">                    <span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="comment">// é€ä½å³ç§»å¯»æ‰¾</span></span><br><span class="line">                        <span class="keyword">int</span> sov = startOuterVal;</span><br><span class="line">                        <span class="keyword">int</span> cnt = <span class="number">0</span>; <span class="comment">// å…ƒç´ è®¡æ•°</span></span><br><span class="line">                        <span class="keyword">int</span> bitCnt = -<span class="number">1</span>; <span class="comment">// ä½æ•°è®¡æ•°</span></span><br><span class="line">                        <span class="keyword">while</span> (startInd+cnt&lt;from) &#123;</span><br><span class="line">                            <span class="comment">// åˆ¤æ–­æœ«ä½æ˜¯å¦ä¸º1</span></span><br><span class="line">                            <span class="keyword">if</span>((sov&amp;<span class="number">1</span>)==<span class="number">1</span>) cnt++;</span><br><span class="line">                            sov&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">                            bitCnt++;</span><br><span class="line">                        &#125;</span><br><span class="line">                        startVal = (<span class="keyword">int</span>) Math.pow(<span class="number">2</span>, bitCnt);</span><br><span class="line">                        startInd+=cnt;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¼€å§‹è®¡ç®—ç»“æœ</span></span><br><span class="line">            <span class="keyword">long</span> mul = startVal;</span><br><span class="line">            <span class="keyword">long</span> remain = to-from; <span class="comment">// to-fromä¸ªå…ƒç´ è¿˜æ²¡è®¡ç®—</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span>(remain&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">while</span>(startVal&lt;startOuterVal)&#123;</span><br><span class="line">                    startVal&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span>(remain&lt;=<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">                    <span class="comment">// æœ‰é‡åˆçš„1</span></span><br><span class="line">                    <span class="keyword">if</span>((startVal&amp;startOuterVal)!=<span class="number">0</span>)&#123;</span><br><span class="line">                        remain--;</span><br><span class="line">                        mul*=startVal;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                startOuterVal++;</span><br><span class="line">                startVal = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>((startVal&amp;startOuterVal)!=<span class="number">0</span>) remain--;</span><br><span class="line">            &#125;</span><br><span class="line">           </span><br><span class="line"></span><br><span class="line">            ans[k] = (<span class="keyword">int</span>) (mul%mod);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§è§£æ³•å¯ä»¥é€šè¿‡95%çš„ç”¨ä¾‹ï¼Œå…¨é€šçš„è§£æ³•å¯ä»¥å‚è€ƒå®˜è§£ã€‚</p><h1 id="Partition-to-K-Equal-Sum-Subsets"><a href="#Partition-to-K-Equal-Sum-Subsets" class="headerlink" title="Partition to K Equal Sum Subsets"></a>Partition to K Equal Sum Subsets</h1><blockquote><p>Partition to K Equal Sum Subsets</p><p>Given an integer array nums and an integer k, return true if it is possible to divide this array into k non-empty subsets whose sums are all equal.</p><p>1 &lt;= k &lt;= nums.length &lt;= 16<br>1 &lt;= nums[i] &lt;= 10^4<br>The frequency of each element is in the range [1, 4].</p></blockquote><h2 id="çŠ¶æ€å‹ç¼©DP"><a href="#çŠ¶æ€å‹ç¼©DP" class="headerlink" title="çŠ¶æ€å‹ç¼©DP"></a>çŠ¶æ€å‹ç¼©DP</h2><blockquote><p>çŠ¶æ€å‹ç¼©å°±æ˜¯ä½¿ç”¨æŸç§æ–¹æ³•ï¼Œç®€æ˜æ‰¼è¦åœ°ä»¥æœ€å°ä»£ä»·æ¥è¡¨ç¤ºæŸç§çŠ¶æ€ï¼Œé€šå¸¸æ˜¯ç”¨ä¸€ä¸²01æ•°å­—ï¼ˆäºŒè¿›åˆ¶æ•°ï¼‰æ¥è¡¨ç¤ºå„ä¸ªç‚¹çš„çŠ¶æ€ã€‚è¿™å°±è¦æ±‚ä½¿ç”¨çŠ¶æ€å‹ç¼©çš„å¯¹è±¡çš„ç‚¹çš„çŠ¶æ€å¿…é¡»åªæœ‰ä¸¤ç§ï¼Œ0 æˆ– 1ï¼›å½“ç„¶å¦‚æœæœ‰ä¸‰ç§çŠ¶æ€ç”¨ä¸‰è¿›åˆ¶æ¥è¡¨ç¤ºä¹Ÿæœªå°ä¸å¯ã€‚</p><p>çŠ¶æ€å‹ç¼©çš„ç›®çš„ä¸€æ–¹é¢æ˜¯ç¼©å°äº†æ•°æ®å­˜å‚¨çš„ç©ºé—´ï¼Œå¦ä¸€æ–¹é¢æ˜¯åœ¨çŠ¶æ€å¯¹æ¯”å’ŒçŠ¶æ€æ•´ä½“å¤„ç†æ—¶èƒ½å¤Ÿæé«˜æ•ˆç‡ã€‚è¿™æ ·å°±è¦æ±‚çŠ¶æ€æ•°æ®ä¸­çš„å•å…ƒä¸ªæ•°ä¸èƒ½å¤ªå¤§ï¼Œæ¯”å¦‚ç”¨intæ¥è¡¨ç¤ºä¸€ä¸ªçŠ¶æ€çš„æ—¶å€™ï¼ŒçŠ¶æ€çš„å•å…ƒä¸ªæ•°ä¸èƒ½è¶…è¿‡32ï¼ˆ32ä½çš„æœºå™¨ï¼‰ï¼Œæ‰€ä»¥é¢˜ç›®ä¸€èˆ¬éƒ½æ˜¯è‡³å°‘æœ‰ä¸€ç»´çš„æ•°æ®èŒƒå›´å¾ˆå°ã€‚</p></blockquote><p>çŠ¶å‹DPå°±æ˜¯ä½¿ç”¨çŠ¶æ€å‹ç¼©çš„åŠ¨æ€è§„åˆ’ã€‚åŠ¨æ€è§„åˆ’é—®é¢˜é€šå¸¸æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯å¯¹é€’å½’é—®é¢˜çš„è®°å¿†åŒ–æ±‚è§£ï¼Œå¦ä¸€ç§æ˜¯æŠŠå¤§é—®é¢˜çœ‹ä½œæ˜¯å¤šé˜¶æ®µçš„å†³ç­–æ±‚è§£ã€‚è¿™é‡Œç”¨çš„ä¾¿æ˜¯åä¸€ç§ï¼Œè¿™å¸¦æ¥ä¸€ä¸ªéœ€æ±‚ï¼Œå³å­˜å‚¨ä¹‹å‰çš„çŠ¶æ€ï¼Œå†ç”±çŠ¶æ€åŠçŠ¶æ€å¯¹åº”çš„å€¼æ¨æ¼”å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹æœ€ç»ˆå¾—åˆ°æœ€ä¼˜è§£ã€‚</p><p>å›åˆ°æœ¬é¢˜ï¼Œé¢˜ç›®ç»™å®šé•¿åº¦ä¸º $n$ çš„æ•°ç»„ $nums$ï¼Œå’Œæ•´æ•° $k$ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­æ˜¯å¦èƒ½å°†æ•°ç»„åˆ†æˆ $k$ ä¸ªæ€»å’Œç›¸ç­‰çš„éç©ºå­é›†ã€‚é¦–å…ˆè®¡ç®—æ•°ç»„çš„å’Œ $all$ï¼Œå¦‚æœ $all$ ä¸æ˜¯ $k$ çš„å€æ•°ï¼Œé‚£ä¹ˆä¸å¯èƒ½èƒ½æœ‰åˆæ³•æ–¹æ¡ˆï¼Œæ­¤æ—¶ç›´æ¥è¿”å› $False$ã€‚å¦åˆ™æˆ‘ä»¬éœ€è¦å¾—åˆ° $k$ ä¸ªå’Œä¸º $per= all/k$çš„é›†åˆã€‚</p><p>æ•°ç»„é•¿åº¦åœ¨16ä»¥å†…ï¼Œåˆ™å¯ä»¥ç”¨ä¸€ä¸ªæ•´æ•° $S$ æ¥è¡¨ç¤ºå½“å‰å¯ç”¨çš„æ•°å­—é›†åˆï¼šä»ä½ä½åˆ°é«˜ä½, ç¬¬ $i$ ä½ä¸º 0 åˆ™è¡¨ç¤ºæ•°å­— nums $[i]$ å¯ä»¥ä½¿ç”¨, å¦åˆ™è¡¨ç¤º nums [i] å·²è¢«ä½¿ç”¨ã€‚ç„¶åæˆ‘ä»¬ç”¨ $d p[S]$ æ¥è¡¨ç¤ºåœ¨å¯ç”¨çš„æ•°å­—çŠ¶æ€ä¸º $S$ çš„æƒ…å†µä¸‹æ˜¯å¦å¯èƒ½å¯è¡Œ, åˆå§‹å…¨éƒ¨çŠ¶æ€ä¸ºè®°å½•ä¸ºä¸å¯è¡ŒçŠ¶æ€ False, åªè®° $d p[0]=$ True ä¸ºå¯è¡ŒçŠ¶æ€ã€‚</p><p>æˆ‘ä»¬æ¯æ¬¡å¯¹äºå½“å‰çŠ¶æ€ä¸‹ä»å¯ç”¨çš„æ•°å­—ä¸­é€‰æ‹©ä¸€ä¸ªæ•°å­—, è‹¥æ­¤æ—¶é€‰æ‹©å…¨éƒ¨æ•°å­—å–æ¨¡åå°äºç­‰äº perã€‚åˆ™è¯´æ˜é€‰æ‹©è¯¥æ•°å­—åçš„çŠ¶æ€å†ç»§ç»­å¾€ä¸‹æ·»åŠ æ•°å­—æ˜¯å¯èƒ½èƒ½æ»¡è¶³é¢˜æ„çš„ï¼Œå¹¶ä¸”æ­¤æ—¶æ ‡è®°çŠ¶ä¸ºå¯èƒ½å¯è¡ŒçŠ¶æ€ï¼Œå¦åˆ™å°±ä¸€å®šä¸èƒ½è¾¾åˆ°æ»¡è¶³ã€‚æœ€ç»ˆè¿”å› $d p[U]$å³å¯, å…¶ä¸­ $U$ è¡¨ç¤ºå…¨éƒ¨æ•°å­—ä½¿ç”¨çš„é›†åˆçŠ¶æ€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canPartitionKSubsets</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> all = Arrays.stream(nums).sum();</span><br><span class="line">        <span class="keyword">if</span> (all % k != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> per = all / k;</span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line">        <span class="keyword">int</span> n = nums.length;</span><br><span class="line">        <span class="keyword">if</span> (nums[n - <span class="number">1</span>] &gt; per) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¼€å§‹DP</span></span><br><span class="line">        <span class="keyword">boolean</span>[] dp = <span class="keyword">new</span> <span class="keyword">boolean</span>[<span class="number">1</span> &lt;&lt; n]; <span class="comment">// æ‰€æœ‰å¯èƒ½çš„çŠ¶æ€</span></span><br><span class="line">        <span class="keyword">int</span>[] curSum = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">1</span> &lt;&lt; n]; <span class="comment">// çŠ¶æ€å¯¹åº”çš„æ€»å’Œï¼Ÿ</span></span><br><span class="line">        dp[<span class="number">0</span>] = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1</span> &lt;&lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!dp[i]) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (curSum[i] + nums[j] &gt; per) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// çŠ¶æ€iä¸­jç‰©å“å¯ç”¨</span></span><br><span class="line">                <span class="keyword">if</span> (((i &gt;&gt; j) &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="comment">// å®šä½ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œå³é€‰äº†jç‰©å“åçš„çŠ¶æ€</span></span><br><span class="line">                    <span class="keyword">int</span> next = i | (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">                    <span class="comment">// å¦‚æœæ˜¯ä¸å¯ç”¨çŠ¶æ€ï¼Œè¯´æ˜è¿˜æ²¡æ›´æ–°è¿‡</span></span><br><span class="line">                    <span class="keyword">if</span> (!dp[next]) &#123;</span><br><span class="line">                        <span class="comment">// å¯¹perå–ä½™è¡¨ç¤ºåˆ é™¤å·²å­˜æ»¡çš„å­é›†</span></span><br><span class="line">                        curSum[next] = (curSum[i] + nums[j]) % per;</span><br><span class="line">                        dp[next] = <span class="keyword">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å…¨ä¸º1çš„çŠ¶æ€ä¸‹æ˜¯å¦å¯ç”¨ï¼Œå³å–èµ°å…¨éƒ¨å…ƒç´ åæ˜¯å¦å¯è¡Œ</span></span><br><span class="line">        <span class="keyword">return</span> dp[(<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://algo.itcharge.cn/10.Dynamic-Programming/07.State-DP/01.State-DP/">https://algo.itcharge.cn/10.Dynamic-Programming/07.State-DP/01.State-DP/</a><br>[2] <a href="https://blog.nowcoder.net/n/fcc30eadb2b44395862194814e819315?from=nowcoder_improve">https://blog.nowcoder.net/n/fcc30eadb2b44395862194814e819315?from=nowcoder_improve</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;å‘¨èµ›ä¾ç„¶æ²¡ç©ºæ‰“ï¼Œé¢ç¬”å¤ªå¤šè¾½ï¼Œæ„Ÿè§‰è¿™å‘¨æ•°ä½é¢˜æ¯”è¾ƒå¤šï¼Œå†™å‘¨å…­çš„hardé¢˜ç”¨äº†ä¸¤ä¸ªå°æ—¶è¿˜æ˜¯æ²¡èƒ½å…¨Aï¼Œä¸è¿‡æ€è·¯æ²¡é—®é¢˜ï¼Œè¡¨æ‰¬ä¸€ä¸‹è‡ªå·±ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨ä¸»é¢˜ï¼šä¸‰ç»´åŠ¨æ€è§„åˆ’ï¼ˆä¸‰ä¸ªé™åˆ¶ï¼‰ã€ç»„åˆæ•°å­¦ã€ä½è¿ã€çŠ¶æ€å‹ç¼©DP&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;240819æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/student-attendance-record-ii/description&quot;&gt;Student Attendance Record II&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240820æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/find-number-of-ways-to-reach-the-k-th-stair/description&quot;&gt;Find Number of Ways to Reach the K-th Stair&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240822æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/minimum-array-end/description&quot;&gt;Minimum Array End&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240823æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/find-products-of-elements-of-big-array/description&quot;&gt;Find Products of Elements of Big Array&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240824æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/partition-to-k-equal-sum-subsets/description&quot;&gt;Partition to K Equal Sum Subsets&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;PSï¼šè…¾å­éŸ³ä¹çš„ç¬”ä¹Ÿå¿’éš¾äº†&lt;br&gt;</summary>
    
    
    
    
    <category term="LeetCode" scheme="http://silencezheng.top/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>xxl-jobæºç é˜…è¯»ï¼ˆä¸€ï¼‰ï¼šå®šæ—¶ä»»åŠ¡æ‰§è¡Œé“¾è·¯åˆ†æ</title>
    <link href="http://silencezheng.top/2024/08/19/article135/"/>
    <id>http://silencezheng.top/2024/08/19/article135/</id>
    <published>2024-08-19T15:15:50.000Z</published>
    <updated>2024-08-19T15:25:11.209Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>xxl-jobæºç é˜…è¯»ç¬¬ä¸€ç« ï¼šå®šæ—¶ä»»åŠ¡æ‰§è¡Œé“¾è·¯åˆ†æ</p><p>ä¸€æ—¶å…´èµ·ï¼ŒèŠ±ä¸€ä¸‹åˆçœ‹äº†ä¸€éè¿™éƒ¨åˆ†æºç ï¼Œå†™çš„ä¸é”™ã€‚</p><p>PSï¼šå†™å®Œæ‰å‘ç°æœ‰å®˜æ–¹æ–‡æ¡£è®²è§£â€¦å°´å°¬ğŸ˜…<br><span id="more"></span></p><h1 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h1><h2 id="éƒ¨ç½²xxl-job-admin"><a href="#éƒ¨ç½²xxl-job-admin" class="headerlink" title="éƒ¨ç½²xxl-job-admin"></a>éƒ¨ç½²xxl-job-admin</h2><p>å®˜ç½‘æ–‡æ¡£ç§’äº†ã€‚</p><p>åœ°å€ï¼š<a href="https://www.xuxueli.com/xxl-job/#%E4%BA%8C%E3%80%81%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8">https://www.xuxueli.com/xxl-job/#%E4%BA%8C%E3%80%81%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8</a></p><h2 id="è£…è½½é…ç½®ç±»"><a href="#è£…è½½é…ç½®ç±»" class="headerlink" title="è£…è½½é…ç½®ç±»"></a>è£…è½½é…ç½®ç±»</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JobHandlerConfig</span> </span>&#123;</span><br><span class="line">Â  Â  <span class="meta">@Value(&quot;$&#123;xxl.job.admin.addresses:http://ip:8008/xxl-job-admin-1.8.2&#125;&quot;)</span></span><br><span class="line">Â  Â  <span class="keyword">private</span> String adminAddresses;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="meta">@Value(&quot;$&#123;xxl.job.executor.appname:appname&#125;&quot;)</span></span><br><span class="line">Â  Â  <span class="keyword">private</span> String appName;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="meta">@Value(&quot;$&#123;xxl.job.executor.logpath:./xxlLogs&#125;&quot;)</span></span><br><span class="line">Â  Â  <span class="keyword">private</span> String logPath;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="meta">@Bean(initMethod = &quot;start&quot;, destroyMethod = &quot;destroy&quot;)</span></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> XxlJobExecutor <span class="title">xxlJobExecutor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Â  Â  Â  Â  XxlJobExecutor xxlJobExecutor = <span class="keyword">new</span> XxlJobExecutor();</span><br><span class="line">Â  Â  Â  Â  xxlJobExecutor.setAdminAddresses(adminAddresses);</span><br><span class="line">Â  Â  Â  Â  xxlJobExecutor.setAppName(appName);</span><br><span class="line">Â  Â  Â  Â  xxlJobExecutor.setLogPath(logPath);</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> xxlJobExecutor;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å®ç°ä»»åŠ¡æ¥å£"><a href="#å®ç°ä»»åŠ¡æ¥å£" class="headerlink" title="å®ç°ä»»åŠ¡æ¥å£"></a>å®ç°ä»»åŠ¡æ¥å£</h2><p>æ³¨æ„ä¸¤ç‚¹ï¼š</p><ol><li><code>@JobHandler</code>æ³¨è§£ç”¨äºå”¯ä¸€è¯†åˆ«ä»»åŠ¡</li><li>å®ç°äº†<code>IJobHandler</code>æ¥å£æ‰ä¼šè¢«åŠ è½½åˆ°ä»»åŠ¡åˆ—è¡¨ä¸­</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@JobHandler(value = &quot;AutoSendEmailScheduler&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AutoSendEmailScheduler</span> <span class="keyword">extends</span> <span class="title">IJobHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="meta">@Resource</span></span><br><span class="line">Â  Â  <span class="keyword">private</span> UniqueIdenAutoUpdateAndSendEmail uniqueIdenAutoUpdateAndSendEmail;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="meta">@Override</span></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> ReturnT&lt;String&gt; <span class="title">execute</span><span class="params">(String startDate)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">Â  Â  Â  Â  log.info(<span class="string">&quot;AutoSendEmailScheduler start, startDate:&#123;&#125;&quot;</span>, startDate);</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">Â  Â  Â  Â  ReturnT&lt;String&gt; result = <span class="keyword">new</span> ReturnT&lt;&gt;();</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">try</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  uniqueIdenAutoUpdateAndSendEmail.autoSendEmail(startDate);</span><br><span class="line">Â  Â  Â  Â  &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  log.error(<span class="string">&quot;AutoSendEmailScheduler fail, startDate:&#123;&#125;&quot;</span>, startDate, ex);</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  result.setCode(SUCCESS_CODE);</span><br><span class="line">Â  Â  Â  Â  log.info(<span class="string">&quot;AutoSendEmailScheduler end, cost &#123;&#125;ms&quot;</span>, System.currentTimeMillis() - start);</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> result;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Xxl-job-Serverç«¯æºç åˆ†æ"><a href="#Xxl-job-Serverç«¯æºç åˆ†æ" class="headerlink" title="Xxl-job Serverç«¯æºç åˆ†æ"></a>Xxl-job Serverç«¯æºç åˆ†æ</h1><p>ç‰ˆæœ¬ï¼šxxl-job-core1.9.1</p><h2 id="ç»Ÿä¸€å…¥å£-â€”-æ‰§è¡Œå™¨"><a href="#ç»Ÿä¸€å…¥å£-â€”-æ‰§è¡Œå™¨" class="headerlink" title="ç»Ÿä¸€å…¥å£ â€” æ‰§è¡Œå™¨"></a>ç»Ÿä¸€å…¥å£ â€” æ‰§è¡Œå™¨</h2><p>æ‰§è¡Œå™¨å³<code>XxlJobExecutor</code>ï¼Œè¢«æ³¨å†Œä¸ºä¸Šä¸‹æ–‡ï¼Œä¸»è¦æ˜¯ä¸ºäº†èƒ½ç”¨<code>ApplicationContext</code>è·å–å„ç§ä¿¡æ¯ï¼Œä¾‹å¦‚Beanä¿¡æ¯ç­‰ç­‰ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XxlJobExecutor</span> <span class="keyword">implements</span> <span class="title">ApplicationContextAware</span></span>&#123;</span><br><span class="line">Â  Â  ...</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">private</span> <span class="keyword">static</span> ApplicationContext applicationContext;</span><br><span class="line">Â  Â  <span class="meta">@Override</span></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">this</span>.applicationContext = applicationContext;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ApplicationContext <span class="title">getApplicationContext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> applicationContext;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="åŠ è½½ä»»åŠ¡å¤„ç†å™¨"><a href="#åŠ è½½ä»»åŠ¡å¤„ç†å™¨" class="headerlink" title="åŠ è½½ä»»åŠ¡å¤„ç†å™¨"></a>åŠ è½½ä»»åŠ¡å¤„ç†å™¨</h3><p>æŠŠåˆšæ‰è‡ªå·±å®šä¹‰çš„å®šæ—¶ä»»åŠ¡å¤„ç†å™¨å’Œå…¶ä»–æ‰€æœ‰åŠ å…¥äº†<code>@JobHandler</code>æ³¨è§£çš„ç±»åŠ è½½è¿›æ¥ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> ConcurrentHashMap&lt;String, IJobHandler&gt; jobHandlerRepository = <span class="keyword">new</span> ConcurrentHashMap&lt;String, IJobHandler&gt;();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IJobHandler <span class="title">registJobHandler</span><span class="params">(String name, IJobHandler jobHandler)</span></span>&#123;</span><br><span class="line">Â  Â  <span class="keyword">return</span> jobHandlerRepository.put(name, jobHandler);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">initJobHandlerRepository</span><span class="params">(ApplicationContext applicationContext)</span></span>&#123;</span><br><span class="line">Â  Â  <span class="keyword">if</span> (applicationContext == <span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span>;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">// init job handler action</span></span><br><span class="line">Â  Â  Map&lt;String, Object&gt; serviceBeanMap = applicationContext.getBeansWithAnnotation(JobHandler.class);</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> (serviceBeanMap!=<span class="keyword">null</span> &amp;&amp; serviceBeanMap.size()&gt;<span class="number">0</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">for</span> (Object serviceBean : serviceBeanMap.values()) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (serviceBean <span class="keyword">instanceof</span> IJobHandler)&#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  String name = serviceBean.getClass().getAnnotation(JobHandler.class).value();</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  IJobHandler handler = (IJobHandler) serviceBean;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (loadJobHandler(name) != <span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;xxl-job jobhandler naming conflicts.&quot;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  registJobHandler(name, handler);</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="åˆå§‹åŒ–å®¢æˆ·ç«¯ï¼ˆè°ƒåº¦ä¸­å¿ƒï¼‰"><a href="#åˆå§‹åŒ–å®¢æˆ·ç«¯ï¼ˆè°ƒåº¦ä¸­å¿ƒï¼‰" class="headerlink" title="åˆå§‹åŒ–å®¢æˆ·ç«¯ï¼ˆè°ƒåº¦ä¸­å¿ƒï¼‰"></a>åˆå§‹åŒ–å®¢æˆ·ç«¯ï¼ˆè°ƒåº¦ä¸­å¿ƒï¼‰</h3><p>xxl-jobæ˜¯C/Sæ¶æ„çš„ï¼Œå®¢æˆ·ç«¯æ˜¯RPCæœåŠ¡çš„è°ƒç”¨è€…ï¼Œå³<code>xxl-job-admin</code>ï¼Œå¸¦æœ‰ä¸€ä¸ªå‰ç«¯ã€‚è¿™é‡Œå¯ä»¥æœ‰å¤šä¸ªè°ƒåº¦ä¸­å¿ƒï¼Œæ˜¯å› ä¸ºæ”¯æŒé›†ç¾¤éƒ¨ç½²ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;AdminBiz&gt; adminBizList;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">initAdminBizList</span><span class="params">(String adminAddresses, String accessToken)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">Â  Â  <span class="keyword">if</span> (adminAddresses!=<span class="keyword">null</span> &amp;&amp; adminAddresses.trim().length()&gt;<span class="number">0</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">for</span> (String address: adminAddresses.trim().split(<span class="string">&quot;,&quot;</span>)) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (address!=<span class="keyword">null</span> &amp;&amp; address.trim().length()&gt;<span class="number">0</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// http://ip:port/xxl-job-admin-1.8.2 + /api</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  String addressUrl = address.concat(AdminBiz.MAPPING);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  AdminBiz adminBiz = (AdminBiz) <span class="keyword">new</span> NetComClientProxy(AdminBiz.class, addressUrl, accessToken).getObject();</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (adminBizList == <span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  adminBizList = <span class="keyword">new</span> ArrayList&lt;AdminBiz&gt;();</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  adminBizList.add(adminBiz);</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;AdminBiz&gt; <span class="title">getAdminBizList</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â  Â  <span class="keyword">return</span> adminBizList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="åˆå§‹åŒ–RPCæœåŠ¡å™¨å·¥å‚"><a href="#åˆå§‹åŒ–RPCæœåŠ¡å™¨å·¥å‚" class="headerlink" title="åˆå§‹åŒ–RPCæœåŠ¡å™¨å·¥å‚"></a>åˆå§‹åŒ–RPCæœåŠ¡å™¨å·¥å‚</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> NetComServerFactory serverFactory = <span class="keyword">new</span> NetComServerFactory();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initExecutorServer</span><span class="params">(<span class="keyword">int</span> port, String ip, String appName, String accessToken)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">Â  Â  <span class="comment">// valid param</span></span><br><span class="line">Â  Â  port = port&gt;<span class="number">0</span>?port: NetUtil.findAvailablePort(<span class="number">9999</span>);</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">// start server</span></span><br><span class="line">Â  Â  NetComServerFactory.putService(ExecutorBiz.class, <span class="keyword">new</span> ExecutorBizImpl()); Â  <span class="comment">// rpc-service, base on jetty</span></span><br><span class="line">Â  Â  NetComServerFactory.setAccessToken(accessToken);</span><br><span class="line">Â  Â  serverFactory.start(port, ip, appName); <span class="comment">// jetty + registry</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä»»åŠ¡æ‰§è¡Œçº¿ç¨‹æ± "><a href="#ä»»åŠ¡æ‰§è¡Œçº¿ç¨‹æ± " class="headerlink" title="ä»»åŠ¡æ‰§è¡Œçº¿ç¨‹æ± "></a>ä»»åŠ¡æ‰§è¡Œçº¿ç¨‹æ± </h3><p>å¹¶æ²¡æœ‰ç”¨çº¿ç¨‹æ± ï¼Œè€Œæ˜¯ä¸€ä¸ªå¹¶å‘å“ˆå¸Œè¡¨ã€‚è¿™é‡Œæœ‰ä¸ªç–‘é—®ï¼Œå¦‚æœå¹¶å‘çº¿ç¨‹é‡è¿‡å¤§æ˜¯ä¸æ˜¯æœ‰å®‰å…¨é—®é¢˜ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> ConcurrentHashMap&lt;Integer, JobThread&gt; JobThreadRepository = <span class="keyword">new</span> ConcurrentHashMap&lt;Integer, JobThread&gt;();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> JobThread <span class="title">registJobThread</span><span class="params">(<span class="keyword">int</span> jobId, IJobHandler handler, String removeOldReason)</span></span>&#123;</span><br><span class="line">Â  Â  JobThread newJobThread = <span class="keyword">new</span> JobThread(jobId, handler);</span><br><span class="line">Â  Â  newJobThread.start();</span><br><span class="line">Â  Â  logger.info(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job regist JobThread success, jobId:&#123;&#125;, handler:&#123;&#125;&quot;</span>, <span class="keyword">new</span> Object[]&#123;jobId, handler&#125;);</span><br><span class="line"></span><br><span class="line">Â  Â  JobThread oldJobThread = JobThreadRepository.put(jobId, newJobThread); Â <span class="comment">// putIfAbsent | oh my god, map&#x27;s put method return the old value!!!</span></span><br><span class="line">Â  Â  <span class="keyword">if</span> (oldJobThread != <span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  oldJobThread.toStop(removeOldReason);</span><br><span class="line">Â  Â  Â  Â  oldJobThread.interrupt();</span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">return</span> newJobThread;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">removeJobThread</span><span class="params">(<span class="keyword">int</span> jobId, String removeOldReason)</span></span>&#123;</span><br><span class="line">Â  Â  JobThread oldJobThread = JobThreadRepository.remove(jobId);</span><br><span class="line">Â  Â  <span class="keyword">if</span> (oldJobThread != <span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  oldJobThread.toStop(removeOldReason);</span><br><span class="line">Â  Â  Â  Â  oldJobThread.interrupt();</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> JobThread <span class="title">loadJobThread</span><span class="params">(<span class="keyword">int</span> jobId)</span></span>&#123;</span><br><span class="line">Â  Â  JobThread jobThread = JobThreadRepository.get(jobId);</span><br><span class="line">Â  Â  <span class="keyword">return</span> jobThread;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="WebæœåŠ¡å™¨"><a href="#WebæœåŠ¡å™¨" class="headerlink" title="WebæœåŠ¡å™¨"></a>WebæœåŠ¡å™¨</h2><p>è¯¥æœåŠ¡å™¨ç”¨äºè·å–è¯·æ±‚ã€æ‰§è¡Œä»»åŠ¡ï¼Œæ˜¯æ ¸å¿ƒçš„æ‰§è¡Œé€»è¾‘ã€‚</p><p>ä¸»ä½“æ˜¯å°è£…äº†ä¸€ä¸ªjettyæœåŠ¡å™¨ï¼ˆservletå®¹å™¨ï¼ŒHTTPåè®®ï¼‰ï¼Œåˆ©ç”¨åå°„å®ç°æœåŠ¡è°ƒç”¨ã€‚</p><p>ç›¸å…³ç±»å¦‚ä¸‹ï¼š</p><ul><li>NetComServerFactoryï¼šRPCæœåŠ¡å™¨å·¥å‚ç±»ï¼ŒåŒæ—¶è´Ÿè´£ç»´æŠ¤RPCæœåŠ¡ã€‚</li><li>JettyServerï¼šæ ¸å¿ƒç±»ï¼ŒçœŸæ­£è¿è¡Œçš„æœåŠ¡å™¨ã€‚</li><li>JettyServerHandlerï¼šjettyçš„handlerï¼Œè´Ÿè´£æ‰§è¡Œä»»åŠ¡ã€‚</li><li>ExecutorBizï¼šåŒ…å«RPCæ–¹æ³•çš„æ¥å£ï¼Œè¢«å·¥å‚ç±»åŠ è½½å¹¶æ‰§è¡Œè¯·æ±‚è°ƒç”¨çš„RPCæ–¹æ³•ã€‚</li><li>ExecutorBizImplï¼šçœŸæ­£æä¾›æœåŠ¡çš„ç±»ï¼Œå®ç°äº†ExecutorBizæ¥å£ã€‚</li><li>JobThreadï¼šçœŸæ­£æ‰§è¡Œä»»åŠ¡ï¼ˆå®ŒæˆJobï¼‰çš„çº¿ç¨‹ï¼Œç»´æŠ¤ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ç”¨äºæ‰§è¡Œä»»åŠ¡ã€‚</li><li>ExecutorRegistryThreadï¼šç”¨äºå°†æœåŠ¡å™¨æ³¨å†Œåˆ°å®¢æˆ·ç«¯ä¸Šï¼Œæˆ–å–æ¶ˆæ³¨å†Œã€‚</li><li>TriggerCallbackThreadï¼šç»´æŠ¤ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ï¼Œç”¨äºå¯¹ä»»åŠ¡æ‰§è¡Œç»“æœå®æ–½callbackã€‚</li></ul><h3 id="NetComServerFactory"><a href="#NetComServerFactory" class="headerlink" title="NetComServerFactory"></a>NetComServerFactory</h3><p>å…¥å£ä¸­åˆå§‹åŒ–çš„å°±æ˜¯è¿™ä¸ªServerå·¥å‚ï¼Œå·¥å‚é‡Œé¢å†…å®¹å¾ˆç®€å•ï¼Œç®€åŒ–åå¦‚ä¸‹:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœåŠ¡å™¨ï¼Œæ ¸å¿ƒç±»</span></span><br><span class="line">JettyServer server = <span class="keyword">new</span> JettyServer(); <span class="comment">//æœ‰start(), destroy()ä¸¤ä¸ªæ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// RPCæœåŠ¡å­˜å‚¨ï¼Œé€šè¿‡åå°„åŠ è½½è¿›æ¥</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, Object&gt; serviceMap = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line"><span class="comment">// è®¤è¯tokenï¼Œæºå¸¦æ­£ç¡®tokençš„è¯·æ±‚æ‰èƒ½è¢«æ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> String accessToken;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–ä¸­æ”¾å…¥ExecutorBizçš„æ–¹æ³•ï¼ŒKeyæ˜¯æ¥å£å</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">putService</span><span class="params">(Class&lt;?&gt; iface, Object serviceBean)</span></span>&#123;</span><br><span class="line">Â  Â  serviceMap.put(iface.getName(), serviceBean);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–ä¸­è®¾ç½®tokençš„æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setAccessToken</span><span class="params">(String accessToken)</span> </span>&#123;</span><br><span class="line">Â  Â  NetComServerFactory.accessToken = accessToken;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// çœŸæ­£å®ç°RPCæœåŠ¡è°ƒç”¨çš„é™æ€æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> RpcResponse <span class="title">invokeService</span><span class="params">(RpcRequest request, Object serviceBean)</span> </span>&#123;</span><br><span class="line">Â  Â  ...</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">try</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Class&lt;?&gt; serviceClass = serviceBean.getClass();</span><br><span class="line">Â  Â  Â  Â  String methodName = request.getMethodName();</span><br><span class="line">Â  Â  Â  Â  Class&lt;?&gt;[] parameterTypes = request.getParameterTypes();</span><br><span class="line">Â  Â  Â  Â  Object[] parameters = request.getParameters();</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  FastClass serviceFastClass = FastClass.create(serviceClass);</span><br><span class="line">Â  Â  Â  Â  FastMethod serviceFastMethod = serviceFastClass.getMethod(methodName, parameterTypes);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Object result = serviceFastMethod.invoke(serviceBean, parameters);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  response.setResult(result);</span><br><span class="line">Â  Â  &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">Â  Â  Â  Â  t.printStackTrace();</span><br><span class="line">Â  Â  Â  Â  response.setError(t.getMessage());</span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">return</span> response;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="JettyServer"><a href="#JettyServer" class="headerlink" title="JettyServer"></a>JettyServer</h3><p><code>JettyServer</code>åŒ…å«æœåŠ¡å™¨ï¼ˆéé˜»å¡çº¿ç¨‹æ± ï¼‰ã€æ³¨å†Œçº¿ç¨‹ã€å›è°ƒçº¿ç¨‹ä¸‰éƒ¨åˆ†ã€‚</p><p>ç®€åŒ–ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JettyServer</span> </span>&#123;</span><br><span class="line">Â  Â  <span class="keyword">private</span> Server server;</span><br><span class="line">Â  Â  <span class="keyword">private</span> Thread thread;</span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> port, <span class="keyword">final</span> String ip, <span class="keyword">final</span> String appName)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">Â  Â  Â  Â  thread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="meta">@Override</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// The Server</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  server = <span class="keyword">new</span> Server(<span class="keyword">new</span> ExecutorThreadPool()); Â <span class="comment">// éé˜»å¡</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// HTTP connector</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  ServerConnector connector = <span class="keyword">new</span> ServerConnector(server);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  connector.setHost(ip);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  connector.setPort(port);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  server.setConnectors(<span class="keyword">new</span> Connector[]&#123;connector&#125;);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// Set a handler</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  HandlerCollection handlerc =<span class="keyword">new</span> HandlerCollection();</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  handlerc.setHandlers(<span class="keyword">new</span> Handler[]&#123;<span class="keyword">new</span> JettyServerHandler()&#125;);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  server.setHandler(handlerc);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// Start server</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  server.start();</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// Start Registry-Server</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  ExecutorRegistryThread.getInstance().start(port, ip, appName);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// Start Callback-Server</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  TriggerCallbackThread.getInstance().start();</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  server.join(); Â <span class="comment">// block until thread stopped</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;);</span><br><span class="line">Â  Â  Â  Â  thread.setDaemon(<span class="keyword">true</span>); <span class="comment">// daemon, service jvm, user thread leave &gt;&gt;&gt; daemon leave &gt;&gt;&gt; jvm leave</span></span><br><span class="line">Â  Â  Â  Â  thread.start();</span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="comment">// destroy Registry-Server</span></span><br><span class="line">Â  Â  Â  Â  ExecutorRegistryThread.getInstance().toStop();</span><br><span class="line">Â  Â  Â  Â  <span class="comment">// destroy Callback-Server</span></span><br><span class="line">Â  Â  Â  Â  TriggerCallbackThread.getInstance().toStop();</span><br><span class="line">Â  Â  Â  Â  <span class="comment">// å…³é—­æœåŠ¡å™¨</span></span><br><span class="line">Â  Â  Â  Â  server.stop();</span><br><span class="line">Â  Â  Â  Â  server.destroy();</span><br><span class="line">Â  Â  Â  Â  <span class="comment">// å…³é—­æ€»çº¿ç¨‹</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (thread.isAlive()) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  thread.interrupt();</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å€¼å¾—æ³¨æ„çš„æ˜¯è¿™é‡Œçš„<code>ExecutorThreadPool</code>æ˜¯jettyè‡ªå·±å°è£…çš„<code>ThreadPoolExecutor</code>ï¼Œæœ€å¤§çº¿ç¨‹æ± å¤§å°ä¸º256, çº¿ç¨‹timeoutä¸º1åˆ†é’Ÿï¼Œå¹¶ä½¿ç”¨äº†<code>Unbounded LinkedBlockingQueue</code>ä½œä¸ºä»»åŠ¡é˜Ÿåˆ—ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ExecutorThreadPool</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Â  Â  <span class="comment">// Using an unbounded queue makes the maxThreads parameter useless</span></span><br><span class="line">Â  Â  <span class="comment">// Refer to ThreadPoolExecutor javadocs for details</span></span><br><span class="line">Â  Â  <span class="keyword">this</span>(<span class="keyword">new</span> ThreadPoolExecutor(<span class="number">256</span>, <span class="number">256</span>, <span class="number">60</span>, TimeUnit.SECONDS, <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JettyServerHandler"><a href="#JettyServerHandler" class="headerlink" title="JettyServerHandler"></a>JettyServerHandler</h3><p>è¿™ä¸ªç±»å°±æ˜¯ç”¨æ¥è¡”æ¥jettyæ¥åˆ°çš„è¯·æ±‚å’Œå®é™…å¤„ç†æ–¹æ³•<code>NetComServerFactory#invokeService</code>çš„ï¼Œå¯¹å…¥å‚å‡ºå‚å’Œå¼‚å¸¸è¿›è¡Œä¸€äº›å¤„ç†ã€‚</p><p>ç®€åŒ–ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JettyServerHandler</span> <span class="keyword">extends</span> <span class="title">AbstractHandler</span> </span>&#123;</span><br><span class="line">Â  Â  <span class="meta">@Override</span></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String target, Request baseRequest, HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="comment">// invoke</span></span><br><span class="line">Â  Â  Â  Â  RpcResponse rpcResponse = doInvoke(request);</span><br><span class="line">Â  Â  Â  Â  <span class="comment">// serialize response</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">byte</span>[] responseBytes = HessianSerializer.serialize(rpcResponse);</span><br><span class="line">Â  Â  Â  Â  </span><br><span class="line">Â  Â  Â  Â  response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">Â  Â  Â  Â  response.setStatus(HttpServletResponse.SC_OK);</span><br><span class="line">Â  Â  Â  Â  baseRequest.setHandled(<span class="keyword">true</span>);</span><br><span class="line">Â  Â  Â  Â  </span><br><span class="line">Â  Â  Â  Â  OutputStream out = response.getOutputStream();</span><br><span class="line">Â  Â  Â  Â  out.write(responseBytes);</span><br><span class="line">Â  Â  Â  Â  out.flush();</span><br><span class="line">Â  Â  Â  Â  </span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">private</span> RpcResponse <span class="title">doInvoke</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">try</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment">// deserialize request</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">byte</span>[] requestBytes = HttpClientUtil.readBytes(request);</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (requestBytes == <span class="keyword">null</span> || requestBytes.length==<span class="number">0</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  RpcResponse rpcResponse = <span class="keyword">new</span> RpcResponse();</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  rpcResponse.setError(<span class="string">&quot;RpcRequest byte[] is null&quot;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> rpcResponse;</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  RpcRequest rpcRequest = (RpcRequest) HessianSerializer.deserialize(requestBytes, RpcRequest.class);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment">// invoke</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  RpcResponse rpcResponse = NetComServerFactory.invokeService(rpcRequest, <span class="keyword">null</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> rpcResponse;</span><br><span class="line">Â  Â  Â  Â  &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  RpcResponse rpcResponse = <span class="keyword">new</span> RpcResponse();</span><br><span class="line">Â  Â  Â  Â  Â  Â  rpcResponse.setError(<span class="string">&quot;Server-error:&quot;</span> + e.getMessage());</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> rpcResponse;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="ExecutorBizImpl"><a href="#ExecutorBizImpl" class="headerlink" title="ExecutorBizImpl"></a>ExecutorBizImpl</h3><p>çœŸæ­£æ‰§è¡Œä»»åŠ¡çš„ç±»ï¼Œå®ç°äº†<code>ExecutorBiz</code>æ¥å£ã€‚</p><p><code>ExecutorBiz</code>æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ExecutorBiz</span> </span>&#123;</span><br><span class="line">Â  Â  <span class="comment">// å¿ƒè·³ï¼Œç”¨äºç¡®è®¤æœåŠ¡å™¨çŠ¶æ€</span></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> ReturnT&lt;String&gt; <span class="title">beat</span><span class="params">()</span></span>;</span><br><span class="line">Â  Â  <span class="comment">// åˆ¤æ–­ä»»åŠ¡æ˜¯å¦åœ¨æ‰§è¡Œ</span></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> ReturnT&lt;String&gt; <span class="title">idleBeat</span><span class="params">(<span class="keyword">int</span> jobId)</span></span>;</span><br><span class="line">Â  Â  <span class="comment">// ç»ˆæ­¢ä»»åŠ¡</span></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> ReturnT&lt;String&gt; <span class="title">kill</span><span class="params">(<span class="keyword">int</span> jobId)</span></span>;</span><br><span class="line">Â  Â  <span class="comment">// è¯»æ—¥å¿—ï¼Œè¿”å›æ—¥å¿—å†…å®¹</span></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> ReturnT&lt;LogResult&gt; <span class="title">log</span><span class="params">(<span class="keyword">long</span> logDateTim, <span class="keyword">int</span> logId, <span class="keyword">int</span> fromLineNum)</span></span>;</span><br><span class="line">Â  Â  <span class="comment">// æ ¹æ®å‚æ•°æ‰§è¡Œä»»åŠ¡ï¼ŒTriggerParamé‡Œæºå¸¦jobId</span></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> ReturnT&lt;String&gt; <span class="title">run</span><span class="params">(TriggerParam triggerParam)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>ExecutorBizImpl</code>é€šè¿‡ä¸Šä¸‹æ–‡<code>XxlJobExecutor</code>è·å–èµ„æºï¼ˆä¾‹å¦‚<code>JobThread</code>ï¼‰å®ç°å„ä¸ªåŠŸèƒ½ï¼Œè¿™é‡Œæˆ‘ä»¬åªå…³æ³¨<code>run</code>æ–¹æ³•çš„å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ReturnT&lt;String&gt; <span class="title">run</span><span class="params">(TriggerParam triggerParam)</span> </span>&#123;</span><br><span class="line">Â  Â  <span class="comment">// å°è¯•åŠ è½½å·²æœ‰çº¿ç¨‹ï¼Œæ²¡æœ‰åˆ™éƒ½ç½®ä¸ºç©º</span></span><br><span class="line">Â  Â  <span class="comment">// load oldï¼šjobHandler + jobThread</span></span><br><span class="line">Â  Â  JobThread jobThread = XxlJobExecutor.loadJobThread(triggerParam.getJobId());</span><br><span class="line">Â  Â  IJobHandler jobHandler = jobThread!=<span class="keyword">null</span>?jobThread.getHandler():<span class="keyword">null</span>;</span><br><span class="line">Â  Â  String removeOldReason = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">// è¿™é‡Œæœ‰å‡ ç§æ‰§è¡Œæ¨¡å¼ï¼Œbeanã€glueå’Œscriptï¼Œé€šå¸¸è‡ªå·±å®ç°çš„æ˜¯ç”¨beanæ¨¡å¼ï¼Œéœ€è¦éªŒè¯ä¸€ä¸‹</span></span><br><span class="line">Â  Â  <span class="comment">// éªŒè¯å¦‚æœåŸæ¥çš„jobHandlerä¸å¯¹ï¼Œé‚£ä¹ˆä¹Ÿè¦ç½®ç©º</span></span><br><span class="line">Â  Â  <span class="comment">// validï¼šjobHandler + jobThread</span></span><br><span class="line">Â  Â  GlueTypeEnum glueTypeEnum = GlueTypeEnum.match(triggerParam.getGlueType());</span><br><span class="line">Â  Â  <span class="keyword">if</span> (GlueTypeEnum.BEAN == glueTypeEnum) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="comment">// new jobhandler</span></span><br><span class="line">Â  Â  Â  Â  IJobHandler newJobHandler = XxlJobExecutor.loadJobHandler(triggerParam.getExecutorHandler());</span><br><span class="line">Â  Â  Â  Â  <span class="comment">// valid old jobThread</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (jobThread!=<span class="keyword">null</span> &amp;&amp; jobHandler != newJobHandler) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment">// change handler, need kill old thread</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  removeOldReason = <span class="string">&quot;æ›´æ¢JobHandleræˆ–æ›´æ¢ä»»åŠ¡æ¨¡å¼,ç»ˆæ­¢æ—§ä»»åŠ¡çº¿ç¨‹&quot;</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  jobThread = <span class="keyword">null</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  jobHandler = <span class="keyword">null</span>;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  <span class="comment">// valid handler</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (jobHandler == <span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  jobHandler = newJobHandler;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (jobHandler == <span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">new</span> ReturnT&lt;String&gt;(ReturnT.FAIL_CODE, <span class="string">&quot;job handler [&quot;</span> + triggerParam.getExecutorHandler() + <span class="string">&quot;] not found.&quot;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (GlueTypeEnum.GLUE_GROOVY == glueTypeEnum) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="comment">// valid old jobThread</span></span><br><span class="line">Â  Â  Â  Â  ...</span><br><span class="line">Â  Â  Â  Â  <span class="comment">// valid handler</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (jobHandler == <span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">try</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  IJobHandler originJobHandler = GlueFactory.getInstance().loadNewInstance(triggerParam.getGlueSource());</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  jobHandler = <span class="keyword">new</span> GlueJobHandler(originJobHandler, triggerParam.getGlueUpdatetime());</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  logger.error(e.getMessage(), e);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">new</span> ReturnT&lt;String&gt;(ReturnT.FAIL_CODE, e.getMessage());</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (glueTypeEnum!=<span class="keyword">null</span> &amp;&amp; glueTypeEnum.isScript()) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="comment">// valid old jobThread</span></span><br><span class="line">Â  Â  Â  Â  ...</span><br><span class="line">Â  Â  Â  Â  <span class="comment">// valid handler</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (jobHandler == <span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  jobHandler = <span class="keyword">new</span> ScriptJobHandler(triggerParam.getJobId(), triggerParam.getGlueUpdatetime(), triggerParam.getGlueSource(), GlueTypeEnum.match(triggerParam.getGlueType()));</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">new</span> ReturnT&lt;String&gt;(ReturnT.FAIL_CODE, <span class="string">&quot;glueType[&quot;</span> + triggerParam.getGlueType() + <span class="string">&quot;] is not valid.&quot;</span>);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">// æ ¹æ®è®¾ç½®çš„é˜»å¡ç­–ç•¥ï¼Œé€‰æ‹©æ˜¯å¦ä¸¢å¼ƒå·²æœ‰çº¿ç¨‹</span></span><br><span class="line">Â  Â  <span class="comment">// executor block strategy</span></span><br><span class="line">Â  Â  <span class="keyword">if</span> (jobThread != <span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  ExecutorBlockStrategyEnum blockStrategy = ExecutorBlockStrategyEnum.match(triggerParam.getExecutorBlockStrategy(), <span class="keyword">null</span>);</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (ExecutorBlockStrategyEnum.DISCARD_LATER == blockStrategy) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment">// discard when running</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (jobThread.isRunningOrHasQueue()) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">new</span> ReturnT&lt;String&gt;(ReturnT.FAIL_CODE, <span class="string">&quot;é˜»å¡å¤„ç†ç­–ç•¥-ç”Ÿæ•ˆï¼š&quot;</span>+ExecutorBlockStrategyEnum.DISCARD_LATER.getTitle());</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ExecutorBlockStrategyEnum.COVER_EARLY == blockStrategy) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment">// kill running jobThread</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (jobThread.isRunningOrHasQueue()) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  removeOldReason = <span class="string">&quot;é˜»å¡å¤„ç†ç­–ç•¥-ç”Ÿæ•ˆï¼š&quot;</span> + ExecutorBlockStrategyEnum.COVER_EARLY.getTitle();</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  jobThread = <span class="keyword">null</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment">// just queue trigger</span></span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="comment">// æ³¨å†Œæ–°çš„ä»»åŠ¡çº¿ç¨‹å¹¶æ·»åŠ ä»»åŠ¡</span></span><br><span class="line">Â  Â  <span class="comment">// replace thread (new or exists invalid)</span></span><br><span class="line">Â  Â  <span class="keyword">if</span> (jobThread == <span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  jobThread = XxlJobExecutor.registJobThread(triggerParam.getJobId(), jobHandler, removeOldReason);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="comment">// push data to queue</span></span><br><span class="line">Â  Â  ReturnT&lt;String&gt; pushResult = jobThread.pushTriggerQueue(triggerParam);</span><br><span class="line">Â  Â  <span class="keyword">return</span> pushResult;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JobThread"><a href="#JobThread" class="headerlink" title="JobThread"></a>JobThread</h3><p>è¿™æ˜¯æœ€ç»ˆæ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ï¼Œé€šè¿‡å‰é¢çš„åˆ†æå¯ä»¥çœ‹åˆ°ï¼Œä¸€é¡¹ä»»åŠ¡è¢«æœ€ç»ˆäº¤ä»˜ç»™äº†TriggerQueueï¼Œå¹¶ç­‰å¾…å®Œæˆæ‰§è¡Œå›è°ƒå®ç°å¼‚æ­¥æ‰§è¡Œã€‚</p><p>é‚£ä¹ˆä»€ä¹ˆæ˜¯TriggerQueueï¼Ÿå®ƒæ˜¯ä¸€ä¸ªå­˜æ”¾Triggerå‚æ•°çš„<code>LinkedBlockingQueue</code>é˜»å¡é˜Ÿåˆ—ï¼Œç”¨äºå­˜æ”¾å¾…æ‰§è¡Œçš„ä»»åŠ¡ã€‚</p><p><code>JobThread</code>ä¼šæŒ‰æŒ‡å®šçš„æ—¶é—´é—´éš”è½®è¯¢è¯¥é˜Ÿåˆ—ï¼Œå°è¯•å–å‡ºä»»åŠ¡æ‰§è¡Œã€‚ä»»åŠ¡æ‰§è¡Œç»“æŸåï¼Œå°†ç»“æœäº¤ç»™Callbackçº¿ç¨‹æ‰§è¡Œå›è°ƒã€‚</p><p>è¿˜æœ‰ä¸€äº›å…¶ä»–ç»†èŠ‚ï¼Œä¾‹å¦‚å”¯ä¸€æ—¥å¿—IDçš„ç»´æŠ¤ï¼ˆé€šè¿‡Setï¼‰ï¼Œç»ˆæ­¢ä»»åŠ¡çš„å®ç°ï¼ˆå¤šç§æƒ…å†µï¼‰ï¼Œå¯ä»¥å‚è€ƒä»£ç åˆ†æã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JobThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">Â  Â  <span class="keyword">private</span> <span class="keyword">static</span> Logger logger = LoggerFactory.getLogger(JobThread.class);</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">private</span> <span class="keyword">int</span> jobId;</span><br><span class="line">Â  Â  <span class="keyword">private</span> IJobHandler handler;</span><br><span class="line">Â  Â  <span class="keyword">private</span> LinkedBlockingQueue&lt;TriggerParam&gt; triggerQueue;</span><br><span class="line">Â  Â  <span class="keyword">private</span> ConcurrentHashSet&lt;Integer&gt; triggerLogIdSet; Â  Â  <span class="comment">// avoid repeat trigger for the same TRIGGER_LOG_ID</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">private</span> <span class="keyword">boolean</span> toStop = <span class="keyword">false</span>;</span><br><span class="line">Â  Â  <span class="keyword">private</span> String stopReason;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">private</span> <span class="keyword">boolean</span> running = <span class="keyword">false</span>; Â  Â <span class="comment">// if running job</span></span><br><span class="line">Â  Â  <span class="keyword">private</span> <span class="keyword">int</span> idleTimes = <span class="number">0</span>; Â  Â  Â  Â  Â <span class="comment">// idel times</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> <span class="title">JobThread</span><span class="params">(<span class="keyword">int</span> jobId, IJobHandler handler)</span> </span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">this</span>.jobId = jobId;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">this</span>.handler = handler;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">this</span>.triggerQueue = <span class="keyword">new</span> LinkedBlockingQueue&lt;TriggerParam&gt;();</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">this</span>.triggerLogIdSet = <span class="keyword">new</span> ConcurrentHashSet&lt;Integer&gt;();</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> IJobHandler <span class="title">getHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> handler;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â  Â  Â * new trigger to queue</span></span><br><span class="line"><span class="comment">Â  Â  Â *</span></span><br><span class="line"><span class="comment">Â  Â  Â * <span class="doctag">@param</span> triggerParam</span></span><br><span class="line"><span class="comment">Â  Â  Â * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">Â  Â  Â */</span></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> ReturnT&lt;String&gt; <span class="title">pushTriggerQueue</span><span class="params">(TriggerParam triggerParam)</span> </span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="comment">// avoid repeat</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (triggerLogIdSet.contains(triggerParam.getLogId())) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  logger.info(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; repeate trigger job, logId:&#123;&#125;&quot;</span>, triggerParam.getLogId());</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">new</span> ReturnT&lt;String&gt;(ReturnT.FAIL_CODE, <span class="string">&quot;repeate trigger job, logId:&quot;</span> + triggerParam.getLogId());</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  triggerLogIdSet.add(triggerParam.getLogId());</span><br><span class="line">Â  Â  Â  Â  triggerQueue.add(triggerParam);</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> ReturnT.SUCCESS;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â  Â  Â * kill job thread</span></span><br><span class="line"><span class="comment">Â  Â  Â *</span></span><br><span class="line"><span class="comment">Â  Â  Â * <span class="doctag">@param</span> stopReason</span></span><br><span class="line"><span class="comment">Â  Â  Â */</span></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">toStop</span><span class="params">(String stopReason)</span> </span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â  Â  Â  Â  Â * Thread.interruptåªæ”¯æŒç»ˆæ­¢çº¿ç¨‹çš„é˜»å¡çŠ¶æ€(waitã€joinã€sleep)ï¼Œ</span></span><br><span class="line"><span class="comment">Â  Â  Â  Â  Â * åœ¨é˜»å¡å‡ºæŠ›å‡ºInterruptedExceptionå¼‚å¸¸,ä½†æ˜¯å¹¶ä¸ä¼šç»ˆæ­¢è¿è¡Œçš„çº¿ç¨‹æœ¬èº«ï¼›</span></span><br><span class="line"><span class="comment">Â  Â  Â  Â  Â * æ‰€ä»¥éœ€è¦æ³¨æ„ï¼Œæ­¤å¤„å½»åº•é”€æ¯æœ¬çº¿ç¨‹ï¼Œéœ€è¦é€šè¿‡å…±äº«å˜é‡æ–¹å¼ï¼›</span></span><br><span class="line"><span class="comment">Â  Â  Â  Â  Â */</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">this</span>.toStop = <span class="keyword">true</span>;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">this</span>.stopReason = stopReason;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">/**</span></span><br><span class="line"><span class="comment">Â  Â  Â * is running job</span></span><br><span class="line"><span class="comment">Â  Â  Â * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">Â  Â  Â */</span></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isRunningOrHasQueue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> running || triggerQueue.size()&gt;<span class="number">0</span>;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="meta">@Override</span></span><br><span class="line">Â  Â  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment">// init</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">try</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  handler.init();</span><br><span class="line">Â  Â  Â  Â  &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  logger.error(e.getMessage(), e);</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment">// execute</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">while</span>(!toStop)&#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  running = <span class="keyword">false</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  idleTimes++;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  TriggerParam triggerParam = <span class="keyword">null</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  ReturnT&lt;String&gt; executeResult = <span class="keyword">null</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">try</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// to check toStop signal, we need cycle, so wo cannot use queue.take(), instand of poll(timeout)</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  triggerParam = triggerQueue.poll(<span class="number">3L</span>, TimeUnit.SECONDS);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (triggerParam!=<span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  running = <span class="keyword">true</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  idleTimes = <span class="number">0</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  triggerLogIdSet.remove(triggerParam.getLogId());</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// log filename, like &quot;logPath/yyyy-MM-dd/9999.log&quot;</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  String logFileName = XxlJobFileAppender.makeLogFileName(<span class="keyword">new</span> Date(triggerParam.getLogDateTim()), triggerParam.getLogId());</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  XxlJobFileAppender.contextHolder.set(logFileName);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ShardingUtil.setShardingVo(<span class="keyword">new</span> ShardingUtil.ShardingVO(triggerParam.getBroadcastIndex(), triggerParam.getBroadcastTotal()));</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// execute</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  XxlJobLogger.log(<span class="string">&quot;&lt;br&gt;----------- xxl-job job execute start -----------&lt;br&gt;----------- Param:&quot;</span> + triggerParam.getExecutorParams());</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  executeResult = handler.execute(triggerParam.getExecutorParams());</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (executeResult == <span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  executeResult = IJobHandler.FAIL;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  XxlJobLogger.log(<span class="string">&quot;&lt;br&gt;----------- xxl-job job execute end(finish) -----------&lt;br&gt;----------- ReturnT:&quot;</span> + executeResult);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (idleTimes &gt; <span class="number">30</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  XxlJobExecutor.removeJobThread(jobId, <span class="string">&quot;excutor idel times over limit.&quot;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (toStop) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  XxlJobLogger.log(<span class="string">&quot;&lt;br&gt;----------- JobThread toStop, stopReason:&quot;</span> + stopReason);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  StringWriter stringWriter = <span class="keyword">new</span> StringWriter();</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  e.printStackTrace(<span class="keyword">new</span> PrintWriter(stringWriter));</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  String errorMsg = stringWriter.toString();</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  executeResult = <span class="keyword">new</span> ReturnT&lt;String&gt;(ReturnT.FAIL_CODE, errorMsg);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  XxlJobLogger.log(<span class="string">&quot;&lt;br&gt;----------- JobThread Exception:&quot;</span> + errorMsg + <span class="string">&quot;&lt;br&gt;----------- xxl-job job execute end(error) -----------&quot;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">if</span>(triggerParam != <span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// callback handler info</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (!toStop) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// commonm</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  TriggerCallbackThread.pushCallBack(<span class="keyword">new</span> HandleCallbackParam(triggerParam.getLogId(), executeResult));</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// is killed</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ReturnT&lt;String&gt; stopResult = <span class="keyword">new</span> ReturnT&lt;String&gt;(ReturnT.FAIL_CODE, stopReason + <span class="string">&quot; [ä¸šåŠ¡è¿è¡Œä¸­ï¼Œè¢«å¼ºåˆ¶ç»ˆæ­¢]&quot;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  TriggerCallbackThread.pushCallBack(<span class="keyword">new</span> HandleCallbackParam(triggerParam.getLogId(), stopResult));</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment">// callback trigger request in queue</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">while</span>(triggerQueue !=<span class="keyword">null</span> &amp;&amp; triggerQueue.size()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  TriggerParam triggerParam = triggerQueue.poll();</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (triggerParam!=<span class="keyword">null</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// is killed</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  ReturnT&lt;String&gt; stopResult = <span class="keyword">new</span> ReturnT&lt;String&gt;(ReturnT.FAIL_CODE, stopReason + <span class="string">&quot; [ä»»åŠ¡å°šæœªæ‰§è¡Œï¼Œåœ¨è°ƒåº¦é˜Ÿåˆ—ä¸­è¢«ç»ˆæ­¢]&quot;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  TriggerCallbackThread.pushCallBack(<span class="keyword">new</span> HandleCallbackParam(triggerParam.getLogId(), stopResult));</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment">// destroy</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">try</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  handler.destroy();</span><br><span class="line">Â  Â  Â  Â  &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  logger.error(e.getMessage(), e);</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  logger.info(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job JobThread stoped, hashCode:&#123;&#125;&quot;</span>, Thread.currentThread());</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="TriggerCallbackThread"><a href="#TriggerCallbackThread" class="headerlink" title="TriggerCallbackThread"></a>TriggerCallbackThread</h3><p>å›è°ƒçº¿ç¨‹ï¼Œç”¨äºå¤„ç†æ‰§è¡Œå®Œçš„ä»»åŠ¡ç»“æœï¼Œé€šçŸ¥è°ƒåº¦ä¸­å¿ƒæ‰§è¡Œå®Œæ¯•ã€‚</p><p>åŒæ ·çš„ï¼Œä½¿ç”¨ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—å­˜æ”¾å¾…å›è°ƒçš„æ‰§è¡Œç»“æœã€‚</p><p>ä»£ç ç®€åŒ–åå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TriggerCallbackThread</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> TriggerCallbackThread instance = <span class="keyword">new</span> TriggerCallbackThread();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> TriggerCallbackThread <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// job results callback queue</span></span><br><span class="line">    <span class="keyword">private</span> LinkedBlockingQueue&lt;HandleCallbackParam&gt; callBackQueue = <span class="keyword">new</span> LinkedBlockingQueue&lt;HandleCallbackParam&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">pushCallBack</span><span class="params">(HandleCallbackParam callback)</span></span>&#123;</span><br><span class="line">        getInstance().callBackQueue.add(callback);</span><br><span class="line">        logger.debug(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job, push callback request, logId:&#123;&#125;&quot;</span>, callback.getLogId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// callback thread</span></span><br><span class="line">    <span class="keyword">private</span> Thread triggerCallbackThread;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">boolean</span> toStop = <span class="keyword">false</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        triggerCallbackThread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="comment">// normal callback</span></span><br><span class="line">                <span class="keyword">while</span>(!toStop)&#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        HandleCallbackParam callback = getInstance().callBackQueue.take();</span><br><span class="line">                        <span class="keyword">if</span> (callback != <span class="keyword">null</span>) &#123;</span><br><span class="line">                            <span class="comment">// callback list param</span></span><br><span class="line">                            List&lt;HandleCallbackParam&gt; callbackParamList = <span class="keyword">new</span> ArrayList&lt;HandleCallbackParam&gt;();</span><br><span class="line">                            <span class="keyword">int</span> drainToNum = getInstance().callBackQueue.drainTo(callbackParamList);</span><br><span class="line">                            callbackParamList.add(callback);</span><br><span class="line">                            <span class="comment">// callback, will retry if error</span></span><br><span class="line">                            <span class="keyword">if</span> (callbackParamList!=<span class="keyword">null</span> &amp;&amp; callbackParamList.size()&gt;<span class="number">0</span>) &#123;</span><br><span class="line">                                doCallback(callbackParamList);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                        logger.error(e.getMessage(), e);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// last callback</span></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    List&lt;HandleCallbackParam&gt; callbackParamList = <span class="keyword">new</span> ArrayList&lt;HandleCallbackParam&gt;();</span><br><span class="line">                    <span class="keyword">int</span> drainToNum = getInstance().callBackQueue.drainTo(callbackParamList);</span><br><span class="line">                    <span class="keyword">if</span> (callbackParamList!=<span class="keyword">null</span> &amp;&amp; callbackParamList.size()&gt;<span class="number">0</span>) &#123;</span><br><span class="line">                        doCallback(callbackParamList);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    logger.error(e.getMessage(), e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        triggerCallbackThread.setDaemon(<span class="keyword">true</span>);</span><br><span class="line">        triggerCallbackThread.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">toStop</span><span class="params">()</span></span>&#123;</span><br><span class="line">        toStop = <span class="keyword">true</span>;</span><br><span class="line">        <span class="comment">// interrupt and wait</span></span><br><span class="line">        triggerCallbackThread.interrupt();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            triggerCallbackThread.join();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            logger.error(e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// do callback, will retry if error</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doCallback</span><span class="params">(List&lt;HandleCallbackParam&gt; callbackParamList)</span></span>&#123;</span><br><span class="line">        <span class="comment">// callback, will retry if error</span></span><br><span class="line">        <span class="keyword">for</span> (AdminBiz adminBiz: XxlJobExecutor.getAdminBizList()) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                ReturnT&lt;String&gt; callbackResult = adminBiz.callback(callbackParamList);</span><br><span class="line">                <span class="keyword">if</span> (callbackResult!=<span class="keyword">null</span> &amp;&amp; ReturnT.SUCCESS_CODE == callbackResult.getCode()) &#123;</span><br><span class="line">                    callbackResult = ReturnT.SUCCESS;</span><br><span class="line">                    logger.info(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job callback success, callbackParamList:&#123;&#125;, callbackResult:&#123;&#125;&quot;</span>, <span class="keyword">new</span> Object[]&#123;callbackParamList, callbackResult&#125;);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    logger.info(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job callback fail, callbackParamList:&#123;&#125;, callbackResult:&#123;&#125;&quot;</span>, <span class="keyword">new</span> Object[]&#123;callbackParamList, callbackResult&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                logger.error(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job callback error, callbackParamListï¼š&#123;&#125;&quot;</span>, callbackParamList, e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>æ€»ç»“ä¸€ä¸‹ï¼Œä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼ˆrunè¯·æ±‚ï¼‰ä»è°ƒåº¦ä¸­å¿ƒå‡ºå‘åˆ°æ‰§è¡Œå®Œæ¯•çš„é“¾è·¯ä¸ºï¼š<br><code>JettyServer</code>-&gt;<br>    <code>JettyServerHandler</code>-&gt;<br>        <code>NetComServerFactory#invokeService</code>-&gt;<br>            <code>ExecutorBizImpl#run</code>-&gt;<br>                    <code>JobThread</code>-&gt;<br>                        <code>TriggerCallbackThread</code>-&gt;<br>                            <code>AdminBiz#callback</code></p><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;xxl-jobæºç é˜…è¯»ç¬¬ä¸€ç« ï¼šå®šæ—¶ä»»åŠ¡æ‰§è¡Œé“¾è·¯åˆ†æ&lt;/p&gt;
&lt;p&gt;ä¸€æ—¶å…´èµ·ï¼ŒèŠ±ä¸€ä¸‹åˆçœ‹äº†ä¸€éè¿™éƒ¨åˆ†æºç ï¼Œå†™çš„ä¸é”™ã€‚&lt;/p&gt;
&lt;p&gt;PSï¼šå†™å®Œæ‰å‘ç°æœ‰å®˜æ–¹æ–‡æ¡£è®²è§£â€¦å°´å°¬ğŸ˜…&lt;br&gt;</summary>
    
    
    
    
    <category term="Java" scheme="http://silencezheng.top/tags/Java/"/>
    
    <category term="æºç é˜…è¯»" scheme="http://silencezheng.top/tags/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
    <category term="xxl-job" scheme="http://silencezheng.top/tags/xxl-job/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeå‘¨è®° EP3</title>
    <link href="http://silencezheng.top/2024/08/18/article134/"/>
    <id>http://silencezheng.top/2024/08/18/article134/</id>
    <published>2024-08-18T15:32:17.000Z</published>
    <updated>2024-10-27T15:29:05.977Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™å‘¨åŒå‘¨èµ›å’Œå‘¨èµ›éƒ½æ²¡æ‰“ï¼Œä¹‹å‰ä¸¤å‘¨ç§¯ç´¯çš„é—®é¢˜æœ‰äº›å¤šäº†ï¼Œå…ˆåªå¤„ç†æ¯æ—¥ä¸€é¢˜å§ã€‚</p><p>æœ¬å‘¨ä¸»é¢˜ï¼šåŠ¨æ€è§„åˆ’ã€è´ªå¿ƒ</p><p>é¢˜ç›®ï¼š</p><ul><li>240619æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/maximum-strictly-increasing-cells-in-a-matrix/description">Maximum Strictly Increasing Cells in a Matrix</a></li><li>240622æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/lexicographically-smallest-beautiful-string/">Lexicographically Smallest Beautiful String</a><span id="more"></span>è¿™ä¸¤é“Hardé¢˜ç¨å¾®çœ‹çœ‹ç†è§£ä¸€ä¸‹å°±è¡Œäº†ï¼Œæš‚æ—¶æ²¡å¤ªå¤šå¯å½’çº³çš„ï¼Œå¯è®°å¿†çš„ç‚¹å°±æ˜¯äºŒç»´æ’åºå’Œå›æ–‡åˆ¤åˆ«ï¼ˆåªè¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä»»ä½•å­—ç¬¦ï¼Œéƒ½ä¸ä¸å®ƒå‰ä¸¤ä¸ªå­—ç¬¦ç›¸åŒï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å°±ä¸åŒ…å«ä»»ä½•é•¿åº¦ä¸º 2 æˆ–è€…æ›´é•¿çš„å›æ–‡å­—ç¬¦ä¸²ï¼‰ã€‚</li></ul><h1 id="åŠ¨æ€è§„åˆ’-â€”-Maximum-Strictly-Increasing-Cells-in-a-Matrix"><a href="#åŠ¨æ€è§„åˆ’-â€”-Maximum-Strictly-Increasing-Cells-in-a-Matrix" class="headerlink" title="åŠ¨æ€è§„åˆ’ â€” Maximum Strictly Increasing Cells in a Matrix"></a>åŠ¨æ€è§„åˆ’ â€” Maximum Strictly Increasing Cells in a Matrix</h1><blockquote><p>Maximum Strictly Increasing Cells in a Matrix</p><p>Given a 1-indexed m x n integer matrix mat, you can select any cell in the matrix as your starting cell.</p><p>From the starting cell, you can move to any other cell in the same row or column, but only if the value of the destination cell is strictly greater than the value of the current cell. You can repeat this process as many times as possible, moving from cell to cell until you can no longer make any moves.</p><p>Your task is to find the maximum number of cells that you can visit in the matrix by starting from some cell.</p><p>Return an integer denoting the maximum number of cells that can be visited.</p></blockquote><p>è®¾ <strong>$d[i][j]$ ä¸ºç§»åŠ¨åˆ°å•å…ƒæ ¼ $(i, j)$ çš„æœ€å¤§æ­¥æ•°</strong>, å…¶ä¸­ $(i, j)$ å¯ä»¥ä½œä¸ºèµ·å§‹å•å…ƒæ ¼, ä¹Ÿå¯ä»¥æ˜¯ä»å…¶ä»–å•å…ƒæ ¼ç§»åŠ¨è€Œæ¥ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¼šè€ƒè™‘ä»ç¬¬ $i$ è¡Œä»¥åŠç¬¬ $j$ åˆ—ä¸ŠçŸ©é˜µæ•°å€¼å°äº $\operatorname{mat}[i][j]$ çš„ä½ç½®è¿›è¡Œè½¬ç§», å³å–ä»¥ä¸‹æ•°å€¼ä¸­çš„æœ€å¤§å€¼:</p><ul><li>ç¬¬ $i$ è¡Œï¼š $\max \left(d[i]\left[j^{\prime}\right]+1\right)$ ï¼Œå…¶ä¸­ $\operatorname{mat}[i]\left[j^{\prime}\right]&lt;\operatorname{mat}[i][j]$ ï¼›</li><li>ç¬¬ $j$ åˆ—ï¼š $\max \left(d\left[l^{\prime}\right][j]+1\right)$ ï¼Œå…¶ä¸­ $\operatorname{mat}\left[i^{\prime}\right][j]&lt;\operatorname{mat}[[][j]$ ã€‚</li></ul><p>å› æ­¤, æ•´ä¸ªçŠ¶æ€ç©ºé—´åœ¨è¿›è¡Œè½¬ç§»æ—¶æ˜¯æœ‰åºçš„, æˆ‘ä»¬å¯ä»¥å¯¹ mat è¿›è¡Œæ’åº, ä»å°åˆ°å¤§è¿›è¡Œè½¬ç§»ã€‚ä½†åœ¨è½¬ç§»æ—¶, æ¯ä¸ªçŠ¶æ€éƒ½è¦æ‰«æä¸€éå¯¹åº”çš„è¡Œå’Œåˆ—, æ—¶é—´å¤æ‚åº¦ä¸º $O(n+m)$, è€Œæ•´ä½“æ±‚è§£çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n m(n+m))$, å¯èƒ½ä¼šè¶…æ—¶, å› æ­¤éœ€è¦è¿›è¡Œä¼˜åŒ–ã€‚</p><p>è€ƒè™‘åˆ°æ‰€æœ‰çš„ $d[i][j]$ åœ¨æ›´æ–°æ—¶, å€¼åªä¼šè¶Šæ¥è¶Šå¤§, è€Œè½¬ç§»è¿‡ç¨‹ä¸­æˆ‘ä»¬åªè€ƒè™‘å¯¹åº”è¡Œå’Œå¯¹åº”åˆ—ä¸Š $d$ çš„æœ€å¤§å€¼ï¼ˆç”±äºå¤§äº mat $[i][j]$ çš„ä½ç½®è¿˜æœ«éå†åˆ°, å®ƒä»¬çš„çŠ¶æ€è¿˜æœ«æ›´æ–°, å¯è®¾ç½®ä¸º 0 )ã€‚å› æ­¤, è®¾ç½®é•¿åº¦ä¸º $m$ çš„æ•°ç»„ row æ¥ç»´æŠ¤æ¯ä¸€è¡Œ $d$ çš„æœ€å¤§å€¼, è®¾ç½®é•¿åº¦ä¸º $n$ çš„æ•°ç»„ $c o l$ æ¥ç»´æŠ¤æ¯ä¸€åˆ—çš„æœ€å¤§å€¼ï¼Œè¿™æ ·ä¸€æ¥:</p><script type="math/tex; mode=display">d[i][j]=\max (\operatorname{row}[i], \operatorname{col}[j])+1</script><p>åœ¨æ¯æ¬¡æ›´æ–°äº† $d[i][j]$ å, éœ€è¦æ›´æ–° $r o w[i]$ å’Œ $col[j]$ ã€‚å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯, ç”±äº mat ä¸­å¯èƒ½åŒ…å«ç›¸åŒæ•°å­—, æˆ‘ä»¬éœ€è¦åŒæ—¶æ›´æ–°å®ƒä»¬çš„ $d$ å€¼, ç„¶åå†åŒæ—¶æ›´æ–°å®ƒä»¬å¯¹åº”çš„ row å’Œ colã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxIncreasingCells</span><span class="params">(<span class="keyword">int</span>[][] mat)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m = mat.length, n = mat[<span class="number">0</span>].length;</span><br><span class="line">        Map&lt;Integer, List&lt;<span class="keyword">int</span>[]&gt;&gt; mp = <span class="keyword">new</span> HashMap&lt;Integer, List&lt;<span class="keyword">int</span>[]&gt;&gt;();</span><br><span class="line">        <span class="keyword">int</span>[] row = <span class="keyword">new</span> <span class="keyword">int</span>[m];</span><br><span class="line">        <span class="keyword">int</span>[] col = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                mp.putIfAbsent(mat[i][j], <span class="keyword">new</span> ArrayList&lt;<span class="keyword">int</span>[]&gt;());</span><br><span class="line">                mp.get(mat[i][j]).add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i, j&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;Integer&gt; keys = <span class="keyword">new</span> ArrayList&lt;Integer&gt;(mp.keySet());</span><br><span class="line">        Collections.sort(keys);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> key : keys) &#123;</span><br><span class="line">            List&lt;<span class="keyword">int</span>[]&gt; pos = mp.get(key);</span><br><span class="line">            List&lt;Integer&gt; res = <span class="keyword">new</span> ArrayList&lt;Integer&gt;(); <span class="comment">// å­˜æ”¾ç›¸åŒæ•°å€¼çš„ç­”æ¡ˆï¼Œä¾¿äºåç»­æ›´æ–° row å’Œ col</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span>[] arr : pos) &#123;</span><br><span class="line">                res.add(Math.max(row[arr[<span class="number">0</span>]], col[arr[<span class="number">1</span>]]) + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; pos.size(); i++) &#123;</span><br><span class="line">                <span class="keyword">int</span>[] arr = pos.get(i);</span><br><span class="line">                <span class="keyword">int</span> d = res.get(i);</span><br><span class="line">                row[arr[<span class="number">0</span>]] = Math.max(row[arr[<span class="number">0</span>]], d);</span><br><span class="line">                col[arr[<span class="number">1</span>]] = Math.max(col[arr[<span class="number">1</span>]], d);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Arrays.stream(row).max().getAsInt();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="è´ªå¿ƒ-â€”-Lexicographically-Smallest-Beautiful-String"><a href="#è´ªå¿ƒ-â€”-Lexicographically-Smallest-Beautiful-String" class="headerlink" title="è´ªå¿ƒ â€” Lexicographically Smallest Beautiful String"></a>è´ªå¿ƒ â€” Lexicographically Smallest Beautiful String</h1><blockquote><p>Lexicographically Smallest Beautiful String</p><p>A string is beautiful if:</p><ul><li>It consists of the first k letters of the English lowercase alphabet.</li><li>It does not contain any substring of length 2 or more which is a palindrome.</li></ul><p>You are given a beautiful string s of length n and a positive integer k.</p><p>Return the lexicographically smallest string of length n, which is larger than s and is beautiful. If there is no such string, return an empty string.</p><p>A string a is lexicographically larger than a string b (of the same length) if in the first position where a and b differ, a has a character strictly larger than the corresponding character in b.</p><ul><li>For example, â€œabcdâ€ is lexicographically larger than â€œabccâ€ because the first position they differ is at the fourth character, and d is greater than c.</li></ul></blockquote><p>é¦–å…ˆåˆ†æä¸€ä¸‹ç¾ä¸½å­—ç¬¦ä¸²çš„ç¬¬äºŒä¸ªæ¡ä»¶ï¼šä¸åŒ…å«ä»»ä½•é•¿åº¦ä¸º 2 æˆ–è€…æ›´é•¿çš„å›æ–‡å­—ç¬¦ä¸²ã€‚é•¿åº¦ä¸º 2 çš„å›æ–‡å­—ç¬¦ä¸²æ˜¯ä¸¤ä¸ªç›¸åŒå­—ç¬¦æ„æˆçš„å­—ç¬¦ä¸²ã€‚é•¿åº¦ä¸º 3 çš„å›æ–‡å­—ç¬¦ä¸²ä¸­ä¹Ÿæœ‰ä¸¤ä¸ªç›¸åŒå­—ç¬¦ï¼Œä½†ä¸‹æ ‡ä¹‹å·®ä¸º 2ã€‚è€Œä»»ä½•é•¿åº¦ä¸º 2 æˆ–è€…æ›´é•¿çš„å›æ–‡å­—ç¬¦ä¸²ï¼Œéƒ½åŒ…å«ä¸€ä¸ªé•¿åº¦ä¸º 2 æˆ–è€… 3 çš„å›æ–‡å­—ç¬¦ä¸²ã€‚å› æ­¤ï¼Œ<strong>åªè¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä»»ä½•å­—ç¬¦ï¼Œéƒ½ä¸ä¸å®ƒå‰ä¸¤ä¸ªå­—ç¬¦ç›¸åŒï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å°±ä¸åŒ…å«ä»»ä½•é•¿åº¦ä¸º 2 æˆ–è€…æ›´é•¿çš„å›æ–‡å­—ç¬¦ä¸²</strong>ã€‚</p><p>æ¥ä¸‹æ¥çœ‹å…¶ä»–è¦æ±‚ï¼Œè¿”å›çš„ç¾ä¸½å­—ç¬¦ä¸²éœ€è¦å­—å…¸åºå¤§äº s å¹¶ä¸”å­—å…¸åºæœ€å°ã€‚è´ªå¿ƒçš„æ€è·¯æ˜¯ä¿®æ”¹ s çš„æœ«å°¾å­—ç¬¦ï¼Œä¸€ç‚¹ç‚¹å°†å­—ç¬¦å˜å¤§ï¼Œå¦‚æœåœ¨å˜å¤§çš„åŒæ—¶èƒ½å¤Ÿæ»¡è¶³ç¾ä¸½å­—ç¬¦ä¸²çš„ä¸¤ä¸ªæ¡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ‰¾åˆ°äº†è¦æ±‚çš„ç¾ä¸½å­—ç¬¦ä¸²ã€‚ä¿®æ”¹åçš„å­—ç¬¦ä¸èƒ½ä¸å‰ä¸¤ä¸ªå­—ç¬¦ç›¸åŒï¼Œå› æ­¤æˆ‘ä»¬åœ¨å°†å­—ç¬¦å˜å¤§çš„æ—¶å€™åªéœ€è¦å°†å­—ç¬¦é€æ­¥å˜å¤§ä¸‰æ¬¡ï¼Œå°±èƒ½åˆ¤æ–­å‡ºä¿®æ”¹å½“å‰å­—ç¬¦èƒ½å¦æ»¡è¶³ç¾ä¸½å­—ç¬¦ä¸²çš„æ¡ä»¶ã€‚å¦‚æœä¿®æ”¹æœ«å°¾å­—ç¬¦è¾¾ä¸åˆ°ç¾ä¸½å­—ç¬¦ä¸²çš„æ¡ä»¶ï¼Œåˆ™æˆ‘ä»¬éœ€è¦å°†è¢«ä¿®æ”¹çš„å­—ç¬¦æ”¹ä¸ºå€’æ•°ç¬¬äºŒä¸ªå­—ç¬¦ï¼Œä»ç„¶æŒ‰ç…§ä¹‹å‰çš„æ€è·¯ä¸€ç‚¹ç‚¹å¢å¤§ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦æ»¡è¶³ç¾ä¸½å­—ç¬¦ä¸²çš„ä¸¤ä¸ªæ¡ä»¶ã€‚æˆ‘ä»¬ä»æœ«å°¾å­—ç¬¦å¼€å§‹ï¼Œå¾€å‰ä¸€ç‚¹ç‚¹åˆ¤æ–­æ˜¯å¦å¯ä»¥ä¿®æ”¹å½“å‰å­—ç¬¦æ¥æ‰¾åˆ°ç›®æ ‡ç¾ä¸½å­—ç¬¦ä¸²ã€‚ä¸€æ—¦æˆ‘ä»¬ç¬¬ä¸€æ¬¡æ‰¾åˆ°äº†åˆé€‚çš„ä¸‹æ ‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¥ä¿®æ”¹å­—ç¬¦æ¥è¾¾åˆ°ç›®æ ‡æ¡ä»¶ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¿®æ”¹å¯»æ‰¾åˆ°çš„ä¸‹æ ‡çš„å­—ç¬¦ï¼Œå°†å…¶ä¿®æ”¹ä¸ºæœ€å°çš„æ»¡è¶³ç¾ä¸½å­—ç¬¦ä¸²æ¡ä»¶çš„å­—ç¬¦ã€‚æ¥ä¸‹æ¥éœ€è¦ä¿®æ”¹å®ƒå³è¾¹çš„å­—ç¬¦ã€‚å› ä¸ºä¹‹å‰ä¿®æ”¹çš„å­—ç¬¦å·²ç»èƒ½ä¿è¯è¿”å›çš„å­—ç¬¦ä¸²åœ¨å­—å…¸åºä¸Šå¤§äº sï¼Œæˆ‘ä»¬åªéœ€è¦å°†åç»­çš„å­—ç¬¦ä¿®æ”¹å¾—å°½å¯èƒ½å°å³å¯ï¼Œå› ä¸ºæ¯ä¸ªå­—ç¬¦éœ€è¦ä¸å‰ä¸¤ä¸ªå­—ç¬¦ä¸åŒï¼Œå› æ­¤æ¯ä¸ªå­—ç¬¦åªéœ€è¦éå† <code>â€˜aâ€™âˆ¼â€˜câ€™</code> å³å¯ã€‚å› ä¸º $kâ‰¥ 4$ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥ä¿®æ”¹çš„å­—ç¬¦ä¸€å®šéƒ½èƒ½æ»¡è¶³ç¾ä¸½å­—ç¬¦ä¸²çš„æ¡ä»¶ã€‚</p><p>åœ¨ä»£ç å®ç°ä¸Šï¼Œæˆ‘ä»¬å…ˆç”¨ä¸€ä¸ªå¾ªç¯ä» $nâˆ’1$ å¼€å§‹ï¼Œå¾€å‰éå†æ¥å¯»æ‰¾ç¬¬ä¸€ä¸ªè¢«ä¿®æ”¹çš„å­—ç¬¦ï¼Œæ‰¾åˆ°ä¹‹åï¼Œå†ç”¨å¦ä¸€ä¸ªå‡½æ•° $generate(s,idx,offset)$ æ¥ç”Ÿæˆä¿®æ”¹åçš„å­—ç¬¦ï¼Œå…¶ä¸­ $idx$ æ˜¯æˆ‘ä»¬æ‰¾åˆ°çš„ä¸‹æ ‡ï¼Œ$offset$ æ˜¯å°†è¿™ä¸ªä¸‹æ ‡çš„å­—ç¬¦å¢å¤§çš„åç§»é‡ã€‚æœ€åè¿”å›ä¿®æ”¹åçš„å­—ç¬¦ï¼Œå¦‚æœæˆ‘ä»¬æœªèƒ½æ‰¾åˆ°ç›®æ ‡ä¸‹æ ‡ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">smallestBeautifulString</span><span class="params">(String s, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = s.length() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            Set&lt;Character&gt; blockedCharacters = <span class="keyword">new</span> HashSet&lt;Character&gt;();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; <span class="number">3</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i - j &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    blockedCharacters.add(s.charAt(i - j));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">                <span class="comment">// s.charAt(i) - &#x27;a&#x27; + j éœ€è¦+1æ‰èƒ½ä¸kæ¯”è¾ƒï¼Œå› ä¸ºkä»1è®¡æ•°</span></span><br><span class="line">                <span class="keyword">if</span> (s.charAt(i) - <span class="string">&#x27;a&#x27;</span> + j + <span class="number">1</span> &lt;= k &amp;&amp; !blockedCharacters.contains((<span class="keyword">char</span>) (s.charAt(i) + j))) &#123;</span><br><span class="line">                    <span class="keyword">return</span> generate(s, i, j);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">generate</span><span class="params">(String s, <span class="keyword">int</span> idx, <span class="keyword">int</span> offset)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span>[] res = s.toCharArray();</span><br><span class="line">        res[idx] += offset;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = idx + <span class="number">1</span>; i &lt; s.length(); i++) &#123;</span><br><span class="line">            Set&lt;Character&gt; blockedCharacters = <span class="keyword">new</span> HashSet&lt;Character&gt;();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; <span class="number">3</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i - j &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    blockedCharacters.add(res[i - j]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++) &#123;</span><br><span class="line">                <span class="comment">// abcé‡Œé¢ä¸€å®šæœ‰ä¸€ä¸ªå¯ç”¨çš„ï¼Œå› ä¸ºblockedCharactersåªæœ‰ä¸¤ä¸ªå­—ç¬¦</span></span><br><span class="line">                <span class="keyword">if</span> (!blockedCharacters.contains((<span class="keyword">char</span>) (<span class="string">&#x27;a&#x27;</span> + j))) &#123;</span><br><span class="line">                    res[i] = (<span class="keyword">char</span>) (<span class="string">&#x27;a&#x27;</span> + j);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://leetcode.cn/problems/maximum-strictly-increasing-cells-in-a-matrix/solutions/2809597/ju-zhen-zhong-yan-ge-di-zeng-de-dan-yuan-ff4v/">https://leetcode.cn/problems/maximum-strictly-increasing-cells-in-a-matrix/solutions/2809597/ju-zhen-zhong-yan-ge-di-zeng-de-dan-yuan-ff4v/</a><br>[2] <a href="https://leetcode.cn/problems/lexicographically-smallest-beautiful-string/solutions/2814311/zi-dian-xu-zui-xiao-de-mei-li-zi-fu-chua-dr81/">https://leetcode.cn/problems/lexicographically-smallest-beautiful-string/solutions/2814311/zi-dian-xu-zui-xiao-de-mei-li-zi-fu-chua-dr81/</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è¿™å‘¨åŒå‘¨èµ›å’Œå‘¨èµ›éƒ½æ²¡æ‰“ï¼Œä¹‹å‰ä¸¤å‘¨ç§¯ç´¯çš„é—®é¢˜æœ‰äº›å¤šäº†ï¼Œå…ˆåªå¤„ç†æ¯æ—¥ä¸€é¢˜å§ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨ä¸»é¢˜ï¼šåŠ¨æ€è§„åˆ’ã€è´ªå¿ƒ&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;240619æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/maximum-strictly-increasing-cells-in-a-matrix/description&quot;&gt;Maximum Strictly Increasing Cells in a Matrix&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240622æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/lexicographically-smallest-beautiful-string/&quot;&gt;Lexicographically Smallest Beautiful String&lt;/a&gt;</summary>
    
    
    
    
    <category term="LeetCode" scheme="http://silencezheng.top/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeå‘¨è®° EP2</title>
    <link href="http://silencezheng.top/2024/08/18/article133/"/>
    <id>http://silencezheng.top/2024/08/18/article133/</id>
    <published>2024-08-18T10:44:02.000Z</published>
    <updated>2024-10-27T15:29:08.696Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™å‘¨å‘¨èµ›èœäº†â€¦èµ¶ç´§è®°ä¸€ä¸‹ã€‚</p><p>æœ¬å‘¨ä¸»é¢˜ï¼šå·®åˆ†æ•°ç»„ã€åŠ¨æ€è§„åˆ’</p><p>é¢˜ç›®ï¼š</p><ul><li>240615æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/maximum-beauty-of-an-array-after-applying-operation/description/">Maximum Beauty of an Array After Applying Operation</a></li><li>240616å‘¨èµ›ç¬¬ä¸‰é¢˜â€”<a href="https://leetcode.cn/problems/maximum-total-damage-with-spell-casting/description/">Maximum Total Damage With Spell Casting</a></li><li>LC198æ‰“å®¶åŠ«èˆâ€”<a href="https://leetcode.cn/problems/house-robber/description/">House Robber</a><span id="more"></span></li></ul><h1 id="å·®åˆ†æ•°ç»„ï¼ˆDifference-Arrayï¼‰"><a href="#å·®åˆ†æ•°ç»„ï¼ˆDifference-Arrayï¼‰" class="headerlink" title="å·®åˆ†æ•°ç»„ï¼ˆDifference Arrayï¼‰"></a>å·®åˆ†æ•°ç»„ï¼ˆDifference Arrayï¼‰</h1><p>ä½œç”¨ï¼šå¼€è¾Ÿä¸€å—ç©ºé—´ç”¨äºå‹ç¼©å¯¹åŸæ•°ç»„ä¸Šè¿ç»­å­æ•°ç»„çš„æ“ä½œã€‚</p><h2 id="å¼•å‡º"><a href="#å¼•å‡º" class="headerlink" title="å¼•å‡º"></a>å¼•å‡º</h2><p>è€ƒè™‘æ•°ç»„ $a=[1,3,3,5,8]$ï¼Œå¯¹å…¶ä¸­çš„ç›¸é‚»å…ƒç´ ä¸¤ä¸¤ä½œå·®ï¼ˆå³è¾¹å‡å·¦è¾¹ï¼‰ï¼Œå¾—åˆ°æ•°ç»„ $[2,0,2,3]$ã€‚ç„¶ååœ¨å¼€å¤´è¡¥ä¸Š $a[0]$ï¼Œå¾—åˆ°å·®åˆ†æ•°ç»„ï¼š$d=[1,2,0,2,3]$</p><p>è¿™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿå¦‚æœä»å·¦åˆ°å³ç´¯åŠ  ddd ä¸­çš„å…ƒç´ ï¼Œæˆ‘ä»¬å°±ã€Œè¿˜åŸã€å›äº† $a$ æ•°ç»„ $[1,3,3,5,8]$ã€‚è¿™ç±»ä¼¼æ±‚å¯¼ä¸ç§¯åˆ†çš„æ¦‚å¿µã€‚</p><p>è¿™åˆæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿç°åœ¨æŠŠè¿ç»­å­æ•°ç»„ $a[1],a[2],a[3]$ éƒ½åŠ ä¸Š $10$ï¼Œå¾—åˆ° $aâ€™=[1,13,13,15,8]$ã€‚å†æ¬¡ä¸¤ä¸¤ä½œå·®ï¼Œå¹¶åœ¨å¼€å¤´è¡¥ä¸Š $aâ€™[0]$ï¼Œå¾—åˆ°å·®åˆ†æ•°ç»„ï¼š$dâ€™=[1,12,0,2,âˆ’7]$</p><p>å¯¹æ¯” $d$ å’Œ $dâ€™$ï¼Œå¯ä»¥å‘ç°åªæœ‰ $d[1]$ å’Œ $d[4]$ å˜åŒ–äº†ï¼Œè¿™æ„å‘³ç€<strong>å¯¹ $a$ ä¸­è¿ç»­å­æ•°ç»„çš„æ“ä½œï¼Œå¯ä»¥è½¬å˜æˆå¯¹å·®åˆ†æ•°ç»„ $d$ ä¸­ä¸¤ä¸ªæ•°çš„æ“ä½œ</strong>ã€‚</p><h2 id="å®šä¹‰å’Œæ€§è´¨"><a href="#å®šä¹‰å’Œæ€§è´¨" class="headerlink" title="å®šä¹‰å’Œæ€§è´¨"></a>å®šä¹‰å’Œæ€§è´¨</h2><p>å¯¹äºæ•°ç»„ $a$ï¼Œå®šä¹‰å…¶å·®åˆ†æ•°ç»„ï¼ˆdifference arrayï¼‰ä¸º</p><script type="math/tex; mode=display">d[i] = \begin{cases} a[0],&i=0\\ a[i]-a[i-1],&i\ge 1 \end{cases}â€‹</script><p>æ€§è´¨ 1ï¼šä»å·¦åˆ°å³ç´¯åŠ  $d$ ä¸­çš„å…ƒç´ ï¼Œå¯ä»¥å¾—åˆ°æ•°ç»„ $a$ã€‚</p><p>æ€§è´¨ 2ï¼šå¦‚ä¸‹ä¸¤ä¸ªæ“ä½œæ˜¯ç­‰ä»·çš„ã€‚</p><ul><li>æŠŠ $a$ çš„å­æ•°ç»„ $a[i],a[i+1],\cdots,a[j]$ éƒ½åŠ ä¸Š $x$ã€‚</li><li>æŠŠ $d[i]$ å¢åŠ  $x$ï¼ŒæŠŠ $d[j+1]$ å‡å°‘ $x$ã€‚</li></ul><p>åˆ©ç”¨æ€§è´¨ 2ï¼Œæˆ‘ä»¬åªéœ€è¦ $O(1)$ çš„æ—¶é—´å°±å¯ä»¥å®Œæˆå¯¹ $a$ çš„å­æ•°ç»„çš„æ“ä½œã€‚æœ€ååˆ©ç”¨æ€§è´¨ 1 ä»å·®åˆ†æ•°ç»„å¤åŸå‡ºæ•°ç»„ $a$ã€‚</p><p>æ³¨ï¼šä¹Ÿå¯ä»¥è¿™æ ·ç†è§£ï¼Œ$d[i]$ è¡¨ç¤ºæŠŠä¸‹æ ‡ $â‰¥i$ çš„æ•°éƒ½åŠ ä¸Š $d[i]$ã€‚</p><h2 id="ä¾‹é¢˜ï¼šMaximum-Beauty-of-an-Array-After-Applying-Operation"><a href="#ä¾‹é¢˜ï¼šMaximum-Beauty-of-an-Array-After-Applying-Operation" class="headerlink" title="ä¾‹é¢˜ï¼šMaximum Beauty of an Array After Applying Operation"></a>ä¾‹é¢˜ï¼šMaximum Beauty of an Array After Applying Operation</h2><blockquote><p><strong>Maximum Beauty of an Array After Applying Operation</strong></p><p>You are given a 0-indexed array nums and a non-negative integer k.</p><p>In one operation, you can do the following:</p><p>Choose an index i that hasnâ€™t been chosen before from the range [0, nums.length - 1].<br>Replace nums[i] with any integer from the range [nums[i] - k, nums[i] + k].<br>The beauty of the array is the length of the longest subsequence consisting of equal elements.</p><p>Return the maximum possible beauty of the array nums after applying the operation any number of times.</p><p>Note that you can apply the operation to each index only once.</p><p>A subsequence of an array is a new array generated from the original array by deleting some elements (possibly none) without changing the order of the remaining elements.</p><p>Constraints:</p><ul><li>1 &lt;= nums.length &lt;= 1e5</li><li>0 &lt;= nums[i], k &lt;= 1e5</li></ul></blockquote><p>è‡ªç„¶æƒ³åˆ°çš„æ€è·¯æ˜¯æŠŠæ¯ä¸ªå…ƒç´ çœ‹ä½œæ˜¯ä¸€ä¸ªå¯æ¢ç©ºé—´ï¼Œå°†æ‰€æœ‰å¯æ¢ç©ºé—´åœ¨ä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç©ºé—´ä¸­è¿›è¡Œå åŠ ï¼Œè¢«æœ€å¤šå¯æ¢ç©ºé—´è¦†ç›–åˆ°çš„åœ°æ–¹å³ä¸ºæ‰€æ±‚ç»“æœã€‚æˆ–è€…ï¼ŒæŠŠæ¯ä¸ªå…ƒç´ è€ƒè™‘ä¸ºå¯¹å…¶å¯¹åº”å¯æ¢ç©ºé—´ä¸­çš„æ¯ä¸€ä¸ªä½ç½®æŠ•ä¸€ç¥¨ï¼Œæœ€ç»ˆç¥¨æ•°æœ€å¤šçš„ä½ç½®ä¸ºæ‰€æ±‚ç»“æœã€‚</p><p>ä»æ•°æ®èŒƒå›´ä¸Šåˆ†æï¼ŒåŒºé—´å¤§å°åº”è¯¥ä¸º[-1e5, 2e5]ã€‚å°†åŒºé—´ä¸ºè´Ÿæ•°çš„éƒ¨åˆ†ç”¨<code>offset</code>æ¥è¡¨ç¤ºï¼Œåˆ™å¯ä»¥å†™å‡ºä»¥ä¸‹è§£æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maximumBeauty</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>, n = nums.length;</span><br><span class="line">        <span class="comment">// å¤šå¼€3ä¸ªç©ºé—´ï¼Œä¸ºäº†å­˜0ã€å­˜å·®åˆ†æ•°ç»„ä¸Šé™å’ŒåŒ¹é…ä¸‹æ ‡</span></span><br><span class="line">        <span class="keyword">int</span>[] diffArr = <span class="keyword">new</span> <span class="keyword">int</span>[(<span class="keyword">int</span>)<span class="number">3e5</span>+<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">int</span> ofst = (<span class="keyword">int</span>)<span class="number">1e5</span>+<span class="number">1</span>; <span class="comment">// diffArr[ofst]ä¸º0æ‰€åœ¨ä½ç½®</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> x:nums)&#123;</span><br><span class="line">            diffArr[x-k+ofst]++;</span><br><span class="line">            diffArr[x+k+ofst+<span class="number">1</span>]--;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;diffArr.length;i++)&#123;</span><br><span class="line">            diffArr[i] += diffArr[i-<span class="number">1</span>];</span><br><span class="line">            res = Math.max(res, diffArr[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ‰“å®¶åŠ«èˆ"><a href="#æ‰“å®¶åŠ«èˆ" class="headerlink" title="æ‰“å®¶åŠ«èˆ"></a>æ‰“å®¶åŠ«èˆ</h1><p>å‘¨èµ›ç¬¬ä¸‰é¢˜å±äºå€¼åŸŸä¸Šçš„æ‰“å®¶åŠ«èˆï¼Œå› æ­¤å…ˆæ¥äº†è§£ä¸€ä¸‹æ‰“å®¶åŠ«èˆç±»å‹é¢˜ç›®ï¼Œå…¶ç‰¹ç‚¹æ˜¯<strong>å¯¹æŸä¸€å…ƒç´ çš„é€‰æ‹©ä¼šå¯¹å…¶ç›¸é‚»åŒºåŸŸé€ æˆå½±å“</strong>ã€‚æ­¤ç±»é—®é¢˜é€šå¸¸å¯ä»¥é€šè¿‡åŠ¨æ€è§„åˆ’æ±‚è§£ã€‚</p><blockquote><p>House Robber</p><p>You are a professional robber planning to rob houses along a street. Each house has a certain amount of money stashed, the only constraint stopping you from robbing each of them is that adjacent houses have security systems connected and it will automatically contact the police if two adjacent houses were broken into on the same night.</p><p>Given an integer array nums representing the amount of money of each house, return the maximum amount of money you can rob tonight without alerting the police.</p></blockquote><p>é¦–å…ˆè€ƒè™‘æœ€ç®€å•çš„æƒ…å†µã€‚å¦‚æœåªæœ‰ä¸€é—´æˆ¿å±‹ï¼Œåˆ™å·çªƒè¯¥æˆ¿å±‹ï¼Œå¯ä»¥å·çªƒåˆ°æœ€é«˜æ€»é‡‘é¢ã€‚å¦‚æœåªæœ‰ä¸¤é—´æˆ¿å±‹ï¼Œåˆ™ç”±äºä¸¤é—´æˆ¿å±‹ç›¸é‚»ï¼Œä¸èƒ½åŒæ—¶å·çªƒï¼Œåªèƒ½å·çªƒå…¶ä¸­çš„ä¸€é—´æˆ¿å±‹ï¼Œå› æ­¤é€‰æ‹©å…¶ä¸­é‡‘é¢è¾ƒé«˜çš„æˆ¿å±‹è¿›è¡Œå·çªƒï¼Œå¯ä»¥å·çªƒåˆ°æœ€é«˜æ€»é‡‘é¢ã€‚</p><p>å¦‚æœæˆ¿å±‹æ•°é‡å¤§äºä¸¤é—´ï¼Œåº”è¯¥å¦‚ä½•è®¡ç®—èƒ½å¤Ÿå·çªƒåˆ°çš„æœ€é«˜æ€»é‡‘é¢å‘¢ï¼Ÿå¯¹äºç¬¬ $k(k&gt;2)$ é—´æˆ¿å±‹ï¼Œæœ‰ä¸¤ä¸ªé€‰é¡¹:</p><ol><li>å·çªƒç¬¬ $k$ é—´æˆ¿å±‹ï¼Œé‚£ä¹ˆå°±ä¸èƒ½å·çªƒç¬¬ $k-1$ é—´æˆ¿å±‹ï¼Œå·çªƒæ€»é‡‘é¢ä¸ºå‰ $k-2$ é—´æˆ¿å±‹çš„æœ€é«˜æ€»é‡‘é¢ä¸ç¬¬ $k$ é—´æˆ¿å±‹çš„é‡‘é¢ä¹‹å’Œã€‚</li><li>ä¸å·çªƒç¬¬ $k$ é—´æˆ¿å±‹ï¼Œå·çªƒæ€»é‡‘é¢ä¸ºå‰ $k-1$ é—´æˆ¿å±‹çš„æœ€é«˜æ€»é‡‘é¢ã€‚</li></ol><p>åœ¨ä¸¤ä¸ªé€‰é¡¹ä¸­é€‰æ‹©å·çªƒæ€»é‡‘é¢è¾ƒå¤§çš„é€‰é¡¹ï¼Œè¯¥é€‰é¡¹å¯¹åº”çš„å·çªƒæ€»é‡‘é¢å³ä¸ºå‰ $k$ é—´æˆ¿å±‹èƒ½å·çªƒåˆ°çš„æœ€é«˜æ€»é‡‘é¢ã€‚</p><p>ç”¨ $d p[i]$ è¡¨ç¤ºå‰ $i$ é—´æˆ¿å±‹èƒ½å·çªƒåˆ°çš„æœ€é«˜æ€»é‡‘é¢ï¼Œé‚£ä¹ˆå°±æœ‰å¦‚ä¸‹çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">d p[i]=\max (d p[i-2]+\operatorname{nums}[i], d p[i-1])</script><p>è¾¹ç•Œæ¡ä»¶ä¸ºï¼š</p><script type="math/tex; mode=display">\begin{cases}d p[0]=\operatorname{nums}[0] & \text { åªæœ‰ä¸€é—´æˆ¿å±‹ï¼Œåˆ™å·çªƒè¯¥æˆ¿å±‹ } \\ d p[1]=\max (n u m s[0], n u m s[1]) & \text { åªæœ‰ä¸¤é—´æˆ¿å±‹ï¼Œé€‰æ‹©å…¶ä¸­é‡‘é¢è¾ƒé«˜çš„æˆ¿å±‹è¿›è¡Œå·çªƒ }\end{cases}</script><p>æœ€ç»ˆçš„ç­”æ¡ˆå³ä¸º $d p[n-1]$, å…¶ä¸­ $n$ æ˜¯æ•°ç»„çš„é•¿åº¦ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">rob</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> length = nums.length;</span><br><span class="line">        <span class="keyword">if</span> (length == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> nums[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span>[] dp = <span class="keyword">new</span> <span class="keyword">int</span>[length];</span><br><span class="line">        dp[<span class="number">0</span>] = nums[<span class="number">0</span>];</span><br><span class="line">        dp[<span class="number">1</span>] = Math.max(nums[<span class="number">0</span>], nums[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; length; i++) &#123;</span><br><span class="line">            dp[i] = Math.max(dp[i - <span class="number">2</span>] + nums[i], dp[i - <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[length - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æ»šåŠ¨æ•°ç»„ä¼˜åŒ–ç©ºé—´ä½¿ç”¨ã€‚ä¸Šè¿°æ–¹æ³•ä½¿ç”¨äº†æ•°ç»„å­˜å‚¨ç»“æœï¼Œè€ƒè™‘åˆ°æ¯é—´æˆ¿å±‹çš„æœ€é«˜æ€»é‡‘é¢åªå’Œè¯¥æˆ¿å±‹çš„å‰ä¸¤é—´æˆ¿å±‹çš„æœ€é«˜æ€»é‡‘é¢ç›¸å…³ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æ»šåŠ¨æ•°ç»„ï¼Œåœ¨æ¯ä¸ªæ—¶åˆ»åªéœ€è¦å­˜å‚¨å‰ä¸¤é—´æˆ¿å±‹çš„æœ€é«˜æ€»é‡‘é¢ã€‚å¾—åˆ°ä¼˜åŒ–è§£æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">rob</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> length = nums.length;</span><br><span class="line">        <span class="keyword">if</span> (length == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> nums[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> first = nums[<span class="number">0</span>], second = Math.max(nums[<span class="number">0</span>], nums[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; length; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> temp = second;</span><br><span class="line">            second = Math.max(first + nums[i], second);</span><br><span class="line">            first = temp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> second;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¾‹é¢˜ï¼šMaximum-Total-Damage-With-Spell-Casting"><a href="#ä¾‹é¢˜ï¼šMaximum-Total-Damage-With-Spell-Casting" class="headerlink" title="ä¾‹é¢˜ï¼šMaximum Total Damage With Spell Casting"></a>ä¾‹é¢˜ï¼šMaximum Total Damage With Spell Casting</h2><blockquote><p>Maximum Total Damage With Spell Casting</p><p>A magician has various spells.</p><p>You are given an array power, where each element represents the damage of a spell. Multiple spells can have the same damage value.</p><p>It is a known fact that if a magician decides to cast a spell with a damage of power[i], they cannot cast any spell with a damage of power[i] - 2, power[i] - 1, power[i] + 1, or power[i] + 2.</p><p>Each spell can be cast only once.</p><p>Return the maximum possible total damage that a magician can cast.</p></blockquote><p>è¿™é“é¢˜ä¸æ˜¯ä»ç©ºé—´ä¸Šé™åˆ¶é€‰å–ï¼Œè€Œæ˜¯ä»å€¼åŸŸä¸Šé™åˆ¶ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è€ƒè™‘å¯¹åŸæ•°ç»„è¿›è¡Œæ’åºï¼Œä½¿å…ƒç´ é€‰å–ä¸ç©ºåŸŸäº§ç”Ÿä¸€å®šç›¸å…³æ€§ï¼Œæ–¹ä¾¿çŠ¶æ€è®°å½•ã€‚æ’åºåï¼Œè€ƒè™‘èšåˆç›¸ç­‰å€¼çš„å…ƒç´ ï¼Œæ¯ä¸€æ­¥é€‰å–å®é™…ä¸Šéƒ½æ˜¯é€‰å–äº†ä¸€ç»„å…ƒç´ ã€‚</p><p>ç”¨$nums$è¡¨ç¤ºèšåˆåçš„æ’åºæ•°ç»„ï¼Œ$total(nums[k])$è¡¨ç¤ºå…ƒç´ $nums[k]$çš„å€¼æ€»å’Œï¼Œç”¨ $dp[i]$ è¡¨ç¤ºå‰ $i$ ä¸ªå…ƒç´ èƒ½é€ æˆçš„æœ€é«˜æ€»ä¼¤å®³ï¼Œé‚£ä¹ˆå¯¹äº$nums[k]$é€‰æˆ–ä¸é€‰ï¼š</p><ul><li>ä¸é€‰ï¼Œ$dp[i] = dp[i-1]$;</li><li>é€‰ï¼Œåˆ™å€¼åœ¨$[nums[k]-2, nums[k]-1]$çš„å…ƒç´ ä¸èƒ½é€‰ï¼Œä»¤$j$ä¸ºæœ€å°æ»¡è¶³$nums[j]&gt;=nums[k]-2$çš„å…ƒç´ ï¼Œåˆ™$dp[i] = dp[j-1] + total(nums[k])$ã€‚</li></ul><p>å¯¹ä¸¤ç§æƒ…å†µå–æœ€å¤§å€¼ï¼Œæœ‰å¦‚ä¸‹çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">dp[i] = max(dp[i-1], dp[j-1] + total(nums[i]))</script><p>å‡è®¾ä¸€ç§æœ€åçš„æƒ…å†µï¼Œ$nums$ä¸­æ‰€æœ‰çš„å…ƒç´ éƒ½æ˜¯è¿ç»­çš„ï¼Œé‚£ä¹ˆåœ¨é‡åˆ°å…ƒç´ $nums[i]$æ—¶ï¼Œæˆ‘ä»¬è‡³å°‘è¦ä¿å­˜ä¸‰ä¸ªçŠ¶æ€æ‰èƒ½å¤Ÿå®ŒæˆçŠ¶æ€è½¬ç§»ï¼Œå³$dp[i-1], dp[i-2], dp[i-3]$ï¼Œæ­¤æ—¶ä»–ä»¬çš„æœ«å°¾å€¼åˆ†åˆ«å¯¹åº”$nums[i]-1,nums[i]-2,nums[i]-3$ï¼Œåˆ™$j = i-2$ï¼ŒçŠ¶æ€å¯èƒ½ä»$dp[i-3]$è½¬ç§»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ$dp[j-1]$çš„å–å€¼èŒƒå›´æ˜¯$dp[i-1], dp[i-2], dp[i-3]$ã€‚</p><p>è¾¹ç•Œæ¡ä»¶ä¸ºï¼š</p><script type="math/tex; mode=display">\begin{cases}d p[0]=total(\operatorname{nums}[0]) \\ d p[1]=\begin{cases} \max (total(\operatorname{nums}[0]), total(\operatorname{nums}[1])),&nums[0]-2<=nums[1]<nums[0] \\ dp[0]+total(\operatorname{nums}[1]), &nums[0]<nums[1]-2 \end{cases}\end{cases}</script><p>æ­¤æ—¶å‘ç°é—®é¢˜ï¼šé¢å¯¹ä¸‹æ ‡ä¸º$2$çš„å…ƒç´ ï¼Œå¹¶ä¸å­˜åœ¨çŠ¶æ€$dp[-1]$ä¾›å…¶è½¬ç§»ï¼ˆ$dp[j-1]$çš„ä¸‹ç•Œï¼‰ã€‚äºæ˜¯å¦‚æœä»$nums[2]$å¼€å§‹éå†åˆ™åº”è¯¥æ·»åŠ æ­¤çŠ¶æ€ï¼ˆç½®0ï¼‰ï¼Œæˆ–ä»$nums[3]$å¼€å§‹éå†ã€‚</p><p>æ³¨æ„åˆ°å½“å‰çŠ¶æ€ä»…ä¸å‰ä¸‰ä¸ªçŠ¶æ€æœ‰å…³ï¼Œåˆ™å¯ä»¥ç”¨é•¿åº¦ä¸º$3$çš„æ»šåŠ¨æ•°ç»„è¿›è¡Œä¼˜åŒ–ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">maximumTotalDamage</span><span class="params">(<span class="keyword">int</span>[] power)</span> </span>&#123;</span><br><span class="line">        Map&lt;Integer, Long&gt; map = <span class="keyword">new</span> TreeMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x : power) &#123;</span><br><span class="line">            map.merge(x, (<span class="keyword">long</span>) x, Long::sum);</span><br><span class="line">        &#125;</span><br><span class="line">        Integer[] nums = map.keySet().toArray(<span class="keyword">new</span> Integer[<span class="number">0</span>]);</span><br><span class="line">        <span class="comment">// ä¸‰ä¸ªçŠ¶æ€</span></span><br><span class="line">        <span class="keyword">long</span>[] dp = <span class="keyword">new</span> <span class="keyword">long</span>[<span class="number">3</span>];</span><br><span class="line">        dp[<span class="number">1</span>] = map.get(nums[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">if</span>(nums.length==<span class="number">1</span>) <span class="keyword">return</span> dp[<span class="number">1</span>]; </span><br><span class="line">        dp[<span class="number">2</span>] = nums[<span class="number">0</span>]&lt;nums[<span class="number">1</span>]-<span class="number">2</span>?dp[<span class="number">1</span>]+map.get(nums[<span class="number">1</span>]):Math.max(dp[<span class="number">1</span>], map.get(nums[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// jæ”¾åˆ°å¤–é¢ï¼Œå¯ä»¥é¿å…æ¯æ¬¡éƒ½ä»0å¼€å§‹æŸ¥</span></span><br><span class="line">        <span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;nums.length;i++)&#123;</span><br><span class="line">            <span class="comment">// å®šä½j</span></span><br><span class="line">            <span class="keyword">while</span> (nums[j] &lt; nums[i]-<span class="number">2</span>) &#123;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> pos = j==i?<span class="number">2</span>:(j==i-<span class="number">1</span>?<span class="number">1</span>:<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">long</span> tmp = dp[<span class="number">2</span>];</span><br><span class="line">            dp[<span class="number">2</span>] = Math.max(dp[<span class="number">2</span>], dp[pos]+map.get(nums[i]));</span><br><span class="line">            dp[<span class="number">0</span>] = dp[<span class="number">1</span>];</span><br><span class="line">            dp[<span class="number">1</span>] = tmp;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€è€ƒï¼šå¦‚æœæŠŠ2æ¢ä¸ºkå‘¢ï¼Ÿä¸€æ ·çš„ï¼Œå¤šå¢åŠ å‡ ä¸ªçŠ¶æ€å°±è¡Œäº†ï¼Œæ»šåŠ¨æ•°ç»„æ³•åªéœ€è¦k+1ä¸ªçŠ¶æ€ã€‚</p><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://leetcode.cn/problems/house-robber/solutions/263856/da-jia-jie-she-by-leetcode-solution/">https://leetcode.cn/problems/house-robber/solutions/263856/da-jia-jie-she-by-leetcode-solution/</a><br>[2] <a href="https://leetcode.cn/problems/maximum-total-damage-with-spell-casting/solutions/2812389/tao-lu-da-jia-jie-she-pythonjavacgo-by-e-p9b5/">https://leetcode.cn/problems/maximum-total-damage-with-spell-casting/solutions/2812389/tao-lu-da-jia-jie-she-pythonjavacgo-by-e-p9b5/</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è¿™å‘¨å‘¨èµ›èœäº†â€¦èµ¶ç´§è®°ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨ä¸»é¢˜ï¼šå·®åˆ†æ•°ç»„ã€åŠ¨æ€è§„åˆ’&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;240615æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/maximum-beauty-of-an-array-after-applying-operation/description/&quot;&gt;Maximum Beauty of an Array After Applying Operation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240616å‘¨èµ›ç¬¬ä¸‰é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/maximum-total-damage-with-spell-casting/description/&quot;&gt;Maximum Total Damage With Spell Casting&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;LC198æ‰“å®¶åŠ«èˆâ€”&lt;a href=&quot;https://leetcode.cn/problems/house-robber/description/&quot;&gt;House Robber&lt;/a&gt;</summary>
    
    
    
    
    <category term="LeetCode" scheme="http://silencezheng.top/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeå‘¨è®° EP1</title>
    <link href="http://silencezheng.top/2024/08/18/article132/"/>
    <id>http://silencezheng.top/2024/08/18/article132/</id>
    <published>2024-08-17T16:14:09.000Z</published>
    <updated>2024-10-27T15:29:11.756Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ–°å¼€ä¸€ä¸ªç³»åˆ—ï¼ŒLeetCodeåˆ·é¢˜å‘¨è®°ï¼Œæ¯å‘¨åˆ·é¢˜æœ‰æ„Ÿæ‚Ÿå¯ä»¥æ€»ç»“ä¸€ä¸‹ã€‚</p><p>æœ¬å‘¨ä¸»é¢˜ï¼šè®°å¿†åŒ–æœç´¢ã€åŠ¨æ€è§„åˆ’ã€01èƒŒåŒ…</p><p>é¢˜ç›®ï¼š</p><ul><li>240609æ¯æ—¥ä¸€é¢˜â€”<a href="https://leetcode.cn/problems/burst-balloons/description/">Burst Balloons</a></li><li>240608åŒå‘¨èµ›æœ€åä¸¤é¢˜â€”<a href="https://leetcode.cn/problems/find-the-maximum-length-of-a-good-subsequence-ii/description/">Find the Maximum Length of a Good Subsequence</a></li><li>240609å‘¨èµ›æœ€åä¸¤é¢˜â€”<a href="https://leetcode.cn/problems/maximum-total-reward-using-operations-ii/description/">Maximum Total Reward Using Operations</a><span id="more"></span><h1 id="è®°å¿†åŒ–æœç´¢"><a href="#è®°å¿†åŒ–æœç´¢" class="headerlink" title="è®°å¿†åŒ–æœç´¢"></a>è®°å¿†åŒ–æœç´¢</h1><blockquote><p><strong>Burst Balloons</strong><br>You are given n balloons, indexed from 0 to n - 1. Each balloon is painted with a number on it represented by an array nums. You are asked to burst all the balloons.</p><p>If you burst the ith balloon, you will get nums[i - 1] <em> nums[i] </em> nums[i + 1] coins. If i - 1 or i + 1 goes out of bounds of the array, then treat it as if there is a balloon with a 1 painted on it.</p><p>Return the maximum coins you can collect by bursting the balloons wisely.</p></blockquote></li></ul><p>è¿™é“é¢˜çš„ç¬¬ä¸€ä¸ªå…³é”®æ€è·¯æ˜¯é€†å‘æ€ç»´ï¼Œæˆ³æ°”çƒçš„æ“ä½œä¼šå¯¼è‡´ä¸¤ä¸ªæ°”çƒä»ä¸ç›¸é‚»å˜æˆç›¸é‚»ï¼Œä½¿åç»­æ“ä½œå¤„ç†å›°éš¾ï¼Œå°†æˆ³æ°”çƒçš„è¿‡ç¨‹åè¿‡æ¥çœ‹æˆæ¯æ¬¡æ·»åŠ ä¸€ä¸ªæ°”çƒï¼Œç›´åˆ°å½¢æˆåŸæ•°ç»„ã€‚å®šä¹‰æ–¹æ³• $solve$ï¼Œä»¤ $solve(i,j)$ è¡¨ç¤ºå°†å¼€åŒºé—´ $(i,j)$ å†…çš„ä½ç½®å…¨éƒ¨å¡«æ»¡æ°”çƒèƒ½å¤Ÿå¾—åˆ°çš„æœ€å¤šç¡¬å¸æ•°ã€‚ç”±äºæ˜¯å¼€åŒºé—´ï¼Œå› æ­¤åŒºé—´ä¸¤ç«¯çš„æ°”çƒçš„ç¼–å·å°±æ˜¯ $i$ å’Œ $j$ï¼Œå¯¹åº”ç€ $val[i]$ å’Œ $val[j]$ã€‚</p><p>ç¬¬äºŒä¸ªæ€è·¯æ¯”è¾ƒç®€å•ï¼Œåœ¨åŸæ•°ç»„å·¦å³å„å¢åŠ ä¸€ä¸ª$1$ï¼Œå³å·¦å³è¾¹ç•Œæ—¶çš„å¾—åˆ†ã€‚</p><p>ä¸‹é¢ï¼Œå¯¹äº$solve(i,j)$ï¼š</p><ul><li>å½“ $iâ‰¥jâˆ’1$ æ—¶ï¼Œå¼€åŒºé—´ä¸­æ²¡æœ‰æ°”çƒï¼Œ$solve(i,j)$ çš„å€¼ä¸º 0ï¼›</li><li>å½“ $i&lt;jâˆ’1$ æ—¶ï¼Œæˆ‘ä»¬æšä¸¾å¼€åŒºé—´å†…çš„å…¨éƒ¨ä½ç½® $mid$ï¼Œä»¤ $mid$ ä¸ºå½“å‰åŒºé—´ç¬¬ä¸€ä¸ªæ·»åŠ çš„æ°”çƒï¼Œè¯¥æ“ä½œèƒ½å¾—åˆ°çš„ç¡¬å¸æ•°ä¸º $val[i]Ã—val[mid]Ã—val[j]$ã€‚åŒæ—¶æˆ‘ä»¬é€’å½’åœ°è®¡ç®—åˆ†å‰²å‡ºçš„ä¸¤åŒºé—´å¯¹ $solve(i,j)$ çš„è´¡çŒ®ï¼Œè¿™ä¸‰é¡¹ä¹‹å’Œçš„æœ€å¤§å€¼ï¼Œå³ä¸º $solve(i,j)$ çš„å€¼ã€‚è¿™æ ·é—®é¢˜å°±è½¬åŒ–ä¸ºæ±‚ $solve(i,mid)$ å’Œ $solve(mid,j)$ ï¼Œå¯ä»¥å†™å‡ºæ–¹ç¨‹ï¼š<script type="math/tex; mode=display">{solve}(i,j)= \begin{cases}{} \displaystyle \max_{\textit{mid} = i + 1}^{j - 1}val[i] \times \textit{val}[\textit{mid}] \times \textit{val}[j] + \textit{solve}(i, \textit{mid}) + \textit{solve}(\textit{mid}, j) ,&i < j - 1 \\ 0, & i \geq j - 1 \end{cases}</script></li></ul><p>ç”±äºåœ¨æšä¸¾midçš„è¿‡ç¨‹ä¸­ï¼Œä¸€å®šä¼šäº§ç”Ÿç›¸åŒå­åŒºé—´ï¼Œå³å­˜åœ¨é‡å¤è®¡ç®—ï¼Œæ­¤æ—¶å¯ä»¥é‡‡ç”¨è®°å¿†åŒ–çš„æ–¹å¼å­˜å‚¨è®¡ç®—ç»“æœï¼Œä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[][] rec;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] val;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxCoins</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.length;</span><br><span class="line">        val = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">2</span>]; <span class="comment">// å¢åŠ è¾¹ç•Œ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            val[i] = nums[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        val[<span class="number">0</span>] = val[n + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        rec = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">2</span>][n + <span class="number">2</span>]; <span class="comment">// è®°å¿†åŒ–</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n + <span class="number">1</span>; i++) &#123;</span><br><span class="line">            Arrays.fill(rec[i], -<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> solve(<span class="number">0</span>, n + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (left &gt;= right - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (rec[left][right] != -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> rec[left][right]; <span class="comment">// å·²è®¡ç®—</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = left + <span class="number">1</span>; i &lt; right; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> sum = val[left] * val[i] * val[right];</span><br><span class="line">            sum += solve(left, i) + solve(i, right);</span><br><span class="line">            rec[left][right] = Math.max(rec[left][right], sum);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rec[left][right];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span><br><span class="line">é“¾æ¥ï¼šhttps:<span class="comment">//leetcode.cn/problems/burst-balloons/solutions/336390/chuo-qi-qiu-by-leetcode-solution/</span></span><br><span class="line">æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰</span><br><span class="line">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span><br></pre></td></tr></table></figure><h1 id="èƒŒåŒ…DP"><a href="#èƒŒåŒ…DP" class="headerlink" title="èƒŒåŒ…DP"></a>èƒŒåŒ…DP</h1><blockquote><p>æœ‰ $n$ ä¸ªç‰©å“å’Œä¸€ä¸ªå®¹é‡ä¸º $W$ çš„èƒŒåŒ…ï¼Œæ¯ä¸ªç‰©å“æœ‰é‡é‡ $w_{i}$ å’Œä»·å€¼ $v_{i}$ ä¸¤ç§å±æ€§ï¼Œè¦æ±‚é€‰è‹¥å¹²ç‰©å“æ”¾å…¥èƒŒåŒ…ä½¿èƒŒåŒ…ä¸­ç‰©å“çš„æ€»ä»·å€¼æœ€å¤§ä¸”èƒŒåŒ…ä¸­ç‰©å“çš„æ€»é‡é‡ä¸è¶…è¿‡èƒŒåŒ…çš„å®¹é‡ã€‚</p></blockquote><h2 id="0-1èƒŒåŒ…"><a href="#0-1èƒŒåŒ…" class="headerlink" title="0-1èƒŒåŒ…"></a>0-1èƒŒåŒ…</h2><p>åœ¨ä¸Šè¿°ä¾‹é¢˜ä¸­ï¼Œè‹¥æ¯ä¸ªç‰©ä½“åªæœ‰ä¸¤ç§å¯èƒ½çš„çŠ¶æ€ï¼ˆå–ä¸ä¸å–ï¼‰ï¼Œå¯¹åº”äºŒè¿›åˆ¶ä¸­çš„ 0 å’Œ 1ï¼Œè¿™ç±»é—®é¢˜ä¾¿è¢«ç§°ä¸ºã€Œ0-1 èƒŒåŒ…é—®é¢˜ã€ã€‚</p><p>ä¾‹é¢˜ä¸­å·²çŸ¥æ¡ä»¶æœ‰ç¬¬ $i$ ä¸ªç‰©å“çš„é‡é‡ $w_{i}$ï¼Œä»·å€¼ $v_{i}$ï¼Œä»¥åŠèƒŒåŒ…çš„æ€»å®¹é‡ $W$ã€‚</p><p>è®¾ DP çŠ¶æ€ $f_{i,j}$ ä¸ºåœ¨åªèƒ½æ”¾å‰ $i$ ä¸ªç‰©å“çš„æƒ…å†µä¸‹ï¼Œå®¹é‡ä¸º $j$ çš„èƒŒåŒ…æ‰€èƒ½è¾¾åˆ°çš„æœ€å¤§æ€»ä»·å€¼ã€‚</p><p>è€ƒè™‘è½¬ç§»ã€‚å‡è®¾å½“å‰å·²ç»å¤„ç†å¥½äº†å‰ $i-1$ ä¸ªç‰©å“çš„æ‰€æœ‰çŠ¶æ€ï¼Œé‚£ä¹ˆå¯¹äºç¬¬ $i$ ä¸ªç‰©å“ï¼Œå½“å…¶ä¸æ”¾å…¥èƒŒåŒ…æ—¶ï¼ŒèƒŒåŒ…çš„å®¹é‡ä¸å˜ï¼ŒèƒŒåŒ…ä¸­ç‰©å“çš„æ€»ä»·å€¼ä¹Ÿä¸å˜ï¼Œæ•…è¿™ç§æƒ…å†µçš„æœ€å¤§ä»·å€¼ä¸º $f_{i-1,j}$ï¼›å½“å…¶æ”¾å…¥èƒŒåŒ…æ—¶ï¼ŒèƒŒåŒ…çš„å®¹é‡ä¼šå¢å¤§ $w_{i}$ï¼Œå³å‰ä¸€ä¸ªçŠ¶æ€çš„èƒŒåŒ…å®¹é‡å¿…é¡»æ˜¯ $j-w_{i}$ï¼Œé€šè¿‡æœ¬è½®åŠ ä¸Š $w_{i}$ è¾¾åˆ° $j$ï¼ŒåŒæ—¶èƒŒåŒ…ä¸­ç‰©å“çš„æ€»ä»·å€¼ä¼šå¢å¤§ $v_{i}$ï¼Œæ•…è¿™ç§æƒ…å†µä¸‹çš„æœ€å¤§ä»·å€¼ä¸º $f_{i-1,j-w_{i}}+v_{i}$ã€‚</p><p>ç”±æ­¤å¯ä»¥å¾—å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f_{i,j}=\max(f_{i-1,j},f_{i-1,j-w_{i}}+v_{i})</script><p>ä¾æ®è¯¥çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¯ä»¥å†™å‡ºè§£æ³•1:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n = w.length;</span><br><span class="line"><span class="comment">// å®¹é‡ç»´åº¦å¤šå¼€è¾Ÿä¸€ä¸ªä½ç½®ï¼Œå› ä¸ºè¦ç”¨ç´¢å¼•è¡¨ç¤ºå®¹é‡ï¼Œéœ€è¦åŒ¹é…åˆ° W</span></span><br><span class="line"><span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[n][W+<span class="number">1</span>];</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line"><span class="comment">// å¯¹äºdp[0][j]ï¼Œæ‰€æœ‰j&lt;w[0]çš„ä½ç½®åˆå§‹åŒ–ä¸º0ï¼Œå…¶ä½™ä½ç½®åˆå§‹åŒ–ä¸º v[0]</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=W;j++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(j&lt;w[<span class="number">0</span>])&#123;</span><br><span class="line">        dp[<span class="number">0</span>][j] = <span class="number">0</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        dp[<span class="number">0</span>][j] = v[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¯¹äºdp[i][0]ï¼ŒèƒŒåŒ…å®¹é‡ä¸º0æ—¶æ— æ³•è£…ç‰©ï¼Œä»·å€¼ä¸º0ï¼Œå¯¹äºå…¶ä½™ä½ç½®ï¼Œæ˜¯ç”±å…¶ä¸Šå±‚çš„çŠ¶æ€è®¡ç®—å‡ºçš„ï¼Œä¹Ÿä¸€å¹¶åˆå§‹åŒ–ä¸º0</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">    Arrays.fills(dp[i], <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è®¡ç®—</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=W;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(j&gt;=w[i]) dp[i][j]=Math.max(dp[i-<span class="number">1</span>][j], dp[i-<span class="number">1</span>][j-w[i]]+v[i]);</span><br><span class="line">        <span class="keyword">else</span> dp[i][j]=dp[i-<span class="number">1</span>][j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// dp[n-1][W]å³ä¸ºç»“æœ</span></span><br></pre></td></tr></table></figure><p>å¦‚æœç›´æ¥é‡‡ç”¨äºŒç»´æ•°ç»„å¯¹çŠ¶æ€è¿›è¡Œè®°å½•ï¼Œå¯èƒ½ä¼šå‡ºç° MLEï¼ˆMemory Limit Exceededï¼‰ã€‚å¯ä»¥è€ƒè™‘æ”¹ç”¨<strong>æ»šåŠ¨æ•°ç»„</strong>çš„å½¢å¼æ¥ä¼˜åŒ–ã€‚</p><blockquote><p>æ»šåŠ¨æ•°ç»„</p><p>åœ¨åŠ¨æ€è§„åˆ’é—®é¢˜ä¸­ï¼Œé€šå¸¸éœ€è¦å­˜å‚¨ä¸€ç³»åˆ—çŠ¶æ€å€¼ï¼Œæ¯ä¸ªçŠ¶æ€å€¼å¯èƒ½ä¾èµ–äºå‰å‡ ä¸ªçŠ¶æ€ã€‚éšç€è®¡ç®—çš„è¿›è¡Œï¼Œè¾ƒæ—©çš„çŠ¶æ€å€¼å¯èƒ½ä¸å†éœ€è¦ã€‚ä¾‹å¦‚ï¼Œåœ¨æ±‚è§£æ–æ³¢é‚£å¥‘æ•°åˆ—æ—¶ï¼Œåªéœ€è¦ä¿ç•™æœ€è¿‘ä¸¤ä¸ªå€¼å³å¯è®¡ç®—ä¸‹ä¸€ä¸ªå€¼ï¼Œä¹‹å‰çš„å€¼åˆ™å¯ä»¥è¢«è¦†ç›–é‡ç”¨ã€‚</p><p>æ€æƒ³ï¼šé€šè¿‡è§‚å¯Ÿdpæ–¹ç¨‹æ¥åˆ¤æ–­éœ€è¦ä½¿ç”¨å“ªäº›æ•°æ®ï¼Œå¯ä»¥æŠ›å¼ƒå“ªäº›æ•°æ®ï¼Œä¸€æ—¦æ‰¾åˆ°å…³ç³»ï¼Œå°±å¯ä»¥ç”¨æ–°çš„æ•°æ®ä¸æ–­è¦†ç›–æ—§çš„æ•°æ®é‡æ¥å‡å°‘ç©ºé—´çš„ä½¿ç”¨ã€‚</p></blockquote><p>ç”±äºåœ¨äºŒç»´è§£æ³•ä¸­ï¼Œå¯¹äºå½“å‰å±‚ï¼ˆå½“å‰ç‰©å“ï¼‰çŠ¶æ€æœ‰å½±å“çš„åªæœ‰ä¸Šä¸€å±‚ï¼ˆå‰ä¸€ç‰©å“ï¼‰ï¼Œå³å¯¹ $f_i$ æœ‰å½±å“çš„åªæœ‰ $f_{i-1}$ï¼Œåˆ™å¯ä»¥å»æ‰ç¬¬ä¸€ç»´ï¼Œç”¨ä¸€ä¸ªé‡å¤æ›´æ–°çš„ä¸€ç»´æ•°ç»„è®°å½•çŠ¶æ€ï¼Œç›´æ¥ç”¨ $f_{j}$ æ¥è¡¨ç¤ºå¤„ç†åˆ°å½“å‰ç‰©å“æ—¶èƒŒåŒ…å®¹é‡ä¸º $j$ çš„æœ€å¤§ä»·å€¼ï¼Œå¾—å‡ºä»¥ä¸‹æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f_j=\max \left(f_j,f_{j-w_i}+v_i\right)</script><p>è¿™é‡Œï¼Œ$f_{j-w_i} + v_i$ä»£è¡¨å¦‚æœé€‰æ‹©æ”¾å…¥ç¬¬$i$ä¸ªç‰©å“ï¼Œåˆ™åœ¨èƒŒåŒ…å®¹é‡ä¸º$j-w_i$æ—¶çš„ä»·å€¼åŠ ä¸Šè¿™ä¸ªç‰©å“çš„ä»·å€¼ã€‚è€Œ$max$æ“ä½œä¿è¯äº†åœ¨æ˜¯å¦é€‰æ‹©æ”¾å…¥ç¬¬$i$ä¸ªç‰©å“ä¹‹é—´å–æœ€ä¼˜è§£ã€‚</p><p>å¤§éƒ¨åˆ†èƒŒåŒ…é—®é¢˜çš„è½¬ç§»æ–¹ç¨‹éƒ½æ˜¯åœ¨æ­¤åŸºç¡€ä¸Šæ¨å¯¼å‡ºæ¥çš„ã€‚</p><p>å¯¹äºä»£ç å®ç°æ–¹é¢ï¼Œ<strong>æ»šåŠ¨æ•°ç»„çš„å®ç°è¦æ³¨æ„å†…å±‚å¾ªç¯åº”ä»åå‘å‰é€†åºéå†</strong>ï¼Œè¿™å¯ä»¥é¿å…åœ¨ $j\geqslant w_{i}$ æ—¶ï¼Œ$f_{i,j}$ è¢« $f_{i,j-w_{i}}$ æ‰€å½±å“ï¼Œå³é¿å…å°èƒŒåŒ…å®¹é‡ä¸‹å–ç‰©å¯¹åç»­å¤§èƒŒåŒ…å®¹é‡ä¸‹çŠ¶æ€è®¡ç®—çš„å½±å“ã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼Œå‡è®¾<em>ç‰©å“4</em>çš„é‡é‡ä¸º$1$ï¼Œåœ¨äºŒç»´è§£æ³•ä¸­<code>dp[4][5]</code>åº”è¯¥ç”±<code>dp[3][5]</code>å’Œ<code>dp[3][4]</code>å¾—å‡ºï¼Œ<code>dp[4][6]</code>åº”è¯¥ç”±<code>dp[3][6]</code>å’Œ<code>dp[3][5]</code>å¾—å‡ºï¼Œè€Œåœ¨æ­£åºéå†çš„ä¸€ç»´è§£æ³•ä¸­ï¼Œ<code>f[5]</code>ä¼šå…ˆè¢«è®¡ç®—ï¼Œå¯èƒ½å­˜åœ¨<code>f[5]</code>å­˜å‚¨<code>dp[3][4]</code>çŠ¶æ€çš„æƒ…å†µï¼Œæ­¤æ—¶<code>f[6]</code>çš„è®¡ç®—å°±æ— æ³•è·å–<code>dp[3][5]</code>ï¼Œé€ æˆè®¡ç®—é”™è¯¯ã€‚è¿™ä¸ªè®¡ç®—é”™è¯¯äº‹å®ä¸Šæ˜¯å¯¹<strong>åŒä¸€ç‰©å“çš„å¤šæ¬¡è£…åŒ…</strong>ï¼Œå› ä¸º<code>dp[3][4]</code>è¡¨ç¤ºå–<em>ç‰©å“4</em>(ä¸‹æ ‡ä¸º3)ï¼Œè‹¥ä¸‹ä¸€æ­¥<code>f[6]</code>å†é€‰æ‹©<code>f[5]+v[3]</code>åˆ™è¡¨ç¤ºåˆå–äº†ä¸€æ¬¡<em>ç‰©å“4</em>ï¼Œè¿™åœ¨01èƒŒåŒ…ä¸­æ˜¯ä¸å…è®¸çš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">13010</span>;</span><br><span class="line"><span class="keyword">int</span> n, W, w[maxn], v[maxn], f[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; W;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; w[i] &gt;&gt; v[i];  <span class="comment">// è¯»å…¥æ•°æ®</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> l = W; l &gt;= w[i]; l--) <span class="comment">// l &gt;= w[i]ä¿è¯èƒŒåŒ…èƒ½è£…ä¸‹ï¼Œé˜²æ­¢è¶Šç•Œ</span></span><br><span class="line">      <span class="keyword">if</span> (f[l - w[i]] + v[i] &gt; f[l]) f[l] = f[l - w[i]] + v[i];  <span class="comment">// çŠ¶æ€æ–¹ç¨‹</span></span><br><span class="line">  cout &lt;&lt; f[W];</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é”™è¯¯çš„ï¼š</span></span><br><span class="line"><span class="comment">// for (int i = 1; i &lt;= n; i++)</span></span><br><span class="line"><span class="comment">//   for (int l = 0; l &lt;= W - w[i]; l++)</span></span><br><span class="line"><span class="comment">//     f[l + w[i]] = max(f[l] + v[i], f[l + w[i]]);</span></span><br></pre></td></tr></table></figure><h2 id="å®Œå…¨èƒŒåŒ…"><a href="#å®Œå…¨èƒŒåŒ…" class="headerlink" title="å®Œå…¨èƒŒåŒ…"></a>å®Œå…¨èƒŒåŒ…</h2><p>å®Œå…¨èƒŒåŒ…æ¨¡å‹ä¸ 0-1 èƒŒåŒ…ç±»ä¼¼ï¼Œä¸ 0-1 èƒŒåŒ…çš„åŒºåˆ«ä»…åœ¨äºä¸€ä¸ªç‰©å“å¯ä»¥é€‰å–æ— é™æ¬¡ï¼Œè€Œéä»…èƒ½é€‰å–ä¸€æ¬¡ã€‚</p><p>å¯ä»¥å€Ÿé‰´ 0-1 èƒŒåŒ…çš„æ€è·¯ï¼Œè¿›è¡ŒçŠ¶æ€å®šä¹‰ï¼šè®¾ $f_{i,j}$ ä¸ºåªèƒ½é€‰å‰ $i$ ä¸ªç‰©å“æ—¶ï¼Œå®¹é‡ä¸º $j$ çš„èƒŒåŒ…å¯ä»¥è¾¾åˆ°çš„æœ€å¤§ä»·å€¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶å®šä¹‰ä¸ 0-1 èƒŒåŒ…ç±»ä¼¼ï¼Œä½†æ˜¯å…¶çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ 0-1 èƒŒåŒ…å¹¶ä¸ç›¸åŒã€‚</p><p>å¯ä»¥è€ƒè™‘ä¸€ä¸ªæœ´ç´ çš„åšæ³•ï¼šå¯¹äºç¬¬ $i$ ä»¶ç‰©å“ï¼Œæšä¸¾å…¶é€‰äº†å¤šå°‘ä¸ªæ¥è½¬ç§»ã€‚è¿™æ ·åšçš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n^3)$ çš„ã€‚</p><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">f_{i,j}=\max_{k=0}^{+\infty}(f_{i-1,j-k\times w_i}+v_i\times k)</script><p>è€ƒè™‘è¿›è¡Œä¼˜åŒ–ã€‚å¯ä»¥å‘ç°ï¼Œå¯¹äº $f_{i,j}$ï¼Œåªè¦é€šè¿‡ $f_{i,j-w_i}$ è½¬ç§»å°±å¯ä»¥äº†ã€‚å› æ­¤çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºï¼š</p><script type="math/tex; mode=display">f_{i,j}=\max(f_{i-1,j},f_{i,j-w_i}+v_i)</script><p>ç†ç”±æ˜¯å½“æˆ‘ä»¬è¿™æ ·è½¬ç§»æ—¶ï¼Œ$f_{i,j-w_i}$ å·²ç»ç”± $f_{i,j-2\times w_i}$ æ›´æ–°è¿‡ï¼Œé‚£ä¹ˆ $f_{i,j-w_i}$ å°±æ˜¯å……åˆ†è€ƒè™‘äº†ç¬¬ $i$ ä»¶ç‰©å“æ‰€é€‰æ¬¡æ•°åå¾—åˆ°çš„æœ€ä¼˜ç»“æœã€‚æ¢è¨€ä¹‹ï¼Œæˆ‘ä»¬é€šè¿‡å±€éƒ¨æœ€ä¼˜å­ç»“æ„çš„æ€§è´¨é‡å¤ä½¿ç”¨äº†ä¹‹å‰çš„æšä¸¾è¿‡ç¨‹ï¼Œä¼˜åŒ–äº†æšä¸¾çš„å¤æ‚åº¦ã€‚ä¸ 0-1 èƒŒåŒ…ç›¸åŒï¼Œæˆ‘ä»¬å¯ä»¥å°†ç¬¬ä¸€ç»´å»æ‰æ¥ä¼˜åŒ–ç©ºé—´å¤æ‚åº¦ã€‚</p><p>å®ç°ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxW = <span class="number">1e7</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, W, w[maxn], v[maxn];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> f[maxW];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cin &gt;&gt; W &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; w[i] &gt;&gt; v[i];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> l = w[i]; l &lt;= W; l++)</span><br><span class="line">      <span class="keyword">if</span> (f[l - w[i]] + v[i] &gt; f[l]) f[l] = f[l - w[i]] + v[i];  <span class="comment">// æ ¸å¿ƒçŠ¶æ€æ–¹ç¨‹</span></span><br><span class="line">  cout &lt;&lt; f[W];</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="ä¾‹é¢˜1-Maximum-Total-Reward-Using-Operations"><a href="#ä¾‹é¢˜1-Maximum-Total-Reward-Using-Operations" class="headerlink" title="ä¾‹é¢˜1: Maximum Total Reward Using Operations"></a>ä¾‹é¢˜1: Maximum Total Reward Using Operations</h2><blockquote><p><strong>Maximum Total Reward Using Operations I &amp; II</strong></p><p>You are given an integer array rewardValues of length n, representing the values of rewards.</p><p>Initially, your total reward x is 0, and all indices are unmarked. You are allowed to perform the following operation any number of times:</p><ul><li>Choose an unmarked index i from the range [0, n - 1].</li><li>If rewardValues[i] is greater than your current total reward x, then add rewardValues[i] to x (i.e., x = x + rewardValues[i]), and mark the index i.</li></ul><p>Return an integer denoting the maximum total reward you can collect by performing the operations optimally.</p></blockquote><p>é¦–å…ˆï¼Œ<code>rewardValues</code>ä¸­çš„æ•°åº”è¯¥ä»å°åˆ°å¤§é€‰ï¼Œäºæ˜¯å¯ä»¥å¯¹å…¶è¿›è¡Œæ’åºã€‚æ’åºåï¼Œå¯ä»¥çœ‹ä½œ01èƒŒåŒ…é—®é¢˜å¤„ç†ï¼ŒèƒŒåŒ…çš„é‡é‡é™åˆ¶è½¬åŒ–æˆäº†<code>rewardValues[i]</code>ä¸reward<code>x</code>çš„åˆ¶çº¦å…³ç³»ã€‚å› æ­¤å®šä¹‰ <code>f[i][j]</code> è¡¨ç¤ºé€‰å–å‰<code>i</code>ä¸ª<code>rewardValues</code>ä¸‹<code>x</code>èƒ½è¾¾åˆ°çš„æœ€å¤§å€¼<code>j</code>ã€‚ç”±äº<code>x</code>æ‰€èƒ½è¾¾åˆ°çš„æœ€å¤§å€¼ä¸ç¡®å®šï¼Œåœ¨å®ç°ä¸­åº”é€‰å–ä¸€ä¸ªå°½å¯èƒ½å¤§çš„å€¼ã€‚</p><p>è€ƒè™‘è½¬ç§»ï¼Œå¯¹äº<code>f[i][j]</code>ï¼Œæ˜¯å¦é€‰æ‹©<code>rewardValues[i]</code>ï¼š</p><ul><li>ä¸é€‰ï¼Œ<code>f[i][j] = f[i-1][j]</code>ï¼Œå³åˆ†æ•°ä¸ä¸Šè½®ç›¸åŒã€‚</li><li>é€‰æ‹©ï¼Œ<code>f[i][j] = f[i-1][j-rewardValues[i]]</code>ï¼Œå³ä¸Šä¸€è½®çš„åˆ†æ•° <code>j-rewardValues[i]</code> å¿…é¡»æ»¡è¶³ <code>j-rewardValues[i]&lt;rewardValues[i]</code>, åŒæ—¶ä¸ºé˜²æ­¢è¶Šç•Œï¼Œ<code>j-rewardValues[i]</code>éœ€è¦å¤§äºç­‰äº0ã€‚ç»¼ä¸Šï¼Œéœ€æ»¡è¶³ <code>rewardValues[i] &lt;= j &lt; 2*rewardValues[i]</code>ã€‚</li></ul><p>è¿™é‡Œç”±äº<code>f[i][j]</code>ä¸éœ€è¦å­˜å‚¨â€œä»·å€¼â€ï¼Œ<code>j</code>è‡ªç„¶è¡¨ç¤ºäº†å¯ä»¥è¾¾åˆ°çš„æœ€å¤§å€¼ï¼Œå› æ­¤<code>f[i][j]</code>é€šè¿‡å¸ƒå°”å€¼è¡¨ç¤ºæ˜¯å¦å¯è¾¾å³å¯ï¼Œåˆ™æœ‰<code>f[i][j] = f[i-1][j] || f[i-1][j-rewardValues[i]]</code>ã€‚</p><p>å†™å‡ºäºŒç»´è§£æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxTotalReward</span><span class="params">(<span class="keyword">int</span>[] rewardValues)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = rewardValues.length;</span><br><span class="line">        <span class="keyword">int</span> m = <span class="number">10000</span>;</span><br><span class="line">        <span class="comment">// int m = Integer.MAX_VALUE;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯¹ç‰©å“ä»å°åˆ°å¤§æ’åº</span></span><br><span class="line">        Arrays.sort(rewardValues);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å…¨éƒ¨åˆå§‹åŒ–ä¸ºfalse</span></span><br><span class="line">        <span class="keyword">boolean</span>[][] dp = <span class="keyword">new</span> <span class="keyword">boolean</span>[n][m];</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–ç¬¬ä¸€è¡Œ</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="keyword">true</span>; <span class="comment">// ä¸é€‰</span></span><br><span class="line">        dp[<span class="number">0</span>][rewardValues[<span class="number">0</span>]] = <span class="keyword">true</span>; <span class="comment">// é€‰</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¼€å§‹è®¡ç®—dpæ•°ç»„</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="comment">// åˆå§‹åŒ–ç¬¬ä¸€åˆ—ï¼Œå³ä¸€ç›´ä¸é€‰ã€‚</span></span><br><span class="line">            dp[i][<span class="number">0</span>] = <span class="keyword">true</span>;</span><br><span class="line">            <span class="comment">// å¯¹äº[1, rewardValues[i]]åŒºé—´ï¼Œå¤åˆ¶ä¸Šä¸€å±‚è¡¨ç¤ºå¯ä»¥ä¸é€‰ã€‚</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;rewardValues[i];j++)&#123;</span><br><span class="line">                dp[i][j] = dp[i-<span class="number">1</span>][j];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¯¹äºå¯é€‰å–åŒºé—´ï¼Œè®¡ç®—æ–°å¾—åˆ†ã€‚</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=rewardValues[i];j&lt;<span class="number">2</span>*rewardValues[i];j++)&#123;</span><br><span class="line">                dp[i][j] = (dp[i-<span class="number">1</span>][j] || dp[i-<span class="number">1</span>][j-rewardValues[i]]);</span><br><span class="line">                <span class="comment">// if(dp[i][j]) System.out.println(i+&quot;, &quot;+j);</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è¿”å›æœ€åä¸€è¡Œçš„æœ€å¤§çœŸå€¼</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=m-<span class="number">1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">            <span class="keyword">if</span>(dp[n-<span class="number">1</span>][i]) <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äºŒç»´è§£æ³•å¯¹äºæ•°æ®èŒƒå›´å¤§çš„æƒ…å†µä¼šå­˜åœ¨MLEï¼Œå› æ­¤å‚ç…§01èƒŒåŒ…é—®é¢˜ï¼Œè€ƒè™‘ä½¿ç”¨æ»šåŠ¨æ•°ç»„è¿›è¡Œä¼˜åŒ–ã€‚åŸè®¡ç®—å¯ä»¥ç®€åŒ–ä¸ºï¼š<code>f[j] = f[j] || f[j-rewardValues[i]]</code>ï¼ŒåŒæ—¶æ³¨æ„é€†åºéå†ã€‚å¦å¤–ï¼Œç”±äºæœ€ç»ˆç»“æœå¯ä»¥ç”±<code>j</code>çš„å€¼è¡¨ç¤ºï¼Œæ•…å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–æ•°ç»„ä¸ºä½è¿ç®—ï¼Œé‡‡ç”¨ä¸€ä¸ª<code>BigInteger</code>è¡¨ç¤ºå¸ƒå°”æ•°ç»„ã€‚</p><p>ä¸‹é¢è€ƒè™‘å¦‚ä½•ç”¨ä½è¿ç®—è¡¨ç¤ºå¸ƒå°”è¿ç®—ï¼Œå‡è®¾ä¹‹å‰å·²ç»éå†è¿‡çš„å…ƒç´ ä¸º<code>1, 2, 3</code>ï¼Œåˆ™æ­¤æ—¶çŠ¶æ€åº”ä¸ºï¼š<code>0000 0011 1111</code>ï¼Œå³å¯è¾¾åˆ†æ•°åŒºé—´ä¸º<code>[0, 5]</code>ï¼Œæ­¤æ—¶å‡è®¾ä¸‹ä¸€ä¸ªå…ƒç´ ä¸º<code>5</code>ï¼Œåˆ™éœ€è¦å¯¹åŒºé—´<code>[5, 10)</code>è¿›è¡Œå¸ƒå°”è®¡ç®—ï¼Œè®¡ç®—çš„æœ¬è´¨æ˜¯å°†å½“å‰çŠ¶æ€çš„åŒºé—´<code>[0, 5)</code>ä¸åŒºé—´<code>[5, 10)</code>è¿›è¡Œ<code>or</code>è¿ç®—ã€‚å› æ­¤å¯ä»¥é€šè¿‡æ„é€ ä¸€ä¸ªâ€œ<em>æŠŠåŒºé—´<code>[0, 5)</code>ç§»åŠ¨åˆ°åŒºé—´<code>[5, 10)</code>ä½ç½®ä¸Šä¸”å…¶ä½™éƒ¨åˆ†ä¸º<code>0</code></em>â€çš„maskæ¥ä¸åŸçŠ¶æ€è¿›è¡Œ<code>or</code>è¿ç®—ï¼Œæ—¢è®¡ç®—äº†ç›®æ ‡åŒºé—´ï¼Œåˆä¸å½±å“å…¶ä»–çŠ¶æ€ã€‚æ„é€ çš„æ–¹æ³•æ˜¯å…ˆæ„é€ åŒºé—´<code>[0, 5)</code>ä¸Šå…¨ä¸º<code>1</code>çš„maskï¼Œè€Œåä¸åŸçŠ¶æ€è¿›è¡Œ<code>and</code>æ“ä½œæå–ç›®æ ‡åŒºé—´ï¼Œå†å°†ç›®æ ‡åŒºé—´å·¦ç§»åˆ°<code>[5, 10)</code>çš„ä½ç½®ä¸Šå¾—åˆ°æœ€ç»ˆçš„maskã€‚</p><p>å¯¹äºä¸Šé¢çš„ä¾‹å­æ¥è¯´ï¼Œæˆ‘ä»¬é¦–å…ˆæ„é€ ä¸€ä¸ªåˆå§‹mask<code>0000 0000 0001</code>ï¼Œè€Œåå¯¹å…¶å·¦ç§»<code>rewardValues[i]</code>ä½ï¼Œè¿™é‡Œå³$5$ä½ï¼Œå¾—åˆ°<code>0000 0001 0000</code>ï¼Œå‡$1$å¾—åˆ°ç›®æ ‡åŒºé—´å…¨çœŸå€¼mask<code>0000 0000 1111</code>ï¼Œå†å·¦ç§»<code>rewardValues[i]</code>ä½åˆ°ç›®æ ‡åŒºé—´ï¼Œå¾—åˆ°<code>0001 1110 0000</code>ï¼Œä¸åŸçŠ¶æ€è¿›è¡Œ<code>or</code>è¿ç®—ï¼Œå¾—åˆ°ï¼š<code>0001 1111 1111</code>ï¼Œå³å¯å–çš„åˆ†æ•°èŒƒå›´ä¸º<code>[0, 8]</code>ï¼Œç¬¦åˆé¢˜æ„ã€‚å‚è€ƒä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxTotalReward</span><span class="params">(<span class="keyword">int</span>[] rewardValues)</span> </span>&#123;</span><br><span class="line">        BigInteger f = BigInteger.ONE;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v : Arrays.stream(rewardValues).distinct().sorted().toArray()) &#123;</span><br><span class="line">            BigInteger mask = BigInteger.ONE.shiftLeft(v).subtract(BigInteger.ONE);</span><br><span class="line">            f = f.or(f.and(mask).shiftLeft(v));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> f.bitLength() - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¾‹é¢˜2-Find-the-Maximum-Length-of-a-Good-Subsequence"><a href="#ä¾‹é¢˜2-Find-the-Maximum-Length-of-a-Good-Subsequence" class="headerlink" title="ä¾‹é¢˜2: Find the Maximum Length of a Good Subsequence"></a>ä¾‹é¢˜2: Find the Maximum Length of a Good Subsequence</h2><blockquote><p>Find the Maximum Length of a Good Subsequence I &amp; II</p><p>You are given an integer array nums and a non-negative integer k. A sequence of integers seq is called good if there are at most k indices i in the range [0, seq.length - 2] such that seq[i] != seq[i + 1].</p><p>Return the maximum possible length of a good subsequence of nums.</p><p>A subsequence is an array that can be derived from another array by deleting some or no elements without changing the order of the remaining elements.</p></blockquote><p><code>Good Subsequence</code>é€šä¿—ç†è§£ä¸€ä¸‹å°±æ˜¯ä¸€ä¸ªæœ‰ä¸è¶…è¿‡<code>k</code>ä¸ª<strong>å‰åä¸ç›¸åŒå…ƒç´ å¯¹</strong>çš„å­åºåˆ—ï¼Œå³é¢˜ç›®éœ€è¦åœ¨å…ƒç´ å°½å¯èƒ½å°‘ä¸åŒçš„æƒ…å†µä¸‹ä½¿å­åºåˆ—å°½å¯èƒ½çš„é•¿ã€‚</p><p>è¿™é“01èƒŒåŒ…æ²¡æƒ³æ¸…æ¥šï¼Œå…ˆæ¥ç‰¹æ®Šæ€è·¯ï¼š<strong>å¤„ç†ç›¸é‚»å…ƒç´ ä¸åŒçš„DPé—®é¢˜</strong></p><p>æŠŠæœ‰$k$ä¸ªç›¸é‚»ä¸‹æ ‡å…ƒç´ ä¸åŒçš„å­åºåˆ—ç§°ä¸ºkåºåˆ—ã€‚ç”¨ $c n t[k]$ è®°å½•ä»¥ $x$ ç»“å°¾çš„ $k$ åºåˆ—çš„æœ€å¤§é•¿åº¦ã€‚è€ƒè™‘ä»¥ $nums[i]$ ç»“å°¾çš„ $k$ åºåˆ—, $nums [i]$ è¦ä¹ˆæ¥åœ¨ä»¥ $nums[i]$ ç»“å°¾çš„ $k$ åºåˆ—åï¼Œè¦ä¹ˆæ¥åœ¨æŸä¸ªä»¥ $n u m s<a href="j&lt;i">j</a>$ ç»“å°¾çš„ $k-1$ åºåˆ—åã€‚æ‰€ä»¥çŠ¶æ€è½¬ç§»æ–¹ç¨‹å³ä¸º</p><script type="math/tex; mode=display">\operatorname{cnt}[k][\operatorname{nums}[i]]=\max \left(\operatorname{cnt}[k][\operatorname{nums}[i]], \max _{j<i}\{\operatorname{cnt}[k-1][\operatorname{nums}[j]]\}\right)+1</script><p>è¿™é‡Œæˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒæ˜¯å¦ $n u m s[j] \neq n u m s[i]$ ï¼Œå³ $k-1$ åºåˆ—æ˜¯å¦å·²ç»ä»¥ $nums[i]$ ç»“å°¾ï¼Œå› ä¸ºåœ¨åŒæ ·ä»¥ $nums[i]$ ç»“å°¾çš„æƒ…å†µä¸‹ï¼Œ $k-1$ åºåˆ—çš„é•¿åº¦ä¸€å®šå°äº $k$ åºåˆ—çš„é•¿åº¦ã€‚</p><p>$c n t[k-1]$ çš„æœ€å¤§å€¼å¯ä»¥åœ¨å“ˆå¸Œè¡¨åŸºç¡€ä¸Šç»´æŠ¤å€¼æœ‰åºæ¥å®ç°ã€‚ä½†å®é™…ä¸Šï¼Œæˆ‘ä»¬ä¸éœ€è¦ç»´æŠ¤ $c n t[k-1]$ çš„æ‰€æœ‰å€¼, ç”±äº $k-1$ åºåˆ—çš„æœ€å¤§é•¿åº¦å•è°ƒä¸å‡, æ‰€ä»¥åªéœ€è¦ç»´æŠ¤ $c n t[k-1]$ çš„æœ€å¤§å€¼å°±å¯ä»¥äº†ã€‚</p><p>åœ¨ä¸€äº›è¦æ±‚ç›¸é‚»çŠ¶æ€ä¸åŒçš„DPé—®é¢˜ä¸­ï¼Œåœ¨å¤„ç†å½“å‰çŠ¶æ€æ—¶ï¼Œä¸ä¸€å®šéè¦ä¸æ‰€æœ‰å‰ç½®çŠ¶æ€æ¯”è¾ƒ, åªéœ€è¦è®°å½• $d p$ æœ€å¤§å’Œæ¬¡å¤§å€¼å¯¹åº”çš„å‰ç½®çŠ¶æ€å³å¯ã€‚è¿™æ ·çš„æ€è·¯åŒæ ·é€‚ç”¨äºæœ¬é¢˜ã€‚</p><p>æ³¨æ„ç”±äº$nums[i]$çš„èŒƒå›´æ¯”è¾ƒå¤§ï¼ŒJavaå®ç°çš„æ—¶å€™è¦ç”¨Mapæ¥å­˜é˜²æ­¢OOMã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// author: SilenceZheng66</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maximumLength</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        Map&lt;Integer, Map&lt;Integer, Integer&gt;&gt; cnt = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">int</span>[] mx = <span class="keyword">new</span> <span class="keyword">int</span>[k + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= k; i++) &#123;</span><br><span class="line">            cnt.put(i, <span class="keyword">new</span> HashMap&lt;&gt;());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x : nums) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> kk = k; kk &gt;= <span class="number">0</span>; kk--) &#123;</span><br><span class="line">                <span class="comment">// è€ƒè™‘åˆ°æ›´æ–°é¡ºåºï¼Œéœ€è¦å€’åºæšä¸¾</span></span><br><span class="line">                <span class="keyword">int</span> currentValue = kk&gt;<span class="number">0</span>?mx[kk - <span class="number">1</span>]:<span class="number">0</span>;</span><br><span class="line">                currentValue = Math.max(currentValue, cnt.get(kk).getOrDefault(x, <span class="number">0</span>))+<span class="number">1</span>;</span><br><span class="line">                cnt.get(kk).put(x, currentValue);</span><br><span class="line">                mx[kk] = Math.max(mx[kk], cnt.get(kk).getOrDefault(x, <span class="number">0</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> getMax(mx);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getMax</span><span class="params">(<span class="keyword">int</span>[] mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> value : mx) &#123;</span><br><span class="line">            max = Math.max(max, value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> max;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>[1] <a href="https://oi-wiki.org/dp">https://oi-wiki.org/dp</a><br>[2] <a href="https://leetcode.cn/problems/maximum-total-reward-using-operations-ii/solutions/2805413/bitset-you-hua-0-1-bei-bao-by-endlessche-m1xn/">https://leetcode.cn/problems/maximum-total-reward-using-operations-ii/solutions/2805413/bitset-you-hua-0-1-bei-bao-by-endlessche-m1xn/</a><br>[3] <a href="https://blog.csdn.net/txyyt_wst/article/details/130206572">https://blog.csdn.net/txyyt_wst/article/details/130206572</a><br>[4] <a href="https://blog.csdn.net/m0_46427179/article/details/107419492">https://blog.csdn.net/m0_46427179/article/details/107419492</a><br>[5] <a href="https://leetcode.cn/problems/find-the-maximum-length-of-a-good-subsequence-ii/solutions/2805181/chu-li-xiang-lin-yuan-su-bu-tong-de-dpwe-gobq/">https://leetcode.cn/problems/find-the-maximum-length-of-a-good-subsequence-ii/solutions/2805181/chu-li-xiang-lin-yuan-su-bu-tong-de-dpwe-gobq/</a></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>é¦–å‘äº <a href="https://silencezheng.top">silencezheng.top</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p><p><strong>å…³äºæœ€åä¸€ä¸ªä¾‹é¢˜æˆ‘è‡ªå·±çš„æ€è€ƒå¦‚ä¸‹ï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆæ˜¯é”™çš„ï¼‰ï¼Œæ²¡æ—¶é—´æµªè´¹äº†å…ˆå­˜æ¡£ä»¥åå†æ€è€ƒï¼Œå…ˆç†è§£æ­£ç¡®è§£æ³•ï¼š</strong></p><p><code>Good Subsequence</code>é€šä¿—ç†è§£ä¸€ä¸‹å°±æ˜¯ä¸€ä¸ªæœ‰ä¸è¶…è¿‡<code>k</code>ä¸ª<strong>å‰åä¸ç›¸åŒå…ƒç´ å¯¹</strong>çš„å­åºåˆ—ï¼Œå³é¢˜ç›®éœ€è¦åœ¨å…ƒç´ å°½å¯èƒ½å°‘ä¸åŒçš„æƒ…å†µä¸‹ä½¿å­åºåˆ—å°½å¯èƒ½çš„é•¿ã€‚</p><p>ç”±äº k æ˜¯éè´Ÿæ•´æ•°ï¼Œå› æ­¤é•¿åº¦ç­‰äº 1 çš„å­åºåˆ—ä¸€å®šæ˜¯å¥½å­åºåˆ—ã€‚å¯¹äºä»»æ„ä¸€ä¸ªå­åºåˆ—ï¼Œåœ¨åé¢æ·»åŠ ä¸€ä¸ªå…ƒç´ ä¹‹åï¼Œå­åºåˆ—çš„é•¿åº¦å¢åŠ  1ï¼Œç›¸é‚»ä¸åŒå…ƒç´ å¯¹çš„æ•°é‡ä¸å˜æˆ–å¢åŠ  1ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’è®¡ç®—æœ€é•¿å¥½å­åºåˆ—çš„é•¿åº¦ã€‚</p><p>ç”±äºæ˜¯â€å­åºåˆ—â€œé—®é¢˜ï¼Œå…¶å®ä¹Ÿè¿˜æ˜¯ä»å…¨é›†ä¸­é€‰æ‹©è‹¥å¹²å…ƒç´ çš„é—®é¢˜ï¼Œç”±äºå…ƒç´ ä¸èƒ½é‡å¤é€‰ï¼Œåˆ™è¿˜æ˜¯0-1èƒŒåŒ…é—®é¢˜ã€‚è¿™é‡ŒèƒŒåŒ…çš„é‡é‡é™åˆ¶è½¬åŒ–ä¸º<strong>å‰åä¸ç›¸åŒå…ƒç´ å¯¹</strong>æ•°é‡çš„é™åˆ¶ï¼Œå¯¹äºå…ƒç´ <code>x = nums[i]</code>ï¼Œå®šä¹‰<code>dp[i][j]</code>ä¸ºéå†å‰<code>i</code>ä¸ªå…ƒç´ æ—¶<strong>å‰åä¸ç›¸åŒå…ƒç´ å¯¹</strong>æ•°é‡ä¸è¶…è¿‡<code>j</code>æ—¶çš„å­åºåˆ—æœ€å¤§é•¿åº¦ã€‚</p><p><strong>TODO:å¦‚æœå®šä¹‰ä¸ºå‰<code>i</code>ä¸ªå…ƒç´ ï¼Œåˆ™å®ç°æ—¶é‡åˆ°ç›¸ç­‰é•¿åº¦æƒ…å†µåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿå³dp[a][j]==dp[b][j]ï¼Œå¦‚æœåªå–æœ€åä¸€ä¸ªï¼Œé‚£ä¹ˆåé¢å’Œdp[?][j-1]æ¯”çš„æ—¶å€™ä¹Ÿæ˜¯ç›¸åŒäº¦å¯ï¼Ÿ</strong></p><p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹å¦‚ä½•å®šä¹‰ï¼Œå‚è€ƒ01èƒŒåŒ…é—®é¢˜ï¼Œâ€œå‰iä¸ªå…ƒç´ â€ä¸€è‡´ï¼Œâ€œèƒŒåŒ…å®¹é‡â€ä¸â€œå‰åä¸ç›¸åŒå…ƒç´ å¯¹æ•°é‡â€ä¸€è‡´ï¼Œä¸”æ­¤çº¦æŸæ¡ä»¶åº”è½¬æ¢ä¸ºä¸è¶…è¿‡<code>j</code>è€Œä¸æ˜¯ç­‰äº<code>j</code>ã€‚</p><p>åˆ™å¯¹äº<code>x</code>çš„é€‰å–åˆ†ä¸ºä¸‰ç§æƒ…å†µï¼š</p><ol><li>ä¸é€‰ï¼Œ<code>dp[i][j] = dp[i-1][j]</code>ï¼›</li><li>é€‰æ‹©ï¼Œä¸”<code>x</code>ä¸å­åºåˆ—çš„å‰ä¸€ä¸ªæ•°ç›¸åŒï¼Œåˆ™<code>dp[i][j] = dp[?][j]+1</code>ï¼›</li><li>é€‰æ‹©ï¼Œä¸”<code>x</code>ä¸å­åºåˆ—çš„å‰ä¸€ä¸ªæ•°ä¸åŒï¼Œåˆ™<code>dp[i][j] = dp[?][j-1]+1</code>ã€‚</li></ol><p>è¿™é‡Œä½¿ç”¨äº†<code>?</code>æ¥è¡¨ç¤ºå‰ä¸€ä¸ªæ•°<code>y</code>çš„ä¸‹æ ‡ï¼Œ<code>y</code>éœ€è¦é€šè¿‡éå†å¾—åˆ°ã€‚</p><p>ç”±æ­¤å¯ä»¥å¾—åˆ°çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºï¼š</p><ul><li>æƒ…å†µAï¼ˆä¸é€‰ï¼‰ï¼š<code>dp[i][j] = dp[i-1][j]+1</code></li><li>æƒ…å†µBï¼ˆé€‰ï¼‰ï¼š<code>dp[i][j] = max(dp[?][j], dp[?][j-1])+1</code></li></ul>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;æ–°å¼€ä¸€ä¸ªç³»åˆ—ï¼ŒLeetCodeåˆ·é¢˜å‘¨è®°ï¼Œæ¯å‘¨åˆ·é¢˜æœ‰æ„Ÿæ‚Ÿå¯ä»¥æ€»ç»“ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨ä¸»é¢˜ï¼šè®°å¿†åŒ–æœç´¢ã€åŠ¨æ€è§„åˆ’ã€01èƒŒåŒ…&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;240609æ¯æ—¥ä¸€é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/burst-balloons/description/&quot;&gt;Burst Balloons&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240608åŒå‘¨èµ›æœ€åä¸¤é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/find-the-maximum-length-of-a-good-subsequence-ii/description/&quot;&gt;Find the Maximum Length of a Good Subsequence&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;240609å‘¨èµ›æœ€åä¸¤é¢˜â€”&lt;a href=&quot;https://leetcode.cn/problems/maximum-total-reward-using-operations-ii/description/&quot;&gt;Maximum Total Reward Using Operations&lt;/a&gt;</summary>
    
    
    
    
    <category term="LeetCode" scheme="http://silencezheng.top/tags/LeetCode/"/>
    
  </entry>
  
</feed>
